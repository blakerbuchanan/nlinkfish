(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    205101,       4999]
NotebookOptionsPosition[    187160,       4632]
NotebookOutlinePosition[    187520,       4648]
CellTagsIndexPosition[    187477,       4645]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Three-link Swimmer with Varying Stiffness and Amplitude", "Title",
 CellFrame->{{0, 0}, {2, 0}},
 CellChangeTimes->{{3.728147852297571*^9, 3.728147872824718*^9}, {
  3.728147993566083*^9, 
  3.728148013995943*^9}},ExpressionUUID->"65565126-008d-42b3-95e0-\
47e7fd88f586"],

Cell["\<\
The obvious thing to do is start by reproducing the three-link using Scott\
\[CloseCurlyQuote]s notebook as a guide.\
\>", "Text",
 CellChangeTimes->{{3.7190237316943913`*^9, 3.719023756477062*^9}, {
  3.72446200039536*^9, 3.724462000630921*^9}, {3.72986835767623*^9, 
  3.729868366700389*^9}},ExpressionUUID->"c635dca0-4fec-47d3-968b-\
e6fec8e21b4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"robotParameters", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "0.0725"}], ",", " ", 
     RowBox[{"b", "\[Rule]", "0.15"}], ",", " ", 
     RowBox[{"gap", "\[Rule]", " ", "0.02"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718028155766251*^9, 3.718028209231039*^9}, {
   3.718910361304373*^9, 3.718910429267473*^9}, 3.718910486322949*^9, {
   3.718912099516273*^9, 3.718912117815311*^9}, {3.7189412049190073`*^9, 
   3.718941218478373*^9}, 3.71894125687866*^9, {3.7190212672937803`*^9, 
   3.719021269785841*^9}, {3.7190222453731728`*^9, 3.719022252981271*^9}, {
   3.719022349330474*^9, 3.71902235315693*^9}, {3.719023164847548*^9, 
   3.7190231657581663`*^9}, {3.7190844541143227`*^9, 
   3.7190844726740217`*^9}, {3.719085562770052*^9, 3.719085573378058*^9}, {
   3.719085699776153*^9, 3.719085754144931*^9}, {3.7191968395761766`*^9, 
   3.719196903319669*^9}, {3.71923408176305*^9, 3.719234135021182*^9}, {
   3.7210900777353687`*^9, 3.721090099358502*^9}, 3.7210901384390097`*^9, {
   3.7239032766910057`*^9, 3.723903276762176*^9}, {3.723903899392838*^9, 
   3.7239038999316874`*^9}, {3.723904450285269*^9, 3.723904451569413*^9}, {
   3.7239136304730186`*^9, 3.7239136309032373`*^9}, {3.723914931185891*^9, 
   3.7239149545771*^9}, {3.723915010708448*^9, 3.723915011059268*^9}, {
   3.724692940339081*^9, 3.724693010597268*^9}, {3.724693248892469*^9, 
   3.724693249050291*^9}, {3.7263178953308783`*^9, 3.726317917318746*^9}, {
   3.7267603494440947`*^9, 3.726760358182069*^9}, {3.7267787180678263`*^9, 
   3.726778727124358*^9}, {3.72677878869862*^9, 3.726778796411099*^9}, {
   3.726793013297126*^9, 3.726793018490244*^9}, {3.731753210531802*^9, 
   3.73175322056208*^9}},ExpressionUUID->"b27fd90a-6ec7-44d1-84f8-\
7d506d1cf733"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zbody", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], ",", " ", 
     RowBox[{"y", "[", "t", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7190857523705387`*^9},ExpressionUUID->"2862318c-6057-47d9-8039-\
da32bc97d0cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zhead", "=", " ", 
   RowBox[{"zbody", "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.719085729984912*^9, {3.723903145188452*^9, 3.723903155747073*^9}, {
   3.723913536122883*^9, 3.7239135405493298`*^9}, {3.723916742591134*^9, 
   3.72391678455721*^9}},ExpressionUUID->"46d18575-d182-41d3-a3c1-\
516af4cfbe28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ztail", " ", "=", " ", 
   RowBox[{"zbody", "-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
          RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
          RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718910508206327*^9, 3.718910549589747*^9}, {
  3.718911996480999*^9, 3.7189120059151077`*^9}, {3.718912121608396*^9, 
  3.71891213595437*^9}, {3.71908447625718*^9, 3.719084478561014*^9}, {
  3.7190845646452703`*^9, 3.719084567252512*^9}, {3.719084814182561*^9, 
  3.719084814189521*^9}, {3.7190906872172527`*^9, 3.719090688192341*^9}, {
  3.723903158126718*^9, 3.723903164853403*^9}, {3.723913570053235*^9, 
  3.723913575074522*^9}},ExpressionUUID->"92b744bf-a269-43c1-a70b-\
6538b31d3beb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headPivot", " ", "=", " ", 
   RowBox[{"zbody", "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", "gap"}], ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", "gap"}], ")"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718910624667165*^9, 3.718910635195606*^9}, 
   3.718910713373279*^9, {3.718910762619812*^9, 3.7189107797255173`*^9}, {
   3.718912147343313*^9, 3.7189121524235*^9}, 3.719084510747632*^9, {
   3.723903168170869*^9, 3.7239031699325123`*^9}, {3.7239135770138683`*^9, 
   3.723913582016527*^9}},ExpressionUUID->"566c9fd2-4cd6-44e4-a489-\
38919ccfbed2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tailPivot", " ", "=", " ", 
   RowBox[{"zbody", "-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", "gap"}], ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", "gap"}], ")"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7189107815596647`*^9, 3.718910829285324*^9}, {
   3.718912158441134*^9, 3.718912163893648*^9}, 3.7190845107601213`*^9, {
   3.723903171299857*^9, 3.723903173077107*^9}, {3.723913583774716*^9, 
   3.723913585714573*^9}},ExpressionUUID->"09c0f92e-0376-48f7-9890-\
08e25d5c9ff0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"body", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Purple", ",", 
       RowBox[{"Opacity", "[", "0.4", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"zbody", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "a"}], "}"}]}], "]"}]}], "}"}], "//", 
     RowBox[{
      RowBox[{"Rotate", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}], ",", "zbody"}], "]"}], "&"}]}], "//",
     "Graphics"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718910845696721*^9, 3.718910885737664*^9}, {
  3.7190845107696877`*^9, 3.719084510776277*^9}, {3.7192618036000757`*^9, 
  3.7192618182880793`*^9}, {3.71926191136646*^9, 3.719261911409773*^9}, {
  3.731684917062976*^9, 
  3.731684923271525*^9}},ExpressionUUID->"37f31493-655f-48cb-8f53-\
892df808608c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headPivotDot", "=", 
   RowBox[{
    RowBox[{"Disk", "[", 
     RowBox[{"headPivot", ",", "0.02"}], "]"}], "//", "Graphics"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718910923277557*^9, 3.7189109543106823`*^9}, {
  3.7246930851308002`*^9, 
  3.724693085204927*^9}},ExpressionUUID->"8f753220-eb58-4562-b2b3-\
4dfc563af66e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headPivotLine1", "=", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"zbody", ",", "headPivot"}], "}"}], "]"}], "//", "Graphics"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7189109796559353`*^9, 3.71891104630532*^9}, 
   3.719084510788248*^9},ExpressionUUID->"883e4078-c22a-48b4-ae86-\
cec05f093d6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headPivotLine2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"headPivot", ",", "zhead"}], "}"}], "]"}], "//", "Graphics"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.718911053168841*^9, 3.718911075666708*^9}, 
   3.7190845255325947`*^9},ExpressionUUID->"02016ab8-c2bb-41eb-8464-\
d15d675a9431"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"head", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{"zhead", ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "a"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Rotate", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Phi]", "[", "t", "]"}]}]}], "]"}], "&"}]}], "//", 
     "Graphics"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.718911080286725*^9, 3.718911119994604*^9}, 
   3.7190845255418997`*^9, {3.719234369844544*^9, 3.719234380625535*^9}, {
   3.719234426134729*^9, 3.719234462500716*^9}, 
   3.719261511487323*^9},ExpressionUUID->"41f1ee41-0171-440b-b6bf-\
6680a77a678a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"head", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Purple", ",", 
       RowBox[{"Opacity", "[", "0.4", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"zhead", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "a"}], "}"}]}], "]"}]}], "}"}], "//", 
     RowBox[{
      RowBox[{"Rotate", "[", 
       RowBox[{"#", ",", " ", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
         RowBox[{"\[Phi]", "[", "t", "]"}]}]}], "]"}], "&"}]}], "//", 
    "Graphics"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719261493093008*^9, 3.719261506725206*^9}, {
  3.719261770974485*^9, 3.7192617743813477`*^9}, {3.719261915026943*^9, 
  3.71926191508974*^9}, {3.7316847392667103`*^9, 3.731684754626067*^9}, {
  3.731684908599557*^9, 
  3.7316849098615513`*^9}},ExpressionUUID->"780b9a18-9a76-4f87-9f8d-\
08f285165221"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tailPivotDot", " ", "=", " ", 
   RowBox[{
    RowBox[{"Disk", "[", 
     RowBox[{"tailPivot", ",", " ", "0.02"}], "]"}], "//", "Graphics"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7189111297070227`*^9, 3.7189111524783077`*^9}, {
  3.724693089685897*^9, 
  3.724693092437645*^9}},ExpressionUUID->"93d59990-ab71-486e-ae4e-\
13ca5ada0cbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tailPivotLine1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"zbody", ",", "tailPivot"}], "}"}], "]"}], "//", "Graphics"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.718911160425712*^9, 3.7189111909257317`*^9}, 
   3.719084510802918*^9},ExpressionUUID->"09862e3a-eae4-4819-83b5-\
5c0112133e4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tailPivotLine2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"ztail", ",", "tailPivot"}], "}"}], "]"}], "//", "Graphics"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7189111927217913`*^9, 3.718911215315893*^9}, 
   3.719084536804084*^9},ExpressionUUID->"3a4521fd-5de3-4117-8490-\
52d5fec5bfdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tail", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Purple", ",", 
       RowBox[{"Opacity", "[", "0.4", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"ztail", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "a"}], "}"}]}], "]"}]}], "}"}], "//", 
     RowBox[{
      RowBox[{"Rotate", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
         RowBox[{"\[Theta]1", "[", "t", "]"}]}]}], "]"}], "&"}]}], "//", 
    "Graphics"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718911218487406*^9, 3.7189112700173607`*^9}, 
   3.719084536812491*^9, 3.719084814201388*^9, {3.7191512738798113`*^9, 
   3.719151284118373*^9}, {3.71926182568095*^9, 3.719261838289007*^9}, {
   3.719261917987289*^9, 3.719261918066553*^9}, {3.731684931384*^9, 
   3.731684934263953*^9}},ExpressionUUID->"91abe85d-d62e-41da-b903-\
b14c4b89ab5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"water", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Blue", ",", 
      RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "8"}], " ", ",", "8"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "8"}], " ", ",", " ", "8"}], "}"}]}], "]"}]}], "}"}], "//",
     "Graphics"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719324857147009*^9, 3.719324878186445*^9}, {
  3.719324908702073*^9, 3.7193249418210278`*^9}, {3.71932503088068*^9, 
  3.719325032192664*^9}, {3.719325068290462*^9, 3.719325069531332*^9}, {
  3.719327326654928*^9, 3.719327346901902*^9}, {3.719327416433566*^9, 
  3.71932743988078*^9}},ExpressionUUID->"24d5f724-cfb5-43fc-99d4-\
72110fbca83d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "body", ",", "headPivotDot", ",", "head", ",", "tail", ",", 
          "tailPivotDot", ",", "headPivotLine1", ",", "headPivotLine2", ",", 
          "tailPivotLine1", ",", "tailPivotLine2"}], "}"}], "/.", 
        "robotParameters"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "t", "]"}], "\[Rule]", " ", "X"}], ",", " ", 
         RowBox[{
          RowBox[{"y", "[", "t", "]"}], "\[Rule]", " ", "Y"}], ",", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", 
          "\[CapitalTheta]"}], ",", 
         RowBox[{
          RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", " ", 
          "\[CapitalTheta]1"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
          "\[CapitalPhi]"}]}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"PlotRange", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
               "2"}], ")"}]}], " ", ",", " ", 
            RowBox[{
             RowBox[{"3", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
             "2"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
               "2"}], ")"}]}], " ", ",", " ", 
            RowBox[{
             RowBox[{"3", " ", "b"}], "+", " ", "gap", " ", "+", " ", "2"}]}],
            "}"}]}], "}"}]}], " ", "/.", " ", "robotParameters"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"X", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Y", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[CapitalTheta]", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[CapitalTheta]1", ",", 
      FractionBox[
       RowBox[{"-", "\[Pi]"}], "2"], ",", 
      FractionBox["\[Pi]", "2"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[CapitalPhi]", ",", 
      FractionBox[
       RowBox[{"-", "\[Pi]"}], "2"], ",", 
      FractionBox["\[Pi]", "2"]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.718911276771182*^9, 3.7189113835648947`*^9}, {
   3.7189114146651793`*^9, 3.7189116097463303`*^9}, {3.718911671855301*^9, 
   3.718911702105517*^9}, {3.718911733118062*^9, 3.7189117371844482`*^9}, {
   3.718912055902588*^9, 3.7189120618444757`*^9}, 3.718912508620569*^9, {
   3.718912811409225*^9, 3.718912826870206*^9}, 3.7190236697280903`*^9, {
   3.719024308172579*^9, 3.7190243146037483`*^9}, 3.719082604532221*^9, 
   3.71908481421309*^9, 3.719085829523987*^9, 3.719235835404845*^9, 
   3.7210867288768797`*^9, 3.7236657504532557`*^9, {3.723903043930779*^9, 
   3.723903044167186*^9}, 3.727615877768229*^9, 
   3.732890728753736*^9},ExpressionUUID->"6c0f1ab0-7ec3-4b19-a20a-\
f338dd8e6a69"],

Cell[CellGroupData[{

Cell["Three-link System Dynamics", "Chapter",
 CellFrame->{{0, 0}, {2, 0}},
 CellChangeTimes->{{3.718912592755411*^9, 3.718912616922662*^9}, {
  3.718912704232243*^9, 3.7189127140738087`*^9}, {3.7192357709998407`*^9, 
  3.719235775768653*^9}},ExpressionUUID->"e2e4728e-4f72-4245-8bec-\
094aedb98f70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ebodylong", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718026846915421*^9, 3.718026893159186*^9}, {
  3.718026954107463*^9, 3.718026956329226*^9}, {3.71891330515909*^9, 
  3.7189133330450163`*^9}},ExpressionUUID->"e6b3d87a-978e-441c-899b-\
fa046a244f5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ebodylat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718026894898725*^9, 
  3.718026964185615*^9}},ExpressionUUID->"fac027ed-81a0-4e2d-ad4a-\
d61cc65046c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eheadlong", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7180269692459993`*^9, 
  3.7180269975005627`*^9}},ExpressionUUID->"d444d6f7-1678-479f-be4d-\
eaa4a0c09dda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eheadlat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
        RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], ",", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.718027035869513*^9, 3.718027040988626*^9}, {
  3.7180270946475554`*^9, 3.7180271089899197`*^9}, {3.718028036596389*^9, 
  3.718028117822002*^9}},ExpressionUUID->"0a217947-00a4-4a33-aa7d-\
b114cdd6e2e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"etaillong0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ",", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"etaillong", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ",", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.719084814224703*^9, 3.7190848142313023`*^9}, {
  3.720466038317972*^9, 3.7204660614298897`*^9}, {3.720466092125084*^9, 
  3.720466093083952*^9}, {3.723904822438242*^9, 
  3.723904825592289*^9}},ExpressionUUID->"0b8d6315-f4f1-4eee-a43d-\
79a1b2204a18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"etaillat0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"etaillat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.718028087081287*^9, 3.718028103051817*^9}, {
  3.719084814239978*^9, 3.719084814246525*^9}, {3.720466033368252*^9, 
  3.720466098187442*^9}, {3.723904837721046*^9, 
  3.723904840130303*^9}},ExpressionUUID->"59d46548-367b-4c49-b453-\
a690d97bdd89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ellipseMasses", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mLong", "\[Rule]", " ", 
      RowBox[{"\[Rho]", " ", "\[Pi]", " ", 
       SuperscriptBox["a", "2"]}]}], ",", 
     RowBox[{"mLat", " ", "\[Rule]", " ", 
      RowBox[{"\[Rho]", " ", "\[Pi]", " ", 
       SuperscriptBox["b", "2"]}]}], ",", " ", 
     RowBox[{"mRot", " ", "\[Rule]", " ", 
      RowBox[{"\[Rho]", " ", 
       FractionBox["\[Pi]", "8"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["b", "2"], "-", 
          SuperscriptBox["a", "2"]}], ")"}], "2"]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718913117290391*^9, 
  3.7189132160095367`*^9}},ExpressionUUID->"18f08e75-8431-45b4-bc07-\
e73432a9a013"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vhead", "=", 
   RowBox[{"D", "[", 
    RowBox[{"zhead", ",", "t"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718913255773003*^9, 3.718913276650957*^9}, {
   3.7189165953666887`*^9, 3.7189166310800343`*^9}, 3.719084525552739*^9, 
   3.719084591770535*^9, 3.72109134153366*^9, 
   3.7215842300944366`*^9},ExpressionUUID->"73bac04c-eb9c-459f-a786-\
28adced20b85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vbody", "=", 
   RowBox[{"D", "[", 
    RowBox[{"zbody", ",", " ", "t"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718916634227703*^9, 3.718916644611259*^9}, 
   3.719084510818919*^9, 3.719084603712569*^9, {3.721131357078837*^9, 
   3.7211313608490458`*^9}},ExpressionUUID->"1a5043d0-16aa-4eef-954d-\
078e90f1385e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vtail", "=", 
   RowBox[{"D", "[", 
    RowBox[{"ztail", ",", "t"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718916646308762*^9, 3.718916656289501*^9}, 
   3.7190845367944613`*^9, 3.719084612488864*^9, 3.721131346233226*^9, 
   3.721584231758852*^9},ExpressionUUID->"1a807eff-4d1d-4c63-9ebb-\
94a8f9f80fca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KEbody", " ", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", "mLong", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vbody", ".", "ebodylong"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "mLat", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vbody", ".", "ebodylat"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "mRot", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ")"}], "2"]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718916661933909*^9, 3.718916736422237*^9}, {
   3.7190846037245083`*^9, 3.7190846037312193`*^9}, 3.719084645100093*^9, 
   3.7210710331931667`*^9, 
   3.7221784976748238`*^9},ExpressionUUID->"02314625-7866-450c-9965-\
b211d1bc6c51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KEhead", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], "mLong", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vhead", ".", "eheadlong"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "mLat", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vhead", ".", "eheadlat"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "mRot", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "+", 
        RowBox[{
         RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], ")"}], "2"]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718916739058429*^9, 3.718916802800523*^9}, {
   3.7190845917825193`*^9, 3.719084591789049*^9}, 
   3.7190846540382633`*^9},ExpressionUUID->"fbe9ac21-758c-4065-acd7-\
3792b0a6ff9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KEtail", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", "mLong", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vtail", ".", "etaillong"}], ")"}], "2"]}], " ", "+", " ", 
    RowBox[{
     FractionBox["1", "2"], " ", "mLat", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vtail", ".", "etaillat"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], "mRot", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "-", 
        RowBox[{
         RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], ")"}], "2"]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718916804370028*^9, 3.7189168664576263`*^9}, {
   3.719084612476507*^9, 3.719084612483027*^9}, 3.7190846625889807`*^9, 
   3.719084823982109*^9, {3.722178579727702*^9, 3.722178580782734*^9}, {
   3.7221786158256283`*^9, 3.722178616094537*^9}, {3.722179000362907*^9, 
   3.722179006235456*^9}, {3.723904848948764*^9, 
   3.723904850779337*^9}},ExpressionUUID->"bdf6a44c-de9d-4e80-b3e5-\
ba7eecf35672"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PEtail", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "2"], " ", "k1", " ", 
    SuperscriptBox[
     RowBox[{"\[Theta]1", "[", "t", "]"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7189168799471197`*^9, 3.718916939941894*^9}, {
   3.718917024367435*^9, 3.71891702470901*^9}, 3.719084763381665*^9, 
   3.719084814255311*^9, 3.7190848800195513`*^9, {3.719085426980977*^9, 
   3.71908542787505*^9}},ExpressionUUID->"c969b569-6134-4e9f-88d9-\
2e36e728cdfd"],

Cell["What are the units of k? N*m/rad, I think...", "Text",
 CellChangeTimes->{{3.724752786251102*^9, 3.7247528329903708`*^9}, {
  3.724752961592908*^9, 
  3.724752975095566*^9}},ExpressionUUID->"124c559b-8833-4121-b5f9-\
9fed8750067c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"KEbody", "+", "KEhead", "+", "KEtail", "-", "PEtail"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718977665114277*^9, 3.718977684980351*^9}, {
   3.719084645107326*^9, 3.71908466259459*^9}, 3.719084763375708*^9, {
   3.721071058978797*^9, 3.721071068698495*^9}, {3.721088656119906*^9, 
   3.721088657418161*^9}},ExpressionUUID->"24fd083e-5723-4dee-adfa-\
b23d055710c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"liftedAction", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{"xbar", " ", "+", " ", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]bar", "]"}]}], "-", 
       RowBox[{
        RowBox[{"y", "[", "t", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]bar", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"y", "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{"ybar", "+", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]bar", "]"}]}], "+", 
       RowBox[{
        RowBox[{"y", "[", "t", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]bar", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "+", "\[Theta]bar"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]bar", "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]bar", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]bar", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]bar", "]"}]}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7239152147497253`*^9, 
  3.723915329627507*^9}},ExpressionUUID->"61bef6db-1ec2-4325-a767-\
c0524b136dd9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"L", " ", "-", " ", "L"}], "/.", "liftedAction"}]], "Input",
 CellChangeTimes->{{3.723915336261881*^9, 
  3.7239153433977203`*^9}},ExpressionUUID->"1ea36baf-fe01-40c9-a0a9-\
755a52820d69"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.723915344481678*^9, 3.723915424407296*^9, 3.7239158339468403`*^9, 
   3.723916523543078*^9, 3.7239170216787786`*^9, 3.724028519112628*^9, 
   3.724079491428833*^9, 3.724170412573181*^9, 3.724170641641676*^9, 
   3.724358272859214*^9, 3.72435844857651*^9, 3.7243585718856*^9, 
   3.724359326479899*^9, 3.724360611648082*^9, 3.7243618380773582`*^9, 
   3.7243619318239603`*^9, 3.724362324113883*^9, 3.724362760973269*^9, 
   3.724376125049292*^9, 3.724376826513031*^9, 3.724376985332438*^9, 
   3.724377088622286*^9, 3.7243771329731216`*^9, 3.7244202573086567`*^9, 
   3.724438807927217*^9, 3.7244417471807547`*^9, 3.7244448952187*^9, 
   3.724448626275807*^9, 3.724453597563143*^9, 3.724681701209649*^9, 
   3.724693025258761*^9, 3.724693155942602*^9, 3.724751721043931*^9, 
   3.724751937209231*^9, 3.724753088370027*^9, 3.724759245302133*^9, 
   3.724875831129406*^9, 3.724929841694149*^9, 3.724930180544142*^9, 
   3.725063421856248*^9, 3.725063510475103*^9, 3.725063974904468*^9, 
   3.725064056171266*^9, 3.7250645811912394`*^9, 3.725064714320528*^9, 
   3.725064790807787*^9, 3.725064872655711*^9, 3.725065124584127*^9, 
   3.7250656750358953`*^9, 3.7250657269860163`*^9, 3.7251131187701187`*^9, 
   3.7251139220042467`*^9, 3.725117414611794*^9, {3.725117578379019*^9, 
   3.7251176060001307`*^9}, 3.725117882820136*^9, 3.725117919710101*^9, 
   3.725118040687698*^9, {3.725118265540372*^9, 3.725118290604713*^9}, 
   3.725118356280477*^9, 3.7251183912354383`*^9, 3.725118594226144*^9, 
   3.725118895180928*^9, 3.725119690344224*^9, 3.72512287129745*^9, 
   3.72512457418556*^9, 3.725124616055861*^9, {3.7251249281533012`*^9, 
   3.725124955854375*^9}, 3.725125145339271*^9, 3.725126415252466*^9, 
   3.7251267892612867`*^9, 3.725127059640277*^9, 3.725194019255472*^9, 
   3.725194779657341*^9, 3.7251949411790743`*^9, 3.725195227981872*^9, 
   3.725196247247978*^9, 3.7251972309938507`*^9, 3.725197359288658*^9, 
   3.7251974015073338`*^9, 3.725198189122666*^9, 3.725207644230761*^9, 
   3.72520786738316*^9, 3.7252079534122667`*^9, 3.7252080851493597`*^9, 
   3.725208151949009*^9, 3.725208251717546*^9, 3.7252369690295887`*^9, 
   3.725237106128327*^9, 3.725237454382942*^9, 3.725237541301177*^9, 
   3.72527992599177*^9, 3.7252804770858727`*^9, 3.725280707206463*^9, 
   3.7252807565685663`*^9, 3.7252817979756107`*^9, 3.725307901843101*^9, 
   3.725365320790481*^9, 3.725365606104645*^9, 3.7253672104527693`*^9, 
   3.725387251432295*^9, 3.725400288132613*^9, 3.725401921084309*^9, 
   3.725494978067415*^9, 3.725556306334341*^9, 3.7255779890898523`*^9, 
   3.7255782704858017`*^9, 3.725627938108561*^9, 3.7256279839753723`*^9, 
   3.72562801540621*^9, 3.725628066786038*^9, 3.72562828141882*^9, 
   3.725628763615307*^9, 3.7256288765396833`*^9, 3.72575711478016*^9, 
   3.725757541013424*^9, 3.725887263503644*^9, 3.725905777686328*^9, 
   3.7259748577238417`*^9, 3.726180483318618*^9, 3.726180552596951*^9, 
   3.726317939263461*^9, 3.7263252844748373`*^9, 3.726489015113624*^9, {
   3.726497048885742*^9, 3.726497072179357*^9}, 3.7264973956343193`*^9, 
   3.726497642424144*^9, 3.726499217668344*^9, 3.7264995404772243`*^9, 
   3.726501862071851*^9, 3.726501987030443*^9, 3.726604965242798*^9, 
   3.7266069075661592`*^9, 3.72662066801412*^9, 3.726624051623665*^9, 
   3.7266622015738707`*^9, 3.726682077423038*^9, 3.726760569070725*^9, 
   3.726793137838435*^9, 3.7276270251348963`*^9, 3.72762707238302*^9, 
   3.727644976309133*^9, 3.72765790276722*^9, 3.727702780858465*^9, 
   3.7277062629665537`*^9, 3.727788319848596*^9, 3.7281377698469753`*^9, 
   3.728141871882976*^9, 3.728241434119474*^9, 3.728241566258309*^9, 
   3.728241621887339*^9, 3.72824173621111*^9, 3.7282417696266947`*^9, 
   3.728241825444652*^9, 3.728241863047792*^9, {3.728242166365774*^9, 
   3.728242184974112*^9}, 3.728242222065534*^9, 3.728242270029437*^9, 
   3.728242300052347*^9, 3.728242475997751*^9, {3.728242651280283*^9, 
   3.728242679886389*^9}, 3.7282427154396667`*^9, 3.728242855944253*^9, {
   3.728242915994685*^9, 3.7282429446789*^9}, 3.728242982408201*^9, 
   3.728740680656768*^9, 3.728925766019141*^9, 3.729000354573968*^9, 
   3.7293409234320097`*^9, 3.72934139435702*^9, 3.729342813184087*^9, 
   3.729344834777027*^9, 3.729346179364418*^9, 3.7293472896213083`*^9, 
   3.729528390652214*^9, 3.729533620304036*^9, 3.729533988148778*^9, 
   3.72953421908002*^9, 3.7296144229073763`*^9, 3.729614530148279*^9, 
   3.729614598724121*^9, 3.729707480658978*^9, 3.729707827001783*^9, 
   3.729707931957858*^9, 3.729709753681818*^9, 3.729710359323011*^9, 
   3.7297108520252237`*^9, 3.7297111479583797`*^9, 3.7298024066802797`*^9, 
   3.7298027468549643`*^9, 3.7298060298078413`*^9, 3.7298675087864323`*^9, 
   3.729868020992783*^9, 3.729868405904299*^9, 3.729868747809873*^9, 
   3.729877390307983*^9, 3.729948214464048*^9, 3.729948250634602*^9, {
   3.729948466957862*^9, 3.729948492648582*^9}, 3.729948585114808*^9, 
   3.729949191376505*^9, 3.729949740064251*^9, 3.7299591584009666`*^9, 
   3.729971889097332*^9, 3.729979190283742*^9, 3.729979471946624*^9, 
   3.729979572876651*^9, 3.729979984509823*^9, 3.730026519055122*^9, 
   3.730026804728965*^9, 3.730027516130587*^9, 3.730027594124914*^9, 
   3.730027632977326*^9, 3.730056099790279*^9, 3.7300561467541313`*^9, 
   3.730056641199358*^9, 3.730056731179493*^9, 3.730056837071946*^9, 
   3.7300576815551043`*^9, 3.7300577195371437`*^9, 3.730058160144937*^9, 
   3.730122879624173*^9, 3.730126701049461*^9, 3.730126901636256*^9, 
   3.730131584039547*^9, 3.73013163296132*^9, 3.730143822818418*^9, {
   3.730143962089829*^9, 3.730144008008656*^9}, 3.730144042870405*^9, 
   3.730413821323535*^9, 3.73041431860178*^9, 3.730414941065295*^9, 
   3.7304156304218283`*^9, 3.7304160174161654`*^9, 3.7304608964667797`*^9, 
   3.730484510579108*^9, 3.730491229754574*^9, 3.7304916317159843`*^9, 
   3.730545851940694*^9, 3.7305467362195168`*^9, 3.7305472268776503`*^9, 
   3.730548175262039*^9, 3.730549978163951*^9, 3.73055193355363*^9, 
   3.730554088677784*^9, 3.730554603226047*^9, 3.730554945363594*^9, 
   3.730556795531292*^9, 3.730556925383972*^9, 3.7305578109515257`*^9, 
   3.730557874089375*^9, 3.730558280869389*^9, 3.730562915014352*^9, 
   3.730563772310033*^9, 3.730563866915133*^9, 3.7305640041342993`*^9, 
   3.7305645269174*^9, 3.7305676011982803`*^9, 3.730567809688087*^9, 
   3.730716301789632*^9, 3.7307199827839108`*^9, 3.730720281520159*^9, 
   3.730720578384707*^9, 3.730724565732999*^9, 3.730725135398641*^9, 
   3.7307334365880117`*^9, 3.730736289271771*^9, 3.7307386804707317`*^9, 
   3.73074749842308*^9, 3.730747662234366*^9, 3.730904562403693*^9, 
   3.730904918933475*^9, 3.730907165285617*^9, {3.730907219991476*^9, 
   3.730907241273389*^9}, 3.7309074462144423`*^9, 3.73090765311187*^9, 
   3.730907710611927*^9, 3.731065404132494*^9, 3.7310659625833693`*^9, 
   3.731066372241045*^9, 3.731066602102007*^9, 3.731066928381302*^9, 
   3.731069103068449*^9, 3.731089219816348*^9, 3.7311508102987423`*^9, 
   3.731152301938232*^9, 3.7311611114909887`*^9, 3.7311797617290277`*^9, 
   3.731180393031889*^9, 3.7311807365019083`*^9, 3.731181062904529*^9, 
   3.7312341141483707`*^9, 3.731234633364031*^9, 3.73123734794527*^9, 
   3.731238227901252*^9, 3.731666793906983*^9, 3.731667380914716*^9, 
   3.7316801612214947`*^9, 3.731680336357648*^9, 3.731680456285262*^9, 
   3.731683945499544*^9, 3.7316847706196747`*^9, 3.731684957004264*^9, 
   3.731752159160714*^9, 3.731756396129838*^9, 3.7317683849276237`*^9, 
   3.731769100476083*^9, 3.731770956879012*^9, 3.7317778557556343`*^9, 
   3.7317917719950113`*^9, 3.7318335438400087`*^9, 3.731840758675273*^9, 
   3.731842509539193*^9, 3.731857614396366*^9, 3.7318677921760273`*^9, 
   3.731884105941925*^9, 3.731926452230463*^9, 3.731936567814948*^9, 
   3.731938114459262*^9, 3.731939628983775*^9, 3.731940936606471*^9, 
   3.731942807821268*^9, 3.73194284242798*^9, 3.731946374055468*^9, 
   3.732040875765328*^9, 3.732378013467572*^9, 3.7324561643784723`*^9, 
   3.732484537141633*^9, 3.732484661384735*^9, 3.73248578251022*^9, 
   3.7324858645197783`*^9, 3.732490233234977*^9, 3.73253174502626*^9, 
   3.732575581766942*^9, 3.732576911955496*^9, 3.732577457095133*^9, 
   3.732613536528838*^9, 3.732622322976344*^9, 3.7326253556941338`*^9, 
   3.732635738179654*^9, 3.732636332437798*^9, 3.732900580571415*^9, 
   3.7329157337073927`*^9},ExpressionUUID->"be61e62b-67d1-490a-8cd5-\
40716a08ba99"]
}, Open  ]],

Cell[TextData[{
 "Define the infinitesimal generators. Let me make sure that I conceptually \
understand the infinitesimal generator. If \[CapitalPhi] acts on elements of \
G x Q and results in \[OpenCurlyDoubleQuote]motion\[CloseCurlyDoubleQuote] in \
Q, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Zeta]", "Q"], TraditionalForm]],ExpressionUUID->
  "b2a7d9c1-c26a-4dd0-aba9-ecec2ca03ebd"],
 " (the infinitesimal generator) is a vector field that takes as arguments \
elements of Q and gives tangent vectors in Q, according to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["d", "d\[Epsilon]"], 
    SubscriptBox["|", 
     RowBox[{"\[Epsilon]", "=", "0"}]], 
    RowBox[{"(", 
     RowBox[{"\[CapitalPhi]", "(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"\[Epsilon]", " ", "\[Zeta]"}], ")"}], ",", "q"}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"10809bd4-d0ab-4304-9502-6b195fa28e25"],
 ". It isn\[CloseCurlyQuote]t entirely clear why we need to define two Lie \
algebra elements. Oh, wait. A Lie algebra element is needed for each joint \
motion."
}], "Text",
 CellChangeTimes->{{3.718977951581862*^9, 3.7189779935656843`*^9}, 
   3.718978390845457*^9, {3.718978517602282*^9, 3.7189785176801653`*^9}, {
   3.7189785600024023`*^9, 3.718978623524781*^9}, {3.718978660470437*^9, 
   3.718978674935272*^9}, {3.7189787232886267`*^9, 3.718978845676446*^9}, {
   3.71897887929501*^9, 3.718978980290846*^9}, {3.7189799906028547`*^9, 
   3.718980093268216*^9}, {3.7189807637305727`*^9, 3.718980764193894*^9}, {
   3.7189816278544617`*^9, 3.71898169678473*^9}, {3.723915157184494*^9, 
   3.7239151868314543`*^9}, {3.723915352998468*^9, 
   3.7239153532341022`*^9}},ExpressionUUID->"aff4e4ac-b9ec-4edd-9b14-\
e917bbd94080"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Zeta]", "=", 
   RowBox[{"{", 
    RowBox[{"\[Zeta]1", ",", " ", "\[Zeta]2", ",", " ", "\[Zeta]3"}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.718977997716864*^9, 3.718978021234399*^9}, 
   3.723915197814952*^9},ExpressionUUID->"0aa1c19c-399f-426f-b1f4-\
8c55a17613e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Zeta]Q", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Zeta]1", " ", "-", " ", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], " ", "\[Zeta]3"}]}], ",", " ", 
     RowBox[{"\[Zeta]2", " ", "+", " ", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], " ", "\[Zeta]3"}]}], ",", " ", 
     "\[Zeta]3", ",", " ", "0", ",", " ", "0"}], "}"}]}], ";"}]], "Input",Expr\
essionUUID->"4b151e68-d1d0-4189-93d7-3c811fbeda22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]1", ",", " ", "\[Lambda]2", ",", " ", "\[Lambda]3"}], 
    "}"}]}], ";"}]], "Input",ExpressionUUID->"12abcf83-df65-4618-80f0-\
b89f6435aa21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]Q", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]1", " ", "-", " ", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], " ", "\[Lambda]3"}]}], ",", " ", 
     RowBox[{"\[Lambda]2", " ", "+", " ", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], " ", "\[Lambda]3"}]}], ",", " ", 
     "\[Lambda]3", ",", " ", "0", ",", " ", "0"}], "}"}]}], ";"}]], "Input",Ex\
pressionUUID->"30cc19d1-b5a4-4f98-bb4d-0099ad0e40f4"],

Cell["\<\
Since there is an SE(2) symmetry, the momentum maps associated with this \
symmetry are obtained by the natural pairing of the infinitesimal generators \
with the fiber derivative of the Lagrangian. (Skip to where we define the \
momentum maps. The following code just defines the ODEs for the three link \
swimmer.)\
\>", "Text",
 CellChangeTimes->{{3.718982637951312*^9, 3.718982666766885*^9}, {
   3.718982736433609*^9, 3.7189827473297*^9}, {3.71902052903123*^9, 
   3.719020568628771*^9}, {3.719023005632502*^9, 3.719023008948236*^9}, {
   3.719151491723859*^9, 3.719151492184904*^9}, 3.7281487166747627`*^9, {
   3.728148798144038*^9, 3.72814883201753*^9}, {3.728148877060255*^9, 
   3.728148921284296*^9}},ExpressionUUID->"18d02539-8340-41e5-bcc7-\
0eb4ee35038b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{
          RowBox[{"x", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
     "-", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190207199647093`*^9, 3.719020722374579*^9}, {
   3.719021483694234*^9, 3.719021494041192*^9}, {3.7190215528600407`*^9, 
   3.7190215615404463`*^9}, {3.719021602310233*^9, 3.7190216177353992`*^9}, {
   3.719174022102764*^9, 3.7191740255918818`*^9}, 3.719174411460841*^9, {
   3.7191977949214277`*^9, 3.719197796693228*^9}, {3.7191978498375807`*^9, 
   3.719197851412695*^9}, {3.721089635242494*^9, 3.721089639349965*^9}, {
   3.721089704523946*^9, 3.721089706937447*^9}, {3.721090527192341*^9, 
   3.721090535023093*^9}, {3.7210905736428328`*^9, 3.721090574090988*^9}, 
   3.721513041765123*^9, 3.721584225312303*^9, 3.725389001998167*^9, 
   3.725389038545429*^9},ExpressionUUID->"0e71f37e-16fe-41c1-a013-\
d46899d1aac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"yode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{
          RowBox[{"y", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
     "-", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190216212427883`*^9, 3.719021638342125*^9}, {
   3.719174010727219*^9, 3.719174018918293*^9}, {3.7191744220852013`*^9, 
   3.719174423492921*^9}, {3.719197802169883*^9, 3.719197804215314*^9}, {
   3.71919785373524*^9, 3.719197853923852*^9}, {3.721089645902275*^9, 
   3.721089648247664*^9}, 3.721089709284676*^9, {3.721090540542625*^9, 
   3.72109054373046*^9}, 
   3.721090576688198*^9},ExpressionUUID->"84374aa6-2e58-45a0-b27b-\
a96c6f2d34b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]ode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190216405092382`*^9, 3.719021661912898*^9}, {
   3.719174000292056*^9, 3.719174007687325*^9}, 3.719174427717031*^9, {
   3.719197807528124*^9, 3.7191978117521772`*^9}, {3.719199690309474*^9, 
   3.719199691593696*^9}, {3.721089652236102*^9, 
   3.721089686692568*^9}},ExpressionUUID->"559a094e-5986-4caa-be85-\
c088dc686a7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]1ode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{
          RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"-", "c1"}], " ", 
     RowBox[{
      RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719021690060938*^9, 3.719021738109384*^9}, {
   3.719022313427668*^9, 3.7190223380219717`*^9}, {3.719084814279318*^9, 
   3.719084824009861*^9}, {3.7192358286863213`*^9, 3.7192358294681883`*^9}, 
   3.7192359146249723`*^9, 3.724759589906724*^9, 3.725388983872902*^9, 
   3.72662053843545*^9},ExpressionUUID->"4715d06b-1126-40f0-a6fa-\
a957c8136748"],

Cell[BoxData[
 RowBox[{
  RowBox[{"odes", " ", "=", 
   RowBox[{"{", 
    RowBox[{"xode", ",", "yode", ",", "\[Theta]ode", ",", "\[Theta]1ode"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7190217436075163`*^9, 3.719021760357444*^9}, {
   3.7190821432677927`*^9, 3.719082165268042*^9}, 
   3.719182769189693*^9},ExpressionUUID->"ed01e1d6-d9cf-40c7-a528-\
31916385aa9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freq", " ", "=", " ", "0.2"}], ";"}]], "Input",
 CellChangeTimes->{{3.725757069662077*^9, 
  3.725757094848605*^9}},ExpressionUUID->"fda21af6-be5b-4d8a-a97a-\
3054df212f5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"omega", " ", "=", " ", 
   RowBox[{"2", " ", "3.14159", " ", "freq"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725627857338091*^9, 3.72562790221765*^9}, {
  3.725628044543508*^9, 3.725628058864991*^9}, {3.7256282763112593`*^9, 
  3.7256282772052813`*^9}, {3.725757045898604*^9, 
  3.725757064710824*^9}},ExpressionUUID->"b7306465-d76c-4206-9d3c-\
04bd3fd81435"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.7281480758250237`*^9, 
  3.728148077022893*^9}},ExpressionUUID->"33499477-8421-4ef5-a4d2-\
c8270f6085ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"shapeChange", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
     RowBox[{"A", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2.0", " ", "\[Pi]", " ", "freq", " ", "t"}], "]"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fluidAndSpringParams", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "\[Rule]", " ", "1.0"}], ",", 
     RowBox[{"\[Rho]", "\[Rule]", " ", "1000"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dampingParams", "=", 
   RowBox[{"{", 
    RowBox[{"c1", "\[Rule]", " ", 
     RowBox[{"2", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"k1", " ", "mRot"}], "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.719021816049778*^9, 3.719021869741192*^9}, {
   3.719022744334559*^9, 3.7190227465033283`*^9}, {3.719023172500269*^9, 
   3.7190231926848373`*^9}, 3.719085453268361*^9, {3.719150722935849*^9, 
   3.719150723075191*^9}, {3.719151831204376*^9, 3.71915185118675*^9}, {
   3.7191554494083357`*^9, 3.7191554503028584`*^9}, {3.719170940715567*^9, 
   3.719170942074362*^9}, {3.719170996550137*^9, 3.71917103062925*^9}, {
   3.71917162693427*^9, 3.719171627557405*^9}, 3.719174048922192*^9, {
   3.719174122043973*^9, 3.719174151515204*^9}, 3.719174213055107*^9, {
   3.719174783429*^9, 3.719174818228191*^9}, {3.719182945129719*^9, 
   3.7191829463640614`*^9}, {3.719183386385182*^9, 3.719183410009406*^9}, 
   3.719183560007409*^9, {3.719184316665613*^9, 3.719184334918503*^9}, {
   3.7191950830835533`*^9, 3.7191950892777233`*^9}, {3.719196478303507*^9, 
   3.719196483594782*^9}, {3.719196519025782*^9, 3.719196535505713*^9}, {
   3.719198077944169*^9, 3.719198095906692*^9}, {3.719235193387355*^9, 
   3.719235193465639*^9}, {3.719235227211679*^9, 3.719235248266815*^9}, {
   3.719236949077181*^9, 3.719236949506579*^9}, 3.719253189597741*^9, 
   3.71925331964729*^9, {3.719253436269411*^9, 3.719253468520537*^9}, {
   3.719253503237681*^9, 3.7192535034470253`*^9}, {3.719253569860602*^9, 
   3.719253572339445*^9}, {3.719253607694365*^9, 3.7192536126249037`*^9}, {
   3.719254067028459*^9, 3.719254095550935*^9}, {3.719254146447546*^9, 
   3.719254148870943*^9}, {3.7192587759674892`*^9, 3.71925878153102*^9}, {
   3.7192588194395514`*^9, 3.719258849153039*^9}, {3.719258894560063*^9, 
   3.7192588946071777`*^9}, {3.719258924738007*^9, 3.7192590090100822`*^9}, {
   3.719261945428501*^9, 3.719261953691764*^9}, {3.7192619918326674`*^9, 
   3.719261995941285*^9}, {3.7192624648884583`*^9, 3.719262476436986*^9}, {
   3.719262511832241*^9, 3.719262520167465*^9}, {3.7192625675486193`*^9, 
   3.71926256959394*^9}, {3.7193236082671967`*^9, 3.719323608327552*^9}, {
   3.719323647117181*^9, 3.719323678043412*^9}, {3.7204662587508793`*^9, 
   3.720466285431953*^9}, {3.720466330608432*^9, 3.720466330865178*^9}, {
   3.7210888125830393`*^9, 3.721088814712167*^9}, {3.721088874094129*^9, 
   3.721088886035144*^9}, {3.7210891184853697`*^9, 3.7210891186141577`*^9}, {
   3.72108915065769*^9, 3.721089169420952*^9}, {3.721089217856078*^9, 
   3.7210892179265203`*^9}, {3.72108928331094*^9, 3.721089284140175*^9}, {
   3.721089756015686*^9, 3.721089779622983*^9}, {3.721089817634056*^9, 
   3.721089819684889*^9}, {3.721089923168249*^9, 3.7210899494254103`*^9}, {
   3.721090121183275*^9, 3.7210901214316998`*^9}, {3.7210905806586113`*^9, 
   3.721090600212965*^9}, {3.722178724724524*^9, 3.7221787248165913`*^9}, {
   3.7221788391262693`*^9, 3.722178840436854*^9}, {3.722179051564919*^9, 
   3.722179068796442*^9}, {3.722179114253725*^9, 3.722179114332264*^9}, {
   3.722180415217308*^9, 3.722180421401774*^9}, 3.722180454938405*^9, {
   3.722180503885668*^9, 3.722180504780271*^9}, {3.722180686290868*^9, 
   3.722180698018962*^9}, {3.7222620924461727`*^9, 3.722262110512703*^9}, {
   3.722262215809609*^9, 3.722262216271294*^9}, {3.7222623340529757`*^9, 
   3.7222623344992943`*^9}, {3.722262467402169*^9, 3.7222624682133427`*^9}, 
   3.723904964887466*^9, {3.724681671670025*^9, 3.724681671968561*^9}, {
   3.724749632337097*^9, 3.724749660240486*^9}, {3.724749764547962*^9, 
   3.724749765012249*^9}, {3.724751698279698*^9, 3.724751712905531*^9}, {
   3.724751840881854*^9, 3.72475184600541*^9}, {3.724753025844709*^9, 
   3.724753031917201*^9}, {3.724753134957077*^9, 3.724753138110527*^9}, {
   3.724760970342145*^9, 3.724760971075461*^9}, {3.7247610761591167`*^9, 
   3.724761076231183*^9}, {3.724929740825219*^9, 3.724929742320548*^9}, {
   3.724929836164599*^9, 3.724929836590774*^9}, {3.724929929754785*^9, 
   3.724929932436027*^9}, {3.724929968049383*^9, 3.7249299706320353`*^9}, {
   3.725627837226083*^9, 3.725627841820395*^9}, {3.725627926060306*^9, 
   3.725627928011331*^9}, {3.725627992735043*^9, 3.7256280413421*^9}, {
   3.7256286682202883`*^9, 3.725628668410901*^9}, 3.7263252102033167`*^9, {
   3.726497218473094*^9, 3.72649730250568*^9}, {3.726498983467677*^9, 
   3.726498983627304*^9}, {3.726501833890522*^9, 3.726501834683069*^9}, 
   3.726620534521459*^9, {3.726665199142583*^9, 3.7266652280490303`*^9}, {
   3.728148043278668*^9, 3.7281480707353287`*^9}, {3.728241311838447*^9, 
   3.7282413128941107`*^9}, {3.728242583791995*^9, 
   3.728242592367032*^9}},ExpressionUUID->"1113d5e6-2822-43ed-971e-\
a44f43f5e6cf"],

Cell["\<\
How can I always ensure the system is critically (or close to) damped for \
simulation?\
\>", "Text",
 CellChangeTimes->{{3.7247597382767344`*^9, 
  3.724759760772958*^9}},ExpressionUUID->"d5d4d92d-186d-49aa-8bdd-\
332d8e107b61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numofcycles", " ", "=", " ", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.725902643287157*^9, 3.725902648151464*^9}, {
  3.726620040016403*^9, 
  3.7266200406092997`*^9}},ExpressionUUID->"97208c8c-c7b5-481d-91a9-\
c8cc69afba3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"duration", " ", "=", " ", 
   FractionBox["numofcycles", "freq"]}], ";"}]], "Input",
 CellChangeTimes->{{3.7192532285960817`*^9, 3.719253230582872*^9}, {
  3.7259026543777313`*^9, 
  3.7259026634073563`*^9}},ExpressionUUID->"3a1f052e-10e5-416b-9aa7-\
f2757053d9ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solutionControl", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"odes", "/.", "dampingParams"}], "/.", "ellipseMasses"}],
             "/.", "fluidAndSpringParams"}], "/.", "robotParameters"}], "/.", 
          "shapeChange"}], "/.", 
         RowBox[{"D", "[", 
          RowBox[{"shapeChange", ",", "t"}], "]"}]}], "/.", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"shapeChange", ",", "t"}], "]"}], ",", "t"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "duration"}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<EquationSimplification\>\"", "\[Rule]", " ", "\"\<Residual\>\""}],
        "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQPcFdy33H1teO6X9P+IDooIjLISD6VujVUBC94UmV
/U4gLcBl4Aiig4r7S0B04A/bChD90+ZpH4iesCtoBohu0anoOQikjx2dBKa3
/3WJPQykk7sSwHRnoE0KiP53cgWYLmKNKADRfAf5i0B0lODhChCd2JNbC6Jf
WtxyPg6kF7wP9gTRooXM4SB69tOsSBB9QjHuC1i8PuAriH7l9PwPiC5y/Qmm
H/62XPEQSAv32oJpl1dx818C6fDofDA9oWXT4V2HXzueE5h/BETLlhh67gbS
U56VgGnH/9mtILppwnIwDQD+r7KS
  
  "],ExpressionUUID->"68ac759e-eaae-4efd-b911-34b462285ce2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], ",", " ", 
        RowBox[{"y", "[", "t", "]"}], ",", " ", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}], " ", "/.", " ", 
      "solutionControl"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", " ", "0", ",", " ", "duration"}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.719154214144156*^9, 3.719154284946344*^9}, {
   3.719155069762321*^9, 3.719155072497171*^9}, 3.719170955281891*^9, {
   3.719184364625164*^9, 3.719184371612853*^9}, {3.719253247651205*^9, 
   3.719253248187573*^9}, 3.728148709907085*^9, 3.7282414166882973`*^9, 
   3.7320406652736197`*^9},ExpressionUUID->"1096e535-7692-4d59-b23d-\
634a2120a171"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movieFrame", "[", "time_", "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "body", ",", "head", ",", "tail", ",", "tailPivotLine1", ",", 
           "tailPivotDot", ",", "tailPivotLine2", ",", "headPivotDot", ",", 
           "headPivotLine1", ",", "headPivotLine2"}], "}"}], "/.", 
         "robotParameters"}], "/.", "shapeChange"}], "/.", 
       "solutionControl"}], "/.", 
      RowBox[{"t", "\[Rule]", " ", "time"}]}], ",", 
     RowBox[{
      RowBox[{"PlotRange", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
              "2"}], ")"}]}], " ", ",", " ", 
           RowBox[{
            RowBox[{"6", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
            "2"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
              "2"}], ")"}]}], " ", ",", " ", 
           RowBox[{
            RowBox[{"6", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
            "2"}]}], "}"}]}], "}"}]}], " ", "/.", " ", "robotParameters"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719150903160173*^9, 3.7191510131601048`*^9}, {
  3.7191828271371727`*^9, 3.719182827781157*^9}, {3.719183963400749*^9, 
  3.719183993546331*^9}, {3.719324952013503*^9, 3.719324953253909*^9}, {
  3.72108949828334*^9, 3.7210895159116087`*^9}, {3.7210900247740297`*^9, 
  3.721090035016567*^9}, {3.722178813414523*^9, 
  3.7221788154923887`*^9}},ExpressionUUID->"e55df6c5-7fba-4ab1-9ab4-\
22d168e52ff4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numberOfFrames", " ", "=", " ", "300"}], ";"}]], "Input",
 CellChangeTimes->{{3.719151019680471*^9, 3.719151025397862*^9}, 
   3.719151056118771*^9},ExpressionUUID->"9d694007-5df5-41b4-b7ed-\
9a788175bd4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieFrames", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"movieFrame", "[", "k", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "duration", ",", 
       FractionBox["duration", "numberOfFrames"]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.719151027664564*^9, 3.7191510617645273`*^9}, {
  3.7191510956371727`*^9, 
  3.719151099842898*^9}},ExpressionUUID->"8343363a-19cd-4526-9c9a-\
ffad1b878595"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListAnimate", "[", "movieFrames", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.719151105740284*^9, 3.719151111507498*^9}, 
   3.719182808466977*^9, {3.719183079024004*^9, 3.719183081271974*^9}, 
   3.719186725648326*^9, 3.719197757051524*^9, 3.722788798485487*^9, {
   3.723904503612796*^9, 3.723904527745037*^9}, 3.7239048807660303`*^9, 
   3.724376117084903*^9, 3.724693279899246*^9, 3.728148686660961*^9, 
   3.7282412434819403`*^9, 
   3.728314937487113*^9},ExpressionUUID->"99e65dee-09d1-42ae-a197-\
5dd10e77709f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FL", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7238542152733097`*^9, 
  3.723854264933135*^9}},ExpressionUUID->"70d2a9f9-6ce0-4834-aabb-\
ca5b73ffaa12"],

Cell[TextData[{
 "We define the momentum map by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"<", 
     RowBox[{"J", "(", 
      SubscriptBox["v", "q"], ")"}]}], ",", 
    RowBox[{"\[Eta]", ">", " ", 
     RowBox[{"which", " ", "equals"}], " ", "<", 
     RowBox[{"FL", "(", 
      SubscriptBox["v", "q"], ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Eta]", "Q"], "(", "q", ")"}], ">"}]}], 
   TraditionalForm]],ExpressionUUID->"67fe9bf1-ad56-4601-861e-dc2e1f4684d4"]
}], "Text",
 CellChangeTimes->{{3.723855716594654*^9, 3.7238558323198442`*^9}, {
  3.723905479294417*^9, 3.7239054863468027`*^9}, {3.7239165181703997`*^9, 
  3.723916533242518*^9}},ExpressionUUID->"328111cb-647d-4447-9ed8-\
238be138d600"],

Cell[BoxData[
 RowBox[{
  RowBox[{"J1", " ", "=", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"FL", ".", "\[Zeta]Q"}], "\[Zeta]1"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}]}], "}"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.723855845322154*^9, 3.7238558677310534`*^9}, {
  3.7238559108361807`*^9, 
  3.7238559947069397`*^9}},ExpressionUUID->"c57a62c8-8176-455b-b61f-\
04365accc311"],

Cell[BoxData[
 RowBox[{
  RowBox[{"J2", " ", "=", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"FL", ".", "\[Zeta]Q"}], "\[Zeta]2"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}]}], "}"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7238559983066196`*^9, 3.7238560367780533`*^9}, {
  3.731702545917457*^9, 
  3.731702547363813*^9}},ExpressionUUID->"9af9ceb4-9e54-4bf2-805a-\
0240de1e0801"],

Cell[BoxData[
 RowBox[{
  RowBox[{"J3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"FL", ".", "\[Zeta]Q"}], "\[Zeta]3"], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
       RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723856038036436*^9, 3.723856065523519*^9}, {
  3.7317025763133497`*^9, 
  3.7317025785563393`*^9}},ExpressionUUID->"4d026c02-d50e-4d6b-95e8-\
697a7ae22515"],

Cell["\<\
Everything so far is commensurate with Scott\[CloseCurlyQuote]s analysis of a \
similar 3-link swimmer. Let\[CloseCurlyQuote]s get to the good stuff. We \
will, as per Scott\[CloseCurlyQuote]s analysis, need the locked inertia \
tensor, the connection form, and the local connection form.\
\>", "Text",
 CellChangeTimes->{{3.723917050763983*^9, 3.723917121792287*^9}, {
  3.723982047582286*^9, 3.7239820583706503`*^9}, {3.723982316321804*^9, 
  3.7239823320583057`*^9}},ExpressionUUID->"0fa791a5-e9e7-4270-8382-\
923b0c8fac2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rightpairing", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[Lambda]Q", ".", "FL"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723984525918538*^9, 
  3.7239846089572687`*^9}},ExpressionUUID->"02ffd6c7-65c5-423c-a500-\
dceff1484e41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lockedInertiaTensor", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]1", " ", "\[Lambda]1"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]2", " ", "\[Lambda]1"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]3", " ", "\[Lambda]1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]1", " ", "\[Lambda]2"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]2", " ", "\[Lambda]2"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]3", " ", "\[Lambda]2"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]1", " ", "\[Lambda]3"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]2", " ", "\[Lambda]3"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]3", " ", "\[Lambda]3"}]]}], "}"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7239846136379833`*^9, 3.723984623881216*^9}, {
  3.723984716458552*^9, 3.723985034786542*^9}, {3.7239850659556513`*^9, 
  3.72398512645441*^9}, {3.723985196560464*^9, 3.7239852195819893`*^9}, {
  3.731776077325582*^9, 
  3.73177608740467*^9}},ExpressionUUID->"af3d02a9-0bce-4449-b317-\
36067a771fb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalGamma]", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "lockedInertiaTensor", "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"J1", ",", "J2", ",", "J3"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723985228371304*^9, 3.723985239029908*^9}, {
  3.723985314836556*^9, 3.723985332774108*^9}, {3.7317682152272673`*^9, 
  3.7317682162418613`*^9}},ExpressionUUID->"d3407dc6-d107-4ede-a8fd-\
bfb8052ff7b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Adg", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", 
       RowBox[{"y", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"x", "[", "t", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723987209851028*^9, 3.7239872110870457`*^9}, {
  3.7239885977073812`*^9, 
  3.7239886523644533`*^9}},ExpressionUUID->"e93db3ab-adf1-43c4-90bc-\
62ad70deffe3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"localLIT", " ", "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "Adg", "]"}], ".", "lockedInertiaTensor", ".", 
    "Adg"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723988656459087*^9, 
  3.723988682178249*^9}},ExpressionUUID->"280ac593-f02a-4729-a891-\
1355cbe86492"],

Cell["\<\
The following verification checks out when the joint angles are zero. Huzzah!\
\
\>", "Text",
 CellChangeTimes->{{3.723988787557687*^9, 
  3.723988813877265*^9}},ExpressionUUID->"0f68e893-fd49-498d-9926-\
d075e32839d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"localLIT", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
      "}"}]}], "//", "Simplify"}], "//", "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.7239887099338703`*^9, 3.723988742501141*^9}, 
   3.731867687527285*^9},ExpressionUUID->"43a25b65-d840-44c7-85a0-\
1c6f03c8781b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SE2BV", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], " ", "-", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724022018652658*^9, 
  3.7240220708012342`*^9}},ExpressionUUID->"88e92be5-0560-438d-a4f3-\
477b6036063d"],

Cell[TextData[{
 "A mechanical connection is given by \[CapitalGamma]=A(r) rdot + ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["g", 
     RowBox[{"-", "1"}]], "gdot"}], TraditionalForm]],ExpressionUUID->
  "a16d2e00-7ebc-4b60-b0e1-3e799da341ba"],
 "=A(r) rdot + SE2BV"
}], "Text",
 CellChangeTimes->{{3.724022690734201*^9, 
  3.724022808865158*^9}},ExpressionUUID->"acd089b2-302d-4193-87e2-\
2836aade64ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"x", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", " ", 
       RowBox[{"y", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724022814372036*^9, 3.724022856089695*^9}, {
  3.724022899054438*^9, 
  3.724022907919812*^9}},ExpressionUUID->"0597299c-0fb5-4767-be83-\
ffc51053aa5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "g", "]"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"g", ",", "t"}], "]"}]}], "//", "FullSimplify"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.724022860563093*^9, 3.724022879551888*^9}, {
   3.724022930128436*^9, 3.724022962093515*^9}, {3.724023063888568*^9, 
   3.7240230644406843`*^9}, {3.72791855088173*^9, 3.7279185534419413`*^9}, 
   3.731867684506136*^9},ExpressionUUID->"18571f3f-ec42-4131-acf5-\
862f38dac258"],

Cell["\<\
Okay, great. Just wanted to check my understanding of how we represent the \
body velocity. I now recall that we represent the above matrix as a 3x1 \
vector.\
\>", "Text",
 CellChangeTimes->{{3.724023156553172*^9, 3.724023180254148*^9}, {
  3.724089794766246*^9, 
  3.724089815802911*^9}},ExpressionUUID->"8a10895a-7f94-497d-9d4d-\
a92cd2df3390"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "Adg", "]"}], ".", "\[CapitalGamma]"}], " ", "-",
     " ", "SE2BV"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7240232034878273`*^9, 3.724023241958338*^9}, {
  3.7240233359531*^9, 
  3.724023336417205*^9}},ExpressionUUID->"b9cbbd65-d87b-4fc7-9597-\
af1bfa551b7c"],

Cell["\<\
Much like Scott\[CloseCurlyQuote]s approach to finding the local connection \
form, I will not wait for Mathematica to simplify A. How can I exploit what I \
know A should look like so as to require less from Mathematica \
computationally?\
\>", "Text",
 CellChangeTimes->{{3.724520061521446*^9, 3.7245201587681026`*^9}, {
  3.724520976805497*^9, 3.724521002468075*^9}, {3.728222134246348*^9, 
  3.728222202901018*^9}},ExpressionUUID->"2d0397b1-edfe-46af-a495-\
657e79a5db2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trickA", "=", 
   RowBox[{"\[CapitalGamma]", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731762926420959*^9, 3.731762931507889*^9}, {
  3.731762963966353*^9, 
  3.731763012783085*^9}},ExpressionUUID->"f8959aec-d331-4ce3-b244-\
3da80a5fecd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ax\[Phi]", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
     "}"}]}]}], ";"}]], "Input",ExpressionUUID->"edc73b95-78af-47a0-8b30-\
59d8ee5be45b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ax\[Theta]1", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731762908220282*^9, 3.731762921484962*^9}, {
  3.731767961899249*^9, 3.731767981921259*^9}, {3.7317680361177683`*^9, 
  3.731768039891116*^9}},ExpressionUUID->"4529efd2-6985-49f7-ae0e-\
d35d00c2a6d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ay\[Phi]", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731768004620933*^9, 
  3.731768022758128*^9}},ExpressionUUID->"b805d9c0-8b7a-4236-891a-\
c55cea173696"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ay\[Theta]1", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731768027917622*^9, 
  3.731768052565219*^9}},ExpressionUUID->"db34c793-062a-4986-9119-\
97f7f3bbe6c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A\[Theta]\[Phi]", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731768083102728*^9, 
  3.731768108966717*^9}},ExpressionUUID->"bb172712-d63b-44e3-b611-\
a8c3906fe66e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A\[Theta]\[Theta]1", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731767985265614*^9, 3.731767986481103*^9}, {
  3.731768255690613*^9, 
  3.731768272077602*^9}},ExpressionUUID->"888a4d87-d3c0-4f07-844c-\
3aaf02e73544"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fiberODE", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"SE2BV", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"trickA", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"SE2BV", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"trickA", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"SE2BV", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"trickA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7317686637609673`*^9, 
  3.731768730387073*^9}},ExpressionUUID->"1616e9a2-0e42-4e13-99fb-\
7753a531c10e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Save", "[", 
    RowBox[{"\"\<fiberODE\>\"", ",", "fiberODE"}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7329254957618856`*^9, 3.7329255063181*^9}, 
   3.732967706258713*^9},ExpressionUUID->"fbc19dac-7a96-494a-a127-\
046602b08eba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Q-learning for Varying Stiffness and Head Speed", "Chapter",
 CellFrame->{{0, 0}, {2, 0}},
 CellChangeTimes->{{3.728238232077935*^9, 3.728238249803187*^9}, {
  3.731162100604533*^9, 
  3.731162115688817*^9}},ExpressionUUID->"deb91032-9e2d-4eba-be88-\
362bf62c51d1"],

Cell["\<\
We want to determine the optimal way to vary the stiffness of a spring in the \
three-link swimmer over some specified number of cycles. This seems like a \
good starting point. We can then add the amplitude variation after \
successfully optimizing the spring stiffness.\
\>", "Text",
 CellChangeTimes->{{3.728238913850534*^9, 3.7282389530359507`*^9}, {
   3.728239133762086*^9, 3.728239178850523*^9}, 3.72823995467794*^9, {
   3.728240016743865*^9, 3.728240035720553*^9}, {3.728314510865096*^9, 
   3.7283145190882807`*^9}},ExpressionUUID->"51df041e-571b-489a-8d73-\
59f8880dba77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PEtailk", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "2"], " ", "k1", " ", 
    SuperscriptBox[
     RowBox[{"\[Theta]1", "[", "t", "]"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7282411114148283`*^9, 3.728241111590726*^9}, {
  3.728241186201686*^9, 3.728241187353037*^9}, {3.729533586792864*^9, 
  3.729533590087604*^9}, {3.729710816866212*^9, 
  3.729710817640074*^9}},ExpressionUUID->"74edc770-86b0-4e87-8ac1-\
d7fc18379790"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Lk", " ", "=", " ", 
   RowBox[{"KEbody", "+", "KEhead", "+", "KEtail", "-", "PEtailk"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.728241192056383*^9, 
  3.728241610151043*^9},ExpressionUUID->"421de4de-a778-4fb2-b855-\
a19924976355"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xodek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"x", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
     "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190207199647093`*^9, 3.719020722374579*^9}, {
   3.719021483694234*^9, 3.719021494041192*^9}, {3.7190215528600407`*^9, 
   3.7190215615404463`*^9}, {3.719021602310233*^9, 3.7190216177353992`*^9}, {
   3.719174022102764*^9, 3.7191740255918818`*^9}, 3.719174411460841*^9, {
   3.7191977949214277`*^9, 3.719197796693228*^9}, {3.7191978498375807`*^9, 
   3.719197851412695*^9}, {3.721089635242494*^9, 3.721089639349965*^9}, {
   3.721089704523946*^9, 3.721089706937447*^9}, {3.721090527192341*^9, 
   3.721090535023093*^9}, {3.7210905736428328`*^9, 3.721090574090988*^9}, 
   3.721513041765123*^9, 3.721584225312303*^9, 3.725389001998167*^9, 
   3.725389038545429*^9, 3.728241193385578*^9, {3.7282413924316*^9, 
   3.728241393710966*^9}},ExpressionUUID->"a4e9e255-4bfe-4627-b819-\
09d89d9a5be6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"yodek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"y", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
     "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190216212427883`*^9, 3.719021638342125*^9}, {
   3.719174010727219*^9, 3.719174018918293*^9}, {3.7191744220852013`*^9, 
   3.719174423492921*^9}, {3.719197802169883*^9, 3.719197804215314*^9}, {
   3.71919785373524*^9, 3.719197853923852*^9}, {3.721089645902275*^9, 
   3.721089648247664*^9}, 3.721089709284676*^9, {3.721090540542625*^9, 
   3.72109054373046*^9}, 3.721090576688198*^9, 3.7282411946985693`*^9, {
   3.728241395263239*^9, 
   3.728241396704973*^9}},ExpressionUUID->"31a8b02e-9e60-4300-8b23-\
556da91f82cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]odek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190216405092382`*^9, 3.719021661912898*^9}, {
   3.719174000292056*^9, 3.719174007687325*^9}, 3.719174427717031*^9, {
   3.719197807528124*^9, 3.7191978117521772`*^9}, {3.719199690309474*^9, 
   3.719199691593696*^9}, {3.721089652236102*^9, 3.721089686692568*^9}, 
   3.728241195994112*^9, {3.7282413982712812`*^9, 
   3.728241399647963*^9}},ExpressionUUID->"8542604b-50c7-49b9-b305-\
221c1075bac6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]1odek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"-", "c1"}], " ", 
     RowBox[{
      RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719021690060938*^9, 3.719021738109384*^9}, {
   3.719022313427668*^9, 3.7190223380219717`*^9}, {3.719084814279318*^9, 
   3.719084824009861*^9}, {3.7192358286863213`*^9, 3.7192358294681883`*^9}, 
   3.7192359146249723`*^9, 3.724759589906724*^9, 3.725388983872902*^9, 
   3.72662053843545*^9, 3.728241197050728*^9, {3.728241400975713*^9, 
   3.728241402368166*^9}},ExpressionUUID->"da99d68e-8e67-41e0-857f-\
b62c4baabd3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]odek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.729129346101903*^9, 3.729129356400942*^9}, {
  3.7295331431791058`*^9, 
  3.729533156938293*^9}},ExpressionUUID->"91bca2d2-6e86-4d4b-adb6-\
b7ddd08f1117"],

Cell[BoxData[
 RowBox[{
  RowBox[{"odesk", " ", "=", 
   RowBox[{"{", 
    RowBox[{
    "xodek", ",", "yodek", ",", "\[Theta]odek", ",", "\[Theta]1odek"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7190217436075163`*^9, 3.719021760357444*^9}, {
   3.7190821432677927`*^9, 3.719082165268042*^9}, 3.719182769189693*^9, {
   3.728241199385078*^9, 3.728241204793434*^9}, {3.729081598729553*^9, 
   3.729081603509693*^9}, {3.729129073976609*^9, 3.729129074950397*^9}, {
   3.7291293609957943`*^9, 3.7291293634766617`*^9}, {3.729346166632288*^9, 
   3.729346166904277*^9}, {3.729346745244274*^9, 3.729346748792362*^9}, 
   3.7309072076755533`*^9, {3.730907682679954*^9, 3.730907684406332*^9}, {
   3.7310639102923822`*^9, 
   3.7310639104312*^9}},ExpressionUUID->"aed19fc1-9e41-4b51-9400-\
3bb0d0bb0110"],

Cell[TextData[{
 "PSEUDOCODE\n\n",
 StyleBox["Establish Q matrix, states, and actions.\nDefine terminal state\n",
  
  FontSlant->"Italic"],
 "\n",
 StyleBox["Start a loop:\n\tInitialize state\n\tStart another loop:\n\t\t\
Choose the action based on the policy\n\t\tTake action, observe reward and \
next state\n\t\tUpdate Q function\n\t\tUpdate state\n\tuntil S is terminal",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.728312075130899*^9, 3.728312114272393*^9}, {
   3.728312149185536*^9, 3.72831220387523*^9}, 3.728312384970686*^9, {
   3.728312426092157*^9, 3.7283124650028667`*^9}, 3.72831272814659*^9, {
   3.7283128795436687`*^9, 3.7283128881995*^9}, {3.72831294325867*^9, 
   3.728313128634997*^9}, {3.728313168636168*^9, 3.7283131763636208`*^9}, {
   3.728313522057901*^9, 3.7283136190171022`*^9}, 3.7283137285744343`*^9, {
   3.728313805904724*^9, 3.7283138379043283`*^9}, {3.731160992612631*^9, 
   3.731160993002286*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"61e8cdf8-9e14-43b2-9173-d0dc35933a0c"],

Cell["Define learning rate, discount factor, time step", "Text",
 CellChangeTimes->{{3.728314126201619*^9, 3.7283141982138433`*^9}, {
   3.7283143841250057`*^9, 3.728314430797217*^9}, {3.728314581809507*^9, 
   3.7283145824334297`*^9}, {3.72832141013498*^9, 3.728321523994196*^9}, {
   3.7283215599024553`*^9, 3.728321593004086*^9}, {3.728321627533634*^9, 
   3.728321667230465*^9}, {3.7283476582334623`*^9, 3.72834767141339*^9}, {
   3.728391356962105*^9, 3.72839136532132*^9}, {3.728391466348716*^9, 
   3.72839147566226*^9}, {3.72839496664959*^9, 3.728394975812171*^9}, {
   3.728395067271146*^9, 3.7283950745505047`*^9}, {3.728404627399394*^9, 
   3.728404647778544*^9}, {3.728407075649516*^9, 3.728407095004986*^9}, {
   3.730058048850017*^9, 3.730058086048973*^9}, 3.730131613148938*^9, {
   3.731161893766534*^9, 
   3.7311618957624273`*^9}},ExpressionUUID->"b19888ea-dc42-41c6-9341-\
422e4da2c3dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", "=", "0.9"}], ";"}]], "Input",
 CellChangeTimes->{{3.7298685839389877`*^9, 
  3.729868596072126*^9}},ExpressionUUID->"961106cc-c608-4e5e-b008-\
3c8ca2993abb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]", "=", "0.95"}], ";"}]], "Input",
 CellChangeTimes->{{3.7298685998571987`*^9, 3.729868603304302*^9}, {
  3.73046083860798*^9, 3.730460839000787*^9}, {3.7318838667721977`*^9, 
  3.731883867032817*^9}},ExpressionUUID->"f83bb67a-409f-4870-974b-\
ae9a608fcfc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]t", "=", "1"}], ";"}]], "Input",ExpressionUUID->"d0e49bf1-98c3-44c3-bd1b-f4ac3bd19561"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eps", "=", "0.3"}], ";"}]], "Input",
 CellChangeTimes->{{3.730557792925255*^9, 3.7305577935908623`*^9}, {
  3.7318838582237673`*^9, 3.731883864074996*^9}, {3.732490161987074*^9, 
  3.732490165044389*^9}},ExpressionUUID->"c083763b-de5b-4a1b-b87c-\
840d6336e48f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Reward", "[", 
    RowBox[{"currentSol_", ",", "pastSol_"}], "]"}], ":=", 
   RowBox[{"currentSol", "-", "pastSol"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7284072339062223`*^9, 3.728407250434235*^9}, {
  3.728407284208919*^9, 3.7284074218612547`*^9}, {3.728689538613014*^9, 
  3.7286895522081423`*^9}},ExpressionUUID->"f10937c8-ae7c-4c28-a50f-\
c47ddbbfd95b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QUpdate", "[", 
    RowBox[{
    "newPos_", ",", "oldPos_", ",", "actionPos_", ",", "reward_", ",", "Q_"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{"Q", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"oldPos", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"oldPos", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"oldPos", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"oldPos", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"actionPos", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"actionPos", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "+", 
    RowBox[{"\[Alpha]", " ", 
     RowBox[{"(", 
      RowBox[{"reward", "+", 
       RowBox[{"\[Gamma]", " ", 
        RowBox[{"Max", "[", " ", 
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"newPos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"newPos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"newPos", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"newPos", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], "-", 
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"oldPos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"oldPos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"oldPos", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"oldPos", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"actionPos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"actionPos", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.728407466944422*^9, 3.728407505001459*^9}, {
  3.728407601163583*^9, 3.728407649437986*^9}, {3.7284079603100967`*^9, 
  3.728408144355372*^9}, {3.7289151861606092`*^9, 3.728915220728875*^9}, {
  3.7289178868813753`*^9, 3.7289178876803083`*^9}, {3.729709414674202*^9, 
  3.729709477518569*^9}, {3.729709514362439*^9, 3.729709548781636*^9}, {
  3.7298708898467827`*^9, 3.729870905572448*^9}, {3.730461022288055*^9, 
  3.730461040938581*^9}},ExpressionUUID->"113c6429-ef33-4b94-862d-\
16b91c9f75d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getActionPos", "[", "action_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"stiffnessAction", ",", 
         RowBox[{"action", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"\[Phi]dotAction", ",", 
         RowBox[{"action", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729870934723309*^9, 3.7298710001986523`*^9}, {
  3.7298768800126133`*^9, 3.729876884683591*^9}, {3.730026629157143*^9, 
  3.730026635642105*^9}},ExpressionUUID->"684299d7-1856-4054-beeb-\
bfb0a11c3558"],

Cell["\<\
We could define an epsilon that decays as the number of episodes increases.\
\>", "Text",
 CellChangeTimes->{{3.728696394544428*^9, 3.728696414019815*^9}, {
  3.72869650560732*^9, 3.728696517145562*^9}, {3.728742340358164*^9, 
  3.7287423418439083`*^9}, {3.7305577802243147`*^9, 
  3.730557785726963*^9}},ExpressionUUID->"b486a386-e19f-4244-b44c-\
d59bb2ec0f2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getMaxPos", "[", 
    RowBox[{"state_", ",", "Q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"state", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
      RowBox[{"Max", "[", 
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"state", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"state", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"state", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], "]"}], 
    "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7293426382443542`*^9, 
  3.729342682898212*^9}},ExpressionUUID->"8f52c5cf-e2cf-4837-b768-\
934a4ae40088"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkPhiStateRand", "[", 
    RowBox[{"phi_", ",", "phiBounds_", ",", "actionBound_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{"phiBounds", ",", "phi"}], "]"}], "\[Equal]", " ", "True"}], 
     ",", 
     RowBox[{"return", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"{", 
        RowBox[{"0.", ",", 
         RowBox[{"phi", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Abs", "[", "phi", "]"}], ")"}], 
           RowBox[{"-", "1"}]], "actionBound"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"return", "=", 
      RowBox[{"RandomChoice", "[", "\[Phi]dotAction", "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.73257310661973*^9, 3.7325731718508787`*^9}, {
   3.732573569126829*^9, 3.732573572252674*^9}, {3.732573658723014*^9, 
   3.7325737694272757`*^9}, {3.732573803660055*^9, 3.732573804137994*^9}, {
   3.73257384231699*^9, 3.7325739226703672`*^9}, {3.732574006552396*^9, 
   3.732574029807639*^9}, {3.7325741764252*^9, 3.732574209727028*^9}, {
   3.7325742681864853`*^9, 3.732574290687949*^9}, {3.7325745174160757`*^9, 
   3.732574556715476*^9}, {3.732574641275478*^9, 3.732574657017983*^9}, {
   3.732574764999957*^9, 3.732574778587599*^9}, {3.732613310418405*^9, 
   3.732613369873897*^9}, {3.732613405496169*^9, 3.73261342530383*^9}, 
   3.732613480936336*^9, 
   3.732631411017083*^9},ExpressionUUID->"124ee6c3-3d83-42f6-8d4e-\
0fc9b8bcb4fa"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"chooseAction", "[", 
     RowBox[{
     "eps_", ",", "state_", ",", "Q_", ",", "phi_", ",", "phiBounds_", ",", 
      "actionBound_"}], "]"}], ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"eps", ">", 
       RowBox[{"Random", "[", "]"}]}], ",", 
      RowBox[{"action", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RandomChoice", "[", "stiffnessAction", "]"}], ",", 
         RowBox[{"checkPhiStateRand", "[", 
          RowBox[{"phi", ",", "phiBounds", ",", "actionBound"}], "]"}]}], 
        "}"}]}], ",", 
      RowBox[{"action", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"stiffnessAction", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"getMaxPos", "[", 
             RowBox[{"state", ",", "Q"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"phiBounds", ",", "phi"}], "]"}], "\[Equal]", " ", 
            "True"}], ",", 
           RowBox[{"action", "=", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{"{", 
              RowBox[{"0.", ",", 
               RowBox[{"phi", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"Abs", "[", "phi", "]"}], ")"}], 
                 RowBox[{"-", "1"}]], "actionBound"}]}], "}"}], "]"}]}], ",", 
           
           RowBox[{"action", "=", 
            RowBox[{"\[Phi]dotAction", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"getMaxPos", "[", 
                RowBox[{"state", ",", "Q"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]}], "]"}]}], 
        "}"}]}]}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.728696562078178*^9, 3.728696616949601*^9}, 
   3.728739271567623*^9, {3.728739511018176*^9, 3.72873952301724*^9}, {
   3.72873980656207*^9, 3.728739862193487*^9}, {3.728739900164473*^9, 
   3.728739911684786*^9}, {3.728740079577585*^9, 3.728740133207677*^9}, {
   3.728740175769524*^9, 3.728740197992474*^9}, {3.7287407343132753`*^9, 
   3.728740802747878*^9}, {3.728740874669862*^9, 3.7287409126067467`*^9}, {
   3.728741104132782*^9, 3.728741111028878*^9}, {3.72874115093542*^9, 
   3.728741151381824*^9}, {3.728918459647079*^9, 3.728918466445197*^9}, {
   3.7289186084509573`*^9, 3.728918662709717*^9}, {3.728918752713559*^9, 
   3.72891875690452*^9}, {3.7289263822068233`*^9, 3.7289264115703173`*^9}, {
   3.729341036034458*^9, 3.729341046430855*^9}, {3.729341165476618*^9, 
   3.72934116646585*^9}, {3.729341337865615*^9, 3.729341338168112*^9}, {
   3.729341988563365*^9, 3.729342008180361*^9}, {3.7293423596170473`*^9, 
   3.729342368842514*^9}, {3.7293426918268023`*^9, 3.729342788435853*^9}, {
   3.7293441740724783`*^9, 3.729344175575026*^9}, {3.732574728165084*^9, 
   3.7325747328183517`*^9}, {3.732574816996903*^9, 3.73257484382213*^9}, {
   3.73257494658528*^9, 3.7325749985625362`*^9}, {3.732576070874625*^9, 
   3.732576083497779*^9}, {3.732576870467493*^9, 3.732576870569215*^9}, {
   3.732613463211774*^9, 3.7326134781690187`*^9}, 3.732631412699381*^9, 
   3.732635561707137*^9},ExpressionUUID->"850d7ab6-7d19-4cb9-9ac5-\
3222fc41b0fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chooseAction", "[", 
    RowBox[{"eps_", ",", "state_", ",", "Q_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"eps", ">", 
      RowBox[{"Random", "[", "]"}]}], ",", 
     RowBox[{"action", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomChoice", "[", "stiffnessAction", "]"}], ",", 
        RowBox[{"RandomChoice", "[", "\[Phi]dotAction", "]"}]}], "}"}]}], ",", 
     RowBox[{"action", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"stiffnessAction", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"getMaxPos", "[", 
            RowBox[{"state", ",", "Q"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"action", "=", 
         RowBox[{"\[Phi]dotAction", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"getMaxPos", "[", 
             RowBox[{"state", ",", "Q"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732635514155326*^9, 
  3.732635557740088*^9}},ExpressionUUID->"e873c949-4832-489b-9e73-\
21e3e8137842"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]Update", "[", 
    RowBox[{"\[Phi]0_", ",", "t_", ",", "\[Phi]dot_"}], "]"}], ":=", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"\[Phi]0", "+", 
      RowBox[{"Integrate", "[", 
       RowBox[{"\[Phi]dot", ",", "t"}], "]"}]}], ",", 
     RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}], ";"}]], "Input",ExpressionUUID->\
"82b07ed4-248e-4516-917b-73b456dca9c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"takeAction", "[", 
    RowBox[{"action_", ",", "initialCon_", ",", "time_", ",", "\[Phi]0_"}], 
    "]"}], ":=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"odesk", "/.", 
               RowBox[{"{", 
                RowBox[{"c1", "\[Rule]", " ", "1"}], "}"}]}], "/.", 
              "ellipseMasses"}], "/.", 
             RowBox[{"{", 
              RowBox[{"k1", "\[Rule]", " ", 
               RowBox[{"action", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
              RowBox[{"\[Phi]0", "+", 
               RowBox[{
                RowBox[{"action", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "\[Delta]t"}]}]}], 
             "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
             RowBox[{"action", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Phi]", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
            "0.0"}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", "\[Rule]", " ", "1000"}], "}"}]}], "/.", 
        "robotParameters"}], ",", "initialCon"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "time", ",", " ", 
       RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<EquationSimplification\>\"", "\[Rule]", " ", "\"\<Residual\>\""}],
        "}"}]}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "All"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.72874119359476*^9, 3.728741215030493*^9}, {
   3.728741283780876*^9, 3.728741309334283*^9}, {3.728741411224587*^9, 
   3.728741463994328*^9}, {3.7287532341513433`*^9, 3.728753263433487*^9}, {
   3.7287533650838118`*^9, 3.728753374125037*^9}, {3.7289196970389*^9, 
   3.7289196990233793`*^9}, {3.729004234025774*^9, 3.7290042618810472`*^9}, {
   3.729081500728117*^9, 3.729081503931939*^9}, 3.729081783873748*^9, {
   3.729129125271319*^9, 3.729129126704165*^9}, {3.729129262805717*^9, 
   3.729129311995133*^9}, {3.729183059755*^9, 3.729183059918483*^9}, {
   3.7291831925368032`*^9, 3.729183192778504*^9}, {3.729344260395535*^9, 
   3.729344264680663*^9}, {3.729345840726055*^9, 3.729345882944232*^9}, {
   3.72934604997388*^9, 3.7293461275933332`*^9}, {3.729346316335318*^9, 
   3.729346327853944*^9}, {3.729346503476449*^9, 3.729346511556594*^9}, 
   3.7293466515281*^9, {3.729346928269916*^9, 3.7293469796624947`*^9}, {
   3.72934703893356*^9, 3.729347065472699*^9}, {3.729528496371563*^9, 
   3.729528496561482*^9}, {3.729529420093976*^9, 3.729529446895047*^9}, {
   3.729529491263261*^9, 3.7295294958391037`*^9}, {3.729529832615241*^9, 
   3.729529865138102*^9}, 3.729533732877241*^9, {3.7298025185007067`*^9, 
   3.729802525807848*^9}, {3.730027499581511*^9, 3.73002749992901*^9}, {
   3.730027562620401*^9, 3.7300275656747828`*^9}, {3.73005679303533*^9, 
   3.730056822394429*^9}, {3.7300568568677273`*^9, 3.730056859171741*^9}, {
   3.7307138589269*^9, 3.730713865057369*^9}, 3.730714714256014*^9, {
   3.730720209856659*^9, 3.730720214278102*^9}, {3.730720501877512*^9, 
   3.7307205019826393`*^9}, {3.730724543574522*^9, 3.7307245464011173`*^9}, {
   3.730747426663999*^9, 3.730747435120429*^9}, 3.730747466868417*^9, 
   3.730747515919881*^9, {3.730904495714592*^9, 3.730904507517613*^9}, {
   3.730905988884878*^9, 3.730905989093745*^9}, 3.73090615977544*^9, {
   3.730907606083803*^9, 3.7309076146216593`*^9}, {3.731063920656481*^9, 
   3.73106392430418*^9}, {3.731064099019403*^9, 3.7310640990814447`*^9}, {
   3.731064255042082*^9, 3.73106425739196*^9}, {3.7310648108667097`*^9, 
   3.73106483283309*^9}, {3.731064875875238*^9, 3.731064882434531*^9}, {
   3.731065355226468*^9, 3.7310653555928164`*^9}, {3.731065926391384*^9, 
   3.731065928020215*^9}, {3.731150165034245*^9, 3.731150179476763*^9}, {
   3.731150211526746*^9, 3.731150215431122*^9}, {3.731835295279316*^9, 
   3.731835304524167*^9}, 
   3.731857459369842*^9},ExpressionUUID->"99100ed1-089e-4d81-b821-\
40b6bc6c55db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"takeActionReduced", "[", 
    RowBox[{"action_", ",", "initialCon_", ",", "time_", ",", "\[Phi]0_"}], 
    "]"}], ":=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"fiberODE", ",", "\[Theta]1odek"}], "}"}], "/.", 
               RowBox[{"{", 
                RowBox[{"c1", "\[Rule]", " ", "1"}], "}"}]}], "/.", 
              "ellipseMasses"}], "/.", 
             RowBox[{"{", 
              RowBox[{"k1", "\[Rule]", 
               RowBox[{"action", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
              RowBox[{"\[Phi]0", "+", 
               RowBox[{
                RowBox[{"action", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "\[Delta]t"}]}]}], 
             "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
             RowBox[{"action", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Phi]", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
            "0.0"}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", "\[Rule]", " ", "1000"}], "}"}]}], "/.", 
        "robotParameters"}], ",", "initialCon"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "time", ",", " ", 
       RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<EquationSimplification\>\"", "\[Rule]", " ", "\"\<Residual\>\""}],
        "}"}]}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "All"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.731768974259246*^9, 3.731769024043787*^9}, 
   3.731835520583036*^9, 3.731839480958338*^9, 3.7318402730909843`*^9, {
   3.731857439590958*^9, 
   3.7318574481272717`*^9}},ExpressionUUID->"e542a312-ce03-458a-8c3d-\
2f1b7ffc622a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numOfEpisodes", " ", "=", " ", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.728689460162578*^9, 3.7286894634039*^9}, {
   3.728689562363535*^9, 3.728689576193242*^9}, {3.730415959461584*^9, 
   3.730415963411379*^9}, 3.730460864294846*^9, {3.7304912156396637`*^9, 
   3.730491216582067*^9}, {3.730491598975088*^9, 3.730491621869946*^9}, 
   3.730545803228072*^9, {3.730554067177697*^9, 3.730554069641202*^9}, {
   3.73090462454426*^9, 3.730904626848365*^9}, {3.73090488874546*^9, 
   3.730904889272147*^9}, {3.731883767986432*^9, 3.73188376817168*^9}, {
   3.7319364834762297`*^9, 3.731936483669071*^9}, 3.732377995247504*^9, 
   3.7324898748924847`*^9, 3.732531642327228*^9, {3.732625327856101*^9, 
   3.732625337144013*^9}, {3.7326313019061728`*^9, 3.732631302084723*^9}, 
   3.7326363204154654`*^9, {3.732636840541206*^9, 3.7326368422367477`*^9}, 
   3.732881430226709*^9, 
   3.732967577482765*^9},ExpressionUUID->"d015cf0d-eb22-4847-906f-\
f1fe1f4145dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lengthOfEpisode", "=", "20"}], ";"}]], "Input",
 CellChangeTimes->{{3.72875321279453*^9, 3.728753219030221*^9}, 
   3.728918372842695*^9, {3.7304147107972803`*^9, 3.730414711445558*^9}, {
   3.7304159657140217`*^9, 3.730415980135003*^9}, {3.730416079092004*^9, 
   3.730416079651176*^9}, 3.730460866387972*^9, {3.730491218165984*^9, 
   3.730491219079081*^9}, {3.7305458051002502`*^9, 3.7305458054794416`*^9}, {
   3.730545882763659*^9, 3.730545886457247*^9}, {3.731680319118318*^9, 
   3.731680319210245*^9}, {3.731883770361217*^9, 
   3.731883770753084*^9}},ExpressionUUID->"988c1a63-2fdd-4ea5-a2e8-\
024d1c19b795"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportCounter", "=", 
   FractionBox["numOfEpisodes", "1000"]}], ";"}]], "Input",
 CellChangeTimes->{{3.73246031331255*^9, 3.732460340662651*^9}, 
   3.732489877125704*^9, {3.732489981860093*^9, 3.73248998347567*^9}, 
   3.732531644862196*^9, {3.7326368361424303`*^9, 
   3.732636836348933*^9}},ExpressionUUID->"2a7594d6-1598-4cfd-92a3-\
c3fa5bb051ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getStatePos", "[", "state_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"states", ",", 
        RowBox[{"state", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"states", ",", 
        RowBox[{"state", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"states", ",", 
        RowBox[{"state", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"states", ",", 
        RowBox[{"state", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728917758352169*^9, 3.7289178415028467`*^9}, {
  3.7297096646176643`*^9, 3.729709738094046*^9}, {3.729878952013752*^9, 
  3.729879046380938*^9}, {3.729879099159412*^9, 3.729879110151094*^9}, {
  3.729879548872061*^9, 3.729879557765242*^9}, {3.729948561843144*^9, 
  3.729948567076433*^9}},ExpressionUUID->"db5bb125-87b7-4556-a344-\
ffdaa4fa4976"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getClosestStatePos", "[", 
    RowBox[{"states_", ",", "newState_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"states", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"states", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"states", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"states", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7299580455357533`*^9, 3.72995806693486*^9}, {
  3.729958246314361*^9, 3.729958300906825*^9}, {3.729958342974906*^9, 
  3.729958421920725*^9}, {3.7299587001143312`*^9, 3.729958715123528*^9}, {
  3.730718701690763*^9, 3.730718918193884*^9}, {3.730718978629118*^9, 
  3.730719015312976*^9}},ExpressionUUID->"d13cfe11-f6b9-49dd-9009-\
692c196443a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getInitialPos", "[", 
    RowBox[{"state1_", ",", "state2_", ",", "state3_", ",", "state4_"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"state1", ",", "0."}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"state2", ",", "0."}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"state3", ",", "0"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"state4", ",", "0."}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729958864995276*^9, 3.729958942296916*^9}, {
  3.7299590041548033`*^9, 3.729959009786365*^9}, {3.729959202913114*^9, 
  3.7299592277444344`*^9}, {3.729959285682823*^9, 3.729959367862871*^9}, {
  3.730713602403161*^9, 
  3.730713612442644*^9}},ExpressionUUID->"febe7fe7-f6dd-4487-a947-\
14a1a40503a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"currentTimeAndDate", "=", 
   RowBox[{"DateList", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732039766856236*^9, 
  3.732039774869223*^9}},ExpressionUUID->"4d9fd8b7-59f0-4b73-88a9-\
eba41c5727b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeAndDateStrings", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"ToString", "[", "#", "]"}], "&"}], "/@", 
     "currentTimeAndDate"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732039702002762*^9, 3.732039789628271*^9}, {
   3.732039833086803*^9, 3.7320398459312696`*^9}, {3.732039899481348*^9, 
   3.732039900874133*^9}, {3.7320399516281633`*^9, 3.732040041680122*^9}, 
   3.732040852132677*^9},ExpressionUUID->"11493537-9f45-4576-832d-\
f71ec78c71fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"space", "=", 
   RowBox[{"ToString", "[", "_", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7320403748254623`*^9, 
  3.732040380199196*^9}},ExpressionUUID->"06cb1722-d373-41a2-8500-\
77796309252c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeAndDateString", "=", 
   RowBox[{
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "<>", "space", "<>", 
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "<>", "space", "<>", 
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "<>", "space", "<>", 
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "<>", "space", "<>", 
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "5", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732040048776979*^9, 3.732040071857229*^9}, {
   3.732040107205275*^9, 3.732040199058991*^9}, {3.732040254059189*^9, 
   3.7320402559598627`*^9}, {3.732040285979056*^9, 3.7320403990089417`*^9}, 
   3.732040447212699*^9},ExpressionUUID->"9252ee7d-77ad-437b-bd9c-\
8adcf5b1142a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Initialize", " ", "Q", " ", "matrix"}], ",", " ", "states", ",", 
    " ", "actions", ",", " ", 
    RowBox[{"and", " ", "terminal", " ", "state", " ", 
     RowBox[{"(", 
      RowBox[{
      "defined", " ", "as", " ", "the", " ", "maximum", " ", "time", " ", 
       "one", " ", "can", " ", "wander", " ", "through", " ", "the", " ", 
       "state", " ", "space"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"begintime", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phiRange", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]states", " ", "=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"2", "\[Pi]"}], ",", 
       FractionBox["\[Pi]", "10"]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Theta]1states", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.0", ",", "\[Pi]", ",", 
       FractionBox["\[Pi]", "10"]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Phi]states", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.0", ",", "\[Pi]", ",", 
       FractionBox["\[Pi]", "10"]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Theta]1dotstates", "=", 
     RowBox[{"Range", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "\[Pi]"}], "2"], ",", 
       FractionBox["\[Pi]", "2"], ",", 
       FractionBox["\[Pi]", "10"]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Phi]dotAction", "=", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "phiRange"}], ",", "phiRange", ",", "phiRange"}], "]"}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{"stiffnessAction", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.1", ",", "0.5", ",", 
       FractionBox["1", "10"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stopForExport", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"states", "=", 
     RowBox[{"{", 
      RowBox[{
      "\[Theta]states", ",", "\[Theta]1states", ",", "\[Theta]1dotstates", 
       ",", "\[Phi]states"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"{", 
        RowBox[{"s1", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Theta]states", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s2", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Theta]1states", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s3", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Theta]1dotstates", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s4", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Phi]states", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a1", ",", "1", ",", 
         RowBox[{"Length", "[", "stiffnessAction", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a2", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Phi]dotAction", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Run", " ", "a", " ", "series", " ", "of", " ", "episodes"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "\[LessEqual]", " ", "numOfEpisodes"}], ",", " ", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"initialConditions", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "Initialize", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"statePos", "=", 
        RowBox[{"getInitialPos", "[", 
         RowBox[{
         "\[Theta]states", ",", "\[Theta]1states", ",", "\[Theta]1dotstates", 
          ",", "\[Phi]states"}], "]"}]}], ";", " ", 
       RowBox[{"pastx", "=", "0"}], ";", 
       RowBox[{"\[Phi]0", "=", "0.0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Take", " ", "\"\<lengthOfEpisode\>\"", " ", "steps", " ", "in", " ", 
         "the", " ", "environment"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "0"}], ",", " ", 
         RowBox[{"j", "<", "lengthOfEpisode"}], ",", " ", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Choose", " ", "the", " ", "action", " ", "from", " ", "current", 
           " ", "state", " ", "using", " ", "desired", " ", "policy"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"action", "=", 
           RowBox[{"chooseAction", "[", 
            RowBox[{"eps", ",", "statePos", ",", "Q"}], "]"}]}], ";", 
          RowBox[{"actionPos", "=", 
           RowBox[{"getActionPos", "[", "action", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "action", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Take", " ", "action", " ", "and", " ", "observe", " ", "distance",
             " ", "in", " ", "x", " ", "direction", " ", 
            RowBox[{"(", "reward", ")"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"solution", "=", 
           RowBox[{"takeActionReduced", "[", 
            RowBox[{
            "action", ",", "initialConditions", ",", "j", ",", "\[Phi]0"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"newx", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "t", "]"}], "/.", "solution"}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"t", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"j", "+", "\[Delta]t"}], ")"}]}], "}"}]}], ")"}], 
            "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Observe", " ", "new", " ", "state"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"newState", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
                  RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], ",", 
                  RowBox[{"\[Phi]0", "+", 
                   RowBox[{
                    RowBox[{"action", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "\[Delta]t"}]}]}], 
                 "}"}], "/.", "solution"}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"t", "\[Rule]", 
                RowBox[{"j", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Phi]0", "=", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Use", " ", 
            RowBox[{"Mod", "[", 
             RowBox[{"anglestates", ",", 
              RowBox[{"2", "pi"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"newState", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"newState", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"newState", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", 
             RowBox[{"newState", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"newState", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Determine", " ", "which", " ", "discretized", " ", "state", " ", 
            "newState", " ", "is", " ", "closest", " ", 
            RowBox[{"to", ".", " ", "Really"}], " ", "this", " ", "finds", 
            " ", "the", " ", "closest", " ", "position", " ", "in", " ", 
            "the", " ", "set", " ", "of", " ", "states", " ", "and", " ", 
            "returns", " ", "it", " ", "so", " ", "it", " ", "can", " ", "be",
             " ", "matched", " ", "in", " ", "the", " ", "Q", " ", 
            RowBox[{"matrix", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"newStatePos", "=", 
           RowBox[{"getClosestStatePos", "[", 
            RowBox[{"states", ",", "newState"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Compute", " ", "reward", " ", "and", " ", "update", " ", 
            "previous", " ", "x", " ", "position"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"r", "=", 
           RowBox[{"Reward", "[", 
            RowBox[{"newx", ",", "pastx"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pastx", "=", "newx"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Update", " ", "Q", " ", "matrix"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"statePos", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"statePos", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"statePos", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"statePos", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", 
              RowBox[{"actionPos", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"actionPos", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"QUpdate", "[", 
            RowBox[{
            "newStatePos", ",", "statePos", ",", "actionPos", ",", "r", ",", 
             "Q"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"statePos", "=", "newStatePos"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"initialConditions", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                   RowBox[{"x", "[", "t", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"y", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                   RowBox[{"y", "[", "t", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"\[Theta]", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", " ", 
                   RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"\[Theta]1", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                   RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]1", "'"}], "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}], "}"}], "/.",
                 "solution"}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"t", "\[Rule]", 
                RowBox[{"j", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "stopForExport"}], ",", 
            RowBox[{
             RowBox[{"Save", "[", 
              RowBox[{
               RowBox[{
               "\"\<Qmatrix_\>\"", "<>", "timeAndDateString", "<>", 
                "\"\<_N\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], ",", "Q"}], "]"}], ";", 
             RowBox[{"stopForExport", "=", 
              RowBox[{"stopForExport", "+", "exportCounter"}]}]}], ",", "0"}],
            "]"}]}]}], "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"endtime", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.728689581518546*^9, 3.728689615312394*^9}, 
   3.7286941647736464`*^9, {3.728695737261636*^9, 3.7286957380791807`*^9}, {
   3.72869585929565*^9, 3.728695955553832*^9}, {3.728696081194812*^9, 
   3.728696092176812*^9}, {3.728696215164219*^9, 3.728696231322385*^9}, 
   3.728696359787573*^9, {3.728739570779256*^9, 3.7287395858067703`*^9}, {
   3.7287396194999657`*^9, 3.728739653525442*^9}, {3.728739683790032*^9, 
   3.728739785361299*^9}, {3.728740028520664*^9, 3.728740075946369*^9}, {
   3.7287409427356253`*^9, 3.7287409682726603`*^9}, {3.728741070309183*^9, 
   3.728741071042869*^9}, {3.728741176006822*^9, 3.728741177572742*^9}, 
   3.728741540909439*^9, {3.728742299252442*^9, 3.728742311779398*^9}, {
   3.728742350947892*^9, 3.728742513041638*^9}, {3.728748005735429*^9, 
   3.728748026855509*^9}, {3.728748139820073*^9, 3.7287482061088133`*^9}, {
   3.7287482493597527`*^9, 3.728748377458127*^9}, {3.7287489006699457`*^9, 
   3.728748921357315*^9}, {3.728753223241434*^9, 3.7287532240787153`*^9}, 
   3.728753361788067*^9, {3.72891523714695*^9, 3.728915293420721*^9}, {
   3.728915354061791*^9, 3.7289153587506227`*^9}, {3.728915520978806*^9, 
   3.728915667848031*^9}, {3.728915773771941*^9, 3.728915895108242*^9}, {
   3.7289177452810583`*^9, 3.72891775492566*^9}, {3.728917846513974*^9, 
   3.7289178612014236`*^9}, {3.728917909186531*^9, 3.728918061351039*^9}, {
   3.728918105148635*^9, 3.7289181285534687`*^9}, {3.728918209421192*^9, 
   3.7289183170966597`*^9}, {3.7289185020005817`*^9, 3.72891850786688*^9}, {
   3.7289196442425222`*^9, 3.728919664926812*^9}, {3.7289197070430527`*^9, 
   3.728919834548545*^9}, {3.728923389818783*^9, 3.72892340904414*^9}, {
   3.728925246691921*^9, 3.728925374951153*^9}, {3.72892540690519*^9, 
   3.728925448091036*^9}, {3.7289254893062696`*^9, 3.728925524561845*^9}, 
   3.728925757356737*^9, 3.728926602512512*^9, 3.72892670521178*^9, 
   3.729340917802877*^9, {3.729533875029812*^9, 3.729533893507629*^9}, {
   3.729534031243046*^9, 3.7295340545844717`*^9}, {3.729534200619631*^9, 
   3.72953420520735*^9}, {3.729614326394968*^9, 3.729614328232863*^9}, {
   3.729614398289344*^9, 3.729614409024219*^9}, {3.729614469876074*^9, 
   3.729614511117608*^9}, {3.729614577855783*^9, 3.7296145817400293`*^9}, {
   3.7296147800442133`*^9, 3.729614781999806*^9}, {3.729614854526167*^9, 
   3.729614856616632*^9}, {3.72961489971248*^9, 3.729614902637236*^9}, {
   3.729707617625288*^9, 3.729707617882737*^9}, {3.729707660884027*^9, 
   3.729707669190926*^9}, 3.7297077158432198`*^9, {3.729707750330661*^9, 
   3.729707802268156*^9}, {3.7297078879492207`*^9, 3.729707888260158*^9}, {
   3.729709282810712*^9, 3.729709286506531*^9}, {3.729709316812042*^9, 
   3.7297094005841427`*^9}, {3.729709803017239*^9, 3.7297098368363132`*^9}, {
   3.729802896816659*^9, 3.7298029127892437`*^9}, 3.729868735880642*^9, {
   3.729871333840446*^9, 3.729871357865073*^9}, 3.729877347717465*^9, 
   3.7298785295592937`*^9, {3.7299584798661013`*^9, 3.729958506525893*^9}, 
   3.729958539918836*^9, {3.729958781254201*^9, 3.7299588185663*^9}, 
   3.7299590718299723`*^9, {3.729959375706689*^9, 3.729959409022285*^9}, {
   3.729959920158019*^9, 3.729959962894096*^9}, {3.7299717372982407`*^9, 
   3.729971822614258*^9}, {3.729979172293437*^9, 3.729979172828383*^9}, {
   3.729979437258952*^9, 3.729979455339877*^9}, {3.7299795484154663`*^9, 
   3.729979548744803*^9}, {3.7299799251779203`*^9, 3.729979932117083*^9}, {
   3.730026407768024*^9, 3.7300264111976748`*^9}, {3.730026489889102*^9, 
   3.73002649957132*^9}, {3.730027572016412*^9, 3.730027579867453*^9}, {
   3.730055615691948*^9, 3.7300556543129*^9}, {3.7300566190576267`*^9, 
   3.730056625044524*^9}, {3.73005690551342*^9, 3.730056962231593*^9}, {
   3.730057014587667*^9, 3.730057115733994*^9}, {3.730057314182654*^9, 
   3.730057325026668*^9}, {3.730057483177136*^9, 3.730057536263739*^9}, {
   3.730057700530176*^9, 3.730057705199697*^9}, {3.7300578870454884`*^9, 
   3.730057887239399*^9}, {3.73005851625852*^9, 3.730058519168083*^9}, {
   3.73012666050305*^9, 3.730126674847342*^9}, 3.7301267366694593`*^9, {
   3.730126880720625*^9, 3.730126884062903*^9}, 3.7301439547402477`*^9, {
   3.730414391555894*^9, 3.730414412721047*^9}, {3.730415424482593*^9, 
   3.7304154415607452`*^9}, {3.730415764372644*^9, 3.7304157648040533`*^9}, 
   3.730459447498063*^9, 3.730460856851231*^9, {3.730461499132008*^9, 
   3.730461509765209*^9}, {3.730482482961628*^9, 3.730482503597061*^9}, {
   3.7304835757708406`*^9, 3.73048359621646*^9}, {3.730484477644745*^9, 
   3.7304844798973207`*^9}, 3.730488419918128*^9, {3.730490341342449*^9, 
   3.730490352564644*^9}, {3.7304913270075283`*^9, 3.73049134152775*^9}, {
   3.730491686346582*^9, 3.730491707138983*^9}, 3.730492581392087*^9, {
   3.730507137512926*^9, 3.730507152249349*^9}, {3.730509425029668*^9, 
   3.730509485196582*^9}, {3.730546877767254*^9, 3.7305468994294767`*^9}, 
   3.730549352400691*^9, {3.730561679629273*^9, 3.7305616839479237`*^9}, {
   3.730562686271266*^9, 3.730562686551676*^9}, {3.730562870066699*^9, 
   3.730562879186696*^9}, {3.730563284552273*^9, 3.730563291975011*^9}, {
   3.730563726306808*^9, 3.7305637410337467`*^9}, {3.730713249069837*^9, 
   3.730713249416389*^9}, {3.7307189491826344`*^9, 3.730718949487966*^9}, {
   3.7307198174241333`*^9, 3.730719826267559*^9}, {3.7307333841787653`*^9, 
   3.7307334152316504`*^9}, {3.730738930118737*^9, 3.730738930252907*^9}, {
   3.7307389646444483`*^9, 3.7307389694095707`*^9}, {3.730739007888445*^9, 
   3.730739013468151*^9}, {3.7307403166126747`*^9, 3.730740316985468*^9}, {
   3.730740396842434*^9, 3.7307404002454576`*^9}, {3.730740763371683*^9, 
   3.730740767073338*^9}, {3.7307476369893293`*^9, 3.7307476437315073`*^9}, {
   3.73074780356357*^9, 3.730747806955146*^9}, {3.7307478837857857`*^9, 
   3.730747933135504*^9}, {3.730748009569006*^9, 3.730748015150573*^9}, {
   3.730904529121311*^9, 3.730904531455433*^9}, {3.7309047507744837`*^9, 
   3.7309047509841013`*^9}, {3.730904869562533*^9, 3.730904885142518*^9}, {
   3.730905057668766*^9, 3.730905070513611*^9}, {3.730906390301345*^9, 
   3.7309064015154047`*^9}, {3.730906470350726*^9, 3.730906494012581*^9}, {
   3.730906533263646*^9, 3.730906567968755*^9}, {3.730906711012601*^9, 
   3.730906791674972*^9}, {3.730906880175077*^9, 3.730906885390724*^9}, {
   3.730907091128996*^9, 3.730907093498013*^9}, {3.7309073980219*^9, 
   3.730907398273355*^9}, {3.7309075279285192`*^9, 3.730907628536096*^9}, {
   3.731064895221716*^9, 3.731064914618842*^9}, {3.731064973889358*^9, 
   3.731065002729374*^9}, {3.731065094487329*^9, 3.7310650999229727`*^9}, {
   3.731065149861177*^9, 3.731065163188781*^9}, {3.731066338871211*^9, 
   3.7310663412986317`*^9}, {3.731066481879766*^9, 3.7310664874466467`*^9}, 
   3.73106689879779*^9, {3.731068248391036*^9, 3.7310682701461143`*^9}, {
   3.731068563062964*^9, 3.7310685634034967`*^9}, {3.731150341784704*^9, 
   3.731150342901146*^9}, {3.7311504471938677`*^9, 3.731150473017034*^9}, {
   3.731691745857808*^9, 3.7316917516828947`*^9}, {3.7317690505910673`*^9, 
   3.731769051587451*^9}, {3.7317709367379704`*^9, 3.731770938399763*^9}, {
   3.7317775788836737`*^9, 3.7317775798831787`*^9}, {3.731791737212124*^9, 
   3.731791737454773*^9}, {3.7318355339586687`*^9, 3.731835534898444*^9}, {
   3.7318355771312647`*^9, 3.731835579429645*^9}, {3.731839533777299*^9, 
   3.731839534776393*^9}, {3.7318400108349247`*^9, 3.731840017212468*^9}, 
   3.731840226555291*^9, {3.731840519997286*^9, 3.731840572667068*^9}, {
   3.7318411584878283`*^9, 3.7318411591175213`*^9}, {3.731857387146723*^9, 
   3.7318573940208817`*^9}, {3.731858306391819*^9, 3.731858312595949*^9}, {
   3.731865872197166*^9, 3.731865874414562*^9}, 3.73186610164261*^9, 
   3.731866225998015*^9, {3.731867629245284*^9, 3.731867641864797*^9}, 
   3.731867765421174*^9, {3.731868283900235*^9, 3.73186828813937*^9}, {
   3.731883892961535*^9, 3.731883925390669*^9}, {3.7319264113656282`*^9, 
   3.731926420983573*^9}, {3.731940541239169*^9, 3.731940543980365*^9}, {
   3.731946136504448*^9, 3.731946139780114*^9}, {3.731946320866596*^9, 
   3.73194635699356*^9}, {3.732377932223506*^9, 3.732377936795772*^9}, {
   3.732455955478018*^9, 3.732455994450157*^9}, {3.7324603636102858`*^9, 
   3.732460402243087*^9}, {3.732461182968706*^9, 3.732461380451458*^9}, {
   3.7324845700343723`*^9, 3.732484624080113*^9}, {3.732485082161111*^9, 
   3.732485087080131*^9}, {3.732489262782976*^9, 3.732489296980488*^9}, {
   3.7324894277269173`*^9, 3.7324894281582413`*^9}, {3.732489746270802*^9, 
   3.732489825746612*^9}, {3.732489987049328*^9, 3.732490014810935*^9}, {
   3.73249019904748*^9, 3.732490216806916*^9}, 3.7325316166122503`*^9, 
   3.732531653470093*^9, {3.7325729345283546`*^9, 3.7325729418345013`*^9}, {
   3.732573016352331*^9, 3.732573037614915*^9}, {3.732574674029216*^9, 
   3.732574700323551*^9}, {3.732575083843273*^9, 3.732575086501886*^9}, {
   3.73257514583214*^9, 3.732575166546454*^9}, {3.732575216102474*^9, 
   3.73257521681595*^9}, {3.732575251411289*^9, 3.7325752517033367`*^9}, {
   3.732575359313403*^9, 3.732575369328494*^9}, {3.732575521621441*^9, 
   3.732575528403646*^9}, {3.732576696207685*^9, 3.732576698781084*^9}, 
   3.732577398705229*^9, {3.732635614627253*^9, 3.7326356294954348`*^9}, {
   3.732635680484627*^9, 3.732635714514879*^9}, {3.7326362545857687`*^9, 
   3.7326362897007837`*^9}, {3.732636850289624*^9, 3.7326368519282312`*^9}, {
   3.7328814357519608`*^9, 3.732881444300351*^9}, {3.732891989557762*^9, 
   3.7328919958130913`*^9}, 
   3.7329157214572773`*^9},ExpressionUUID->"a77627b3-dc99-4ccd-a6b4-\
74a85a839b2e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"totaltime", "=", 
   RowBox[{"endtime", "-", "begintime"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732455999908149*^9, 3.732456011839985*^9}, 
   3.732967543367963*^9},ExpressionUUID->"6a94f4d2-6744-48e7-b6c8-\
6420e4fb9487"],

Cell[BoxData["3.944886`7.047579450905466"], "Output",
 CellChangeTimes->{3.7324582019150553`*^9, 3.73248860227323*^9, 
  3.7325348638290157`*^9, 3.732579673567629*^9, 3.732615509384911*^9, 
  3.732624507474387*^9, 3.732627319544695*^9, 3.732631576573838*^9, 
  3.7326367061394987`*^9, 3.732900920257265*^9, 
  3.732916081717601*^9},ExpressionUUID->"31a02095-7df0-4a5c-9519-\
6c5b1955120e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", "totaltime", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.732967513781086*^9, 
  3.7329675393501577`*^9}},ExpressionUUID->"2406a46b-6e2a-4559-8fe9-\
9292650fbd48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"totaltime", "/", "3600"}], ";"}]], "Input",
 CellChangeTimes->{{3.7325355876838493`*^9, 3.7325355991798964`*^9}, 
   3.732967544581709*^9},ExpressionUUID->"a94d5d13-2178-4a6e-8cad-\
eec5ec422eed"],

Cell[BoxData["0.00109580166666666666667817462945924392`7.047579450905466"], \
"Output",
 CellChangeTimes->{3.7325356032453213`*^9, 3.732579673946271*^9, 
  3.732615509720117*^9, 3.732624507836932*^9, 3.732627319875759*^9, 
  3.7326315776511803`*^9, 3.732636706260775*^9, 3.73290092034059*^9, 
  3.732916081790873*^9},ExpressionUUID->"f7a1b7b7-e1b8-43cb-aa51-\
4edad9e08769"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Qfinal", "=", "Q"}], ";"}]], "Input",
 CellChangeTimes->{{3.730546154714241*^9, 3.730546158865251*^9}, {
   3.731866016226417*^9, 3.731866017200563*^9}, 3.732738971234016*^9, 
   3.7328792874871597`*^9},ExpressionUUID->"8e4727ea-5bb3-412e-afe2-\
311f476db0e7"],

Cell[CellGroupData[{

Cell["Policy Extraction and Simulation", "Subchapter",
 CellChangeTimes->{{3.730485014566964*^9, 3.7304850160497093`*^9}, {
  3.730486471705052*^9, 3.730486473994205*^9}, {3.730557238210308*^9, 
  3.7305572395047398`*^9}},ExpressionUUID->"6253d8fc-475f-493c-bae4-\
998f92580913"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"statePos", "=", 
   RowBox[{"getInitialPos", "[", 
    RowBox[{
    "\[Theta]states", ",", "\[Theta]1states", ",", "\[Theta]1dotstates", ",", 
     "\[Phi]states"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialConditions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]0", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newState", "\[Equal]", "\[Phi]0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfSol", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfActionPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfPhiPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfPhiDotPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfActions", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfMomentumPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"time", "=", "0"}], ",", 
   RowBox[{"time", "<", "lengthOfEpisode"}], ",", 
   RowBox[{"time", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Use", " ", "an", " ", "epsilon", " ", "of", " ", "zero", " ", "in", " ", 
     "the", " ", "chooseAction", " ", "function", " ", 
     RowBox[{"(", 
      RowBox[{"act", " ", "entirely", " ", "greedy"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"action", "=", 
     RowBox[{"chooseAction", "[", 
      RowBox[{"0.0", ",", "statePos", ",", "Qfinal"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfActions", ",", "action"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"solutionFinal", "=", 
     RowBox[{"takeActionReduced", "[", 
      RowBox[{
      "action", ",", "initialConditions", ",", "time", ",", "\[Phi]0"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"newState", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
            RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], ",", 
            RowBox[{"\[Phi]0", "+", 
             RowBox[{
              RowBox[{"action", "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", "\[Delta]t"}]}]}], "}"}], 
          "/.", "solutionFinal"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"t", "\[Rule]", " ", 
          RowBox[{"time", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"newState", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Use", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{"anglestates", ",", 
        RowBox[{"2", "pi"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"newState", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"newState", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"newState", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"2", "\[Pi]"}]}], "]"}], ",", 
       RowBox[{"newState", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"newState", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"action", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"newState", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Determine", " ", "which", " ", "discretized", " ", "state", " ", 
      "newState", " ", "is", " ", "closest", " ", 
      RowBox[{"to", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"newStatePos", "=", 
     RowBox[{"getClosestStatePos", "[", 
      RowBox[{"states", ",", "newState"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"statePos", "=", "newStatePos"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Generate", " ", "a", " ", "plot", " ", "for", " ", "the", " ", "state", 
      " ", "and", " ", "action", " ", "over", " ", "\[Delta]t"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfSol", ",", "solutionFinal"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"time", "\[Equal]", "0"}], ",", 
      RowBox[{"plotState", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", " ", 
             RowBox[{"y", "[", "t", "]"}], ",", " ", 
             RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}], "/.", 
           "solutionFinal"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", "time", ",", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
           "\"\<x[t] (m)\>\"", ",", "\"\<y[t] (m)\>\"", ",", 
            "\"\<\[Theta][t] (radians)\>\""}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Green", ",", "Red"}], "}"}]}]}], "]"}]}], 
      ",", 
      RowBox[{"plotState", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", " ", 
             RowBox[{"y", "[", "t", "]"}], ",", " ", 
             RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}], " ", "/.", 
           "solutionFinal"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", "time", ",", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Green", ",", "Red"}], "}"}]}]}], "]"}]}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfPlots", ",", "plotState"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"time", "\[Equal]", "0"}], ",", 
      RowBox[{"plotAction", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{"action", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "time", ",", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", " ", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<k1[t] (Nms/(radian))\>\"", ",", 
            "\"\<\[Phi]'[t] (radians)\>\""}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Cyan", ",", "Magenta"}], "}"}]}]}], "]"}]}], ",", 
      RowBox[{"plotAction", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{"action", ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "time", ",", " ", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Cyan", ",", "Magenta"}], "}"}]}]}], "]"}]}]}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfActionPlots", ",", "plotAction"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Compute", " ", "the", " ", "momenta"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"momentum", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2", ",", "J3"}], "}"}], "/.", 
            "ellipseMasses"}], "/.", 
           RowBox[{"{", 
            RowBox[{"k1", "\[Rule]", " ", 
             RowBox[{"action", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\[Rho]", "\[Rule]", "1000"}], "}"}]}], "/.", 
         "robotParameters"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", "\[Phi]0"}], "}"}]}], 
       "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", 
         RowBox[{"action", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "/.", 
      "solutionFinal"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"time", "\[Equal]", "0"}], ",", 
      RowBox[{"plotMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "momentum", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "time", ",", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<J1\>\"", ",", "\"\<J2\>\"", ",", "\"\<J3\>\""}], 
           "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<t\>\"", ",", "\"\<Momentum\>\""}], "}"}]}]}], "]"}]}],
       ",", 
      RowBox[{"plotMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "momentum", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "time", ",", " ", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}]}]}], "]"}]}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfMomentumPlots", ",", "plotMom"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"initialConditions", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{"x", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{"y", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", " ", 
              RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "'"}], "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"x", "'"}], "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"y", "'"}], "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"y", "'"}], "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[Theta]1", "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]1", "'"}], "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}], "}"}], "/.", 
           "solutionFinal"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "*)"}], 
    RowBox[{"initialConditions", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
             RowBox[{"x", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
             RowBox[{"y", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", " ", 
             RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{"\[Theta]1", "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
             RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]1", "'"}], "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}], "}"}], "/.", 
          "solutionFinal"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"t", "\[Rule]", 
          RowBox[{"time", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7305459735720673`*^9, 3.730545997356604*^9}, {
   3.730546062992964*^9, 3.7305461059518833`*^9}, {3.7305462547196608`*^9, 
   3.730546342625689*^9}, {3.7305463988683023`*^9, 3.7305465047599497`*^9}, {
   3.730546562953166*^9, 3.730546563348489*^9}, {3.7305469417511263`*^9, 
   3.730546999382121*^9}, 3.730547065063829*^9, {3.7305471919884233`*^9, 
   3.730547192435595*^9}, {3.7305481174003277`*^9, 3.730548157809441*^9}, {
   3.73054819831284*^9, 3.730548210962347*^9}, {3.7305482500286713`*^9, 
   3.7305482757602043`*^9}, {3.730548542544187*^9, 3.730548543418495*^9}, {
   3.730548600332094*^9, 3.730548600573841*^9}, 3.7305486672841988`*^9, {
   3.730548895522614*^9, 3.730548909316194*^9}, {3.730548953226276*^9, 
   3.730548960055077*^9}, 3.730549357741788*^9, {3.730550463688058*^9, 
   3.73055048149841*^9}, 3.7305505403460093`*^9, {3.730550688932036*^9, 
   3.7305507774942827`*^9}, {3.7305513392651443`*^9, 
   3.7305513687293253`*^9}, {3.7305520761838427`*^9, 3.730552098470697*^9}, {
   3.730552340271144*^9, 3.730552473223178*^9}, {3.73055250465972*^9, 
   3.730552530617074*^9}, {3.730552746587205*^9, 3.730552757349846*^9}, 
   3.730553195848987*^9, {3.73055343723001*^9, 3.730553439916617*^9}, {
   3.730553506513101*^9, 3.7305535181119833`*^9}, 3.7305536731407757`*^9, {
   3.730553829351698*^9, 3.7305538297801723`*^9}, {3.7305543843746443`*^9, 
   3.730554519609355*^9}, {3.730557521375916*^9, 3.730557533020211*^9}, {
   3.7305616261990128`*^9, 3.730561629643557*^9}, {3.730562594263714*^9, 
   3.730562605074683*^9}, {3.730562650456107*^9, 3.7305626579764633`*^9}, {
   3.730562823127626*^9, 3.7305628343366823`*^9}, {3.7305632977202168`*^9, 
   3.7305633013668633`*^9}, {3.730563493173896*^9, 3.730563501550852*^9}, {
   3.7305636223718433`*^9, 3.73056362510673*^9}, {3.730563850219544*^9, 
   3.7305638578640614`*^9}, {3.730563944931015*^9, 3.730563945198029*^9}, {
   3.730564407190024*^9, 3.7305644242957973`*^9}, {3.730567517368486*^9, 
   3.73056756688341*^9}, {3.7305678747816563`*^9, 3.730567906250959*^9}, {
   3.730713099141921*^9, 3.7307131030252333`*^9}, {3.730713507544539*^9, 
   3.730713511500231*^9}, {3.7307167956842337`*^9, 3.730716802978016*^9}, {
   3.730717543355204*^9, 3.730717552638523*^9}, {3.730717625868754*^9, 
   3.730717643596508*^9}, {3.7307177132354383`*^9, 3.7307177348081636`*^9}, {
   3.7307179791549463`*^9, 3.730717993106646*^9}, {3.730718037296219*^9, 
   3.730718054826284*^9}, {3.7307198753462954`*^9, 3.730719880571014*^9}, {
   3.730719928095852*^9, 3.730719947310933*^9}, {3.730725999354559*^9, 
   3.730726021321785*^9}, {3.730726091287776*^9, 3.730726310957786*^9}, {
   3.7307263813192596`*^9, 3.730726385540421*^9}, {3.730733316615975*^9, 
   3.730733371349413*^9}, {3.7307402783173428`*^9, 3.7307402787751904`*^9}, {
   3.730740944001623*^9, 3.730740970953299*^9}, {3.730905012253633*^9, 
   3.73090504524997*^9}, {3.7309054109852953`*^9, 3.730905480904007*^9}, {
   3.7309080504879208`*^9, 3.730908134051876*^9}, {3.731065175564323*^9, 
   3.731065198586803*^9}, {3.731065266059454*^9, 3.7310652935940104`*^9}, {
   3.731068324901758*^9, 3.731068330626403*^9}, {3.731068447561943*^9, 
   3.731068453991548*^9}, {3.7310688746132307`*^9, 3.73106889278771*^9}, {
   3.7310695580206842`*^9, 3.731069562533399*^9}, {3.7310888835897293`*^9, 
   3.731088887789713*^9}, 3.7311505631996717`*^9, {3.731150634701579*^9, 
   3.731150636843803*^9}, {3.731150976796076*^9, 3.731150980536997*^9}, 
   3.731152604705617*^9, {3.731701088123979*^9, 3.731701149900114*^9}, {
   3.7317012626707783`*^9, 3.7317013763604794`*^9}, {3.731702728730996*^9, 
   3.7317027803693323`*^9}, {3.731703506632496*^9, 3.7317035098529673`*^9}, {
   3.731703555214724*^9, 3.731703556326046*^9}, {3.731705952914575*^9, 
   3.731705954549706*^9}, {3.731706089109084*^9, 3.731706106932028*^9}, {
   3.7317061502080097`*^9, 3.731706170179904*^9}, {3.7317062728511877`*^9, 
   3.7317062766945677`*^9}, 3.731753044996395*^9, {3.731753442605217*^9, 
   3.731753457536634*^9}, {3.731753593717779*^9, 3.731753618554467*^9}, {
   3.731754639455523*^9, 3.73175463958222*^9}, {3.73175488627264*^9, 
   3.731754948817451*^9}, {3.731754982229828*^9, 3.7317549853720903`*^9}, {
   3.7317551219613733`*^9, 3.731755128247864*^9}, {3.731755169785754*^9, 
   3.731755206713382*^9}, {3.731756123554084*^9, 3.73175612544068*^9}, {
   3.731760608484229*^9, 3.731760646101158*^9}, {3.73176113882404*^9, 
   3.7317611442107897`*^9}, {3.731761398526168*^9, 3.73176144705375*^9}, {
   3.73176154841798*^9, 3.7317616101101503`*^9}, {3.731761690580051*^9, 
   3.731761692687572*^9}, {3.731761730082058*^9, 3.73176173212455*^9}, {
   3.7317690599388123`*^9, 3.731769060739099*^9}, {3.731770929378722*^9, 
   3.7317709312657957`*^9}, {3.731796769389903*^9, 3.731796773369732*^9}, {
   3.731833226958516*^9, 3.73183323103568*^9}, {3.7318333485596037`*^9, 
   3.73183335838748*^9}, {3.731833437984645*^9, 3.7318334446412086`*^9}, {
   3.7318351031119833`*^9, 3.731835128471099*^9}, {3.7318393262672453`*^9, 
   3.731839364529031*^9}, {3.731839430959543*^9, 3.7318394479058323`*^9}, {
   3.731840597472514*^9, 3.731840637664463*^9}, {3.731841353622315*^9, 
   3.731841354658901*^9}, {3.731841989059877*^9, 3.7318420135339737`*^9}, 
   3.731842099080724*^9, {3.731842166713674*^9, 3.7318421722653027`*^9}, {
   3.731843207461866*^9, 3.731843209443447*^9}, {3.731843841496307*^9, 
   3.731843874081119*^9}, 3.73184555911031*^9, {3.731845710183393*^9, 
   3.731845717320092*^9}, {3.7318468368537827`*^9, 3.731846845431086*^9}, {
   3.731846950188971*^9, 3.731846982872272*^9}, {3.731847107441374*^9, 
   3.7318471320123253`*^9}, 3.731851850577132*^9, 3.731857410394494*^9, {
   3.731858271468171*^9, 3.7318582938310223`*^9}, 3.731867754415841*^9, {
   3.731868383216827*^9, 3.731868390303733*^9}, 3.731869039602993*^9, {
   3.731869169398052*^9, 3.731869180516755*^9}, {3.732038740492119*^9, 
   3.732038872212875*^9}, {3.732039007864201*^9, 3.732039059771248*^9}, {
   3.7324602152128572`*^9, 3.732460225448893*^9}, {3.732580344172082*^9, 
   3.732580350345944*^9}, {3.7326160453403482`*^9, 3.732616048618703*^9}, 
   3.732635645076518*^9, {3.732892035783375*^9, 
   3.732892036582593*^9}},ExpressionUUID->"45725f42-39f2-4357-b579-\
b8e1199cc200"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{
    RowBox[{"\"\<Momenta_\>\"", "<>", "timeAndDateString"}], ",", 
    "listOfMomentumPlots"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7329814864197397`*^9, 
  3.732981514222212*^9}},ExpressionUUID->"5f2bf221-d293-49c8-a2c2-\
c63cf280e3d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{
    RowBox[{"\"\<Actions_\>\"", "<>", "timeAndDateString"}], ",", 
    "listOfActionPlots"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.732981515779233*^9, 
  3.732981530110738*^9}},ExpressionUUID->"c7dbdadb-d6f4-4352-a552-\
f3a8fd6fceb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", "\"\<Finished extracting policy\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.732971194470697*^9, 
  3.7329712034944267`*^9}},ExpressionUUID->"e48e6591-bc2b-450e-96ff-\
870c69d18d9c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Show", "[", 
   RowBox[{"listOfMomentumPlots", ",", 
    RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7326159223447113`*^9, 3.732615932511825*^9}, 
   3.732880848509235*^9},ExpressionUUID->"212490a3-192d-4840-8681-\
6c553ff706dc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"trajectories", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"listOfPlots", ",", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.730548296087528*^9, 3.730548306928697*^9}, {
  3.7305484604394007`*^9, 3.73054850436032*^9}, {3.73054854658587*^9, 
  3.730548546812771*^9}, {3.730548581391212*^9, 3.7305486319785833`*^9}, {
  3.732040454054358*^9, 
  3.73204046040199*^9}},ExpressionUUID->"0faaad17-dc8d-4f03-8775-\
5794d0529b89"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\<trajectories\>\"", "<>", "timeAndDateString", "<>", 
      "\"\<.pdf\>\""}], ",", "trajectories"}], "]"}], ";"}], "*)"}]], "Input",\

 CellChangeTimes->{{3.732040465444656*^9, 3.732040511657106*^9}, {
  3.732971098218533*^9, 
  3.732971107843895*^9}},ExpressionUUID->"0073d0e0-60ed-4366-8a76-\
803571d95a4a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Print", "[", "\"\<Should have exported trajectories\>\"", "]"}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7329713938114634`*^9, 
  3.7329714066203527`*^9}},ExpressionUUID->"05877f96-d73d-404e-a8ed-\
dd54f9096b7c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Show", "[", 
   RowBox[{"listOfMomentumPlots", ",", 
    RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.731703418755691*^9, 3.731703428098918*^9}, {
   3.7317601977098827`*^9, 3.7317602194169407`*^9}, 
   3.732039081347639*^9},ExpressionUUID->"6400a6f3-c5b9-4095-b801-\
24f86cf05346"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]Dots", "=", 
   RowBox[{"Last", "/@", "listOfActions"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7311656724991198`*^9, 
  3.73116568597458*^9}},ExpressionUUID->"6bba8d71-d079-4e42-9ab3-\
e01ead95b361"],

Cell[BoxData[
 RowBox[{
  RowBox[{"t\[Phi]dotpairs", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
      "@", 
      RowBox[{"(", 
       RowBox[{"Last", "/@", "listOfActions"}], ")"}]}], ",", "2"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.731165860601141*^9, 3.731165880905389*^9}, {
   3.731165972922289*^9, 3.731166038200452*^9}, {3.73116609063138*^9, 
   3.731166092624798*^9}, {3.731166126299718*^9, 3.73116614978414*^9}, {
   3.7311661821949883`*^9, 3.7311661857004623`*^9}, {3.7311662229546127`*^9, 
   3.731166277399712*^9}, {3.731166358325531*^9, 3.731166358808284*^9}, 
   3.731847067590686*^9},ExpressionUUID->"1433bdb5-c517-464d-a139-\
59aa1b354497"],

Cell[BoxData[
 RowBox[{
  RowBox[{"this", "=", 
   RowBox[{"t\[Phi]dotpairs", "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"thyme_Integer", ",", "rate_Real"}], "}"}], "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"rate", ",", 
       RowBox[{"(", 
        RowBox[{"t", "<", "thyme"}], ")"}]}], "}"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731166432533461*^9, 3.731166453716076*^9}, {
   3.731166522691455*^9, 3.731166559934615*^9}, {3.73116659668333*^9, 
   3.731166598543702*^9}, {3.731166676937408*^9, 3.7311667987092333`*^9}, {
   3.7311668372165937`*^9, 3.7311668718868837`*^9}, {3.7311670645022306`*^9, 
   3.731167075704624*^9}, {3.7311671311129713`*^9, 3.731167131858691*^9}, 
   3.731847070247054*^9},ExpressionUUID->"1ece358e-64f3-4736-8a5f-\
f83e782dd84f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]dot", "[", "t_", "]"}], ":=", 
   RowBox[{"Piecewise", "/@", 
    RowBox[{"{", "this", "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7311681335798388`*^9, 3.731168142447639*^9}, {
  3.7311682277302713`*^9, 3.731168238688672*^9}, {3.731179484812057*^9, 
  3.731179486672619*^9}, {3.731179841691987*^9, 3.731179842887322*^9}, {
  3.731234579106222*^9, 3.731234586062166*^9}, {3.73123933714892*^9, 
  3.731239340365397*^9}, {3.731239372270361*^9, 3.7312393815180683`*^9}, {
  3.7312394123995447`*^9, 
  3.73123941385433*^9}},ExpressionUUID->"7d874a78-0336-4671-a122-\
e0b916da8763"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timelist", "=", 
   RowBox[{"Range", "[", "lengthOfEpisode", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731667595986527*^9, 3.7316676076963577`*^9}, 
   3.73166990697838*^9},ExpressionUUID->"0e29645f-6f0b-4e8f-9a76-\
707b95c41817"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]solved", "[", 
    RowBox[{"t_", ",", "tlower_", ",", "tupper_"}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"\[Phi]dot", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "tlower", ",", "tupper"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.731179491268333*^9, 3.731179495912167*^9}, {
   3.731179549210397*^9, 3.73117955663127*^9}, {3.731179603831006*^9, 
   3.731179647008624*^9}, {3.731179922959622*^9, 3.731179927659565*^9}, {
   3.7311804932571907`*^9, 3.7311804935915003`*^9}, {3.731180582508214*^9, 
   3.731180584266721*^9}, {3.731180679389636*^9, 3.731180681581311*^9}, {
   3.731180821428081*^9, 3.7311808339698477`*^9}, {3.731181134763216*^9, 
   3.731181134938772*^9}, {3.731234089592911*^9, 3.731234092498021*^9}, {
   3.731234611263281*^9, 3.731234611374366*^9}, {3.7312346735694847`*^9, 
   3.731234680879096*^9}, 3.731234736467456*^9, {3.7312348103408318`*^9, 
   3.7312348105799932`*^9}, {3.7312359050651703`*^9, 3.731235914821301*^9}, {
   3.731235957400228*^9, 3.731235959559423*^9}, {3.7312369139572287`*^9, 
   3.7312369506601048`*^9}, {3.7312370830488443`*^9, 
   3.7312370869843073`*^9}, {3.731237224700718*^9, 3.731237226332409*^9}, {
   3.731237303342245*^9, 3.731237303517447*^9}, 3.7312374044184027`*^9, {
   3.731237508230212*^9, 3.7312375157171593`*^9}, {3.731237547878291*^9, 
   3.731237554742277*^9}, {3.731237886577649*^9, 3.731237907905055*^9}, {
   3.731239005971437*^9, 3.731239026804316*^9}, {3.7316670062879057`*^9, 
   3.731667011481933*^9}, 3.731667096812367*^9, {3.731667129672323*^9, 
   3.731667143863616*^9}},ExpressionUUID->"d6710fae-0a96-4149-80a1-\
033fc4f07071"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]ForAnimation", "=", 
   RowBox[{"ListInterpolation", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]solved", "[", 
        RowBox[{"t", ",", "0", ",", "#"}], "]"}], "&"}], "/@", "timelist"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "lengthOfEpisode"}], "}"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.731667247365819*^9, 3.7316672763250628`*^9}, {
  3.7316673271734743`*^9, 3.731667351140431*^9}, {3.7316675681467953`*^9, 
  3.731667576352302*^9}, {3.731667613633209*^9, 3.731667656110353*^9}, {
  3.7316678254785147`*^9, 3.731667825638311*^9}, {3.731680405470627*^9, 
  3.731680406355886*^9}},ExpressionUUID->"10404981-22b2-4d06-8d6d-\
a48ae635c6d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]plot", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"\[Phi]ForAnimation", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7316670216743803`*^9, 3.7316670484270067`*^9}, {
   3.7316671184110737`*^9, 3.731667118727869*^9}, {3.731667777526396*^9, 
   3.7316678398946877`*^9}, {3.731669816431732*^9, 3.731669819119606*^9}, 
   3.7320391074543457`*^9},ExpressionUUID->"e81441ef-f5e8-4a66-81bd-\
b04c027d3a42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{
    RowBox[{"\"\<PhiPlot_\>\"", "<>", "timeAndDateString"}], ",", 
    "\[Phi]plot"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.732981575077623*^9, 
  3.7329815943358307`*^9}},ExpressionUUID->"0c2a5788-f6c4-43a7-a2ef-\
390f14bbd192"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\<phiplot\>\"", "<>", "timeAndDateString", "<>", "\"\<.pdf\>\""}], 
     ",", "\[Phi]plot"}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7320391102674627`*^9, 3.732039126171934*^9}, {
  3.732040535394088*^9, 
  3.7320405473908167`*^9}},ExpressionUUID->"a541ebe4-eca3-408e-a81e-\
3a3f6acb242c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"phidotplot", "=", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Piecewise", "/@", 
       RowBox[{"{", "this", "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "lengthOfEpisode"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7311671273374043`*^9, 3.731167134529758*^9}, {
  3.731167839113751*^9, 3.731167872165595*^9}, {3.73116794274573*^9, 
  3.7311679783931847`*^9}, {3.731684380632803*^9, 3.731684383102346*^9}, {
  3.732039166922161*^9, 
  3.7320391746391706`*^9}},ExpressionUUID->"3a4690f3-bed6-47a6-87db-\
3592705ddefd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\<phidotplot\>\"", "<>", "timeAndDateString", "<>", "\"\<.pdf\>\""}], 
     ",", "phidotplot"}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.732039177643392*^9, 3.732039201596756*^9}, {
  3.732040552867876*^9, 
  3.732040557665039*^9}},ExpressionUUID->"1e9bce98-eee6-42ab-839e-\
009df34bc59e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"policy", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"listOfActionPlots", ",", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.730567655470455*^9, 3.7305676568283167`*^9}, {
   3.732038913935688*^9, 3.732038916241417*^9}, 
   3.732039209556355*^9},ExpressionUUID->"5a199c7a-3e34-4bb0-ae22-\
7e525f1af707"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\<policy\>\"", "<>", "timeAndDateString", "<>", "\"\<.pdf\>\""}], ",",
      "policy"}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7320389013865643`*^9, 3.7320389768194017`*^9}, 
   3.7320392122997704`*^9, {3.732040562137924*^9, 
   3.732040571820416*^9}},ExpressionUUID->"e75d2385-f519-4174-8385-\
2bd03063a5ff"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"movieFrameQ", "[", 
     RowBox[{"time_", ",", "step_"}], "]"}], ":=", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "body", ",", "head", ",", "tail", ",", "tailPivotLine1", ",", 
            "tailPivotDot", ",", "tailPivotLine2", ",", "headPivotDot", ",", 
            "headPivotLine1", ",", "headPivotLine2"}], "}"}], "/.", 
          "robotParameters"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"\[Phi]ForAnimation", "[", "t", "]"}]}], "}"}]}], "/.", 
        RowBox[{"listOfSol", "[", 
         RowBox[{"[", "step", "]"}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"t", "\[Rule]", "time"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"PlotRange", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"10", " ", "b"}], " ", "+", " ", "gap"}], ")"}]}], " ",
             ",", " ", 
            RowBox[{
             RowBox[{"10", " ", "b"}], " ", "+", " ", "gap"}]}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"10", " ", "b"}], " ", "+", " ", "gap"}], " ", ")"}]}],
             " ", ",", " ", 
            RowBox[{
             RowBox[{"10", " ", "b"}], " ", "+", " ", "gap"}]}], " ", "}"}]}],
          "}"}]}], " ", "/.", " ", "robotParameters"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.719150903160173*^9, 3.7191510131601048`*^9}, {
   3.7191828271371727`*^9, 3.719182827781157*^9}, {3.719183963400749*^9, 
   3.719183993546331*^9}, {3.719324952013503*^9, 3.719324953253909*^9}, {
   3.72108949828334*^9, 3.7210895159116087`*^9}, {3.7210900247740297`*^9, 
   3.721090035016567*^9}, {3.722178813414523*^9, 3.7221788154923887`*^9}, {
   3.730549219840171*^9, 3.730549241134365*^9}, {3.730549478771351*^9, 
   3.730549487251011*^9}, {3.73054953467667*^9, 3.73054953480186*^9}, {
   3.7305498763816233`*^9, 3.730549911918644*^9}, {3.7305518750632677`*^9, 
   3.7305518801678743`*^9}, {3.730736253870204*^9, 3.730736278090927*^9}, {
   3.730736836866116*^9, 3.730736851356995*^9}, {3.730736913423464*^9, 
   3.730736918559566*^9}, {3.731109406217017*^9, 3.731109411583145*^9}, {
   3.731109535730575*^9, 3.731109542026417*^9}, {3.731152263732087*^9, 
   3.731152265164813*^9}, {3.731179656836619*^9, 3.731179688312112*^9}, 
   3.731179987012821*^9, 3.731237824447854*^9, {3.731238157709817*^9, 
   3.7312381856583967`*^9}, 3.731238313311742*^9, {3.731238464067048*^9, 
   3.731238464580855*^9}, {3.7312387264435062`*^9, 3.73123872666264*^9}, {
   3.731667667600869*^9, 3.731667671125161*^9}, {3.731667729743319*^9, 
   3.731667729919201*^9}, {3.731682970449203*^9, 3.731682988416163*^9}, {
   3.7316830688362427`*^9, 
   3.731683084034981*^9}},ExpressionUUID->"fa97aa46-7754-4513-b019-\
e941d0f50581"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"numberOfFrames", " ", "=", " ", "20"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.719151019680471*^9, 3.719151025397862*^9}, 
   3.719151056118771*^9, {3.730740634224472*^9, 3.730740635065836*^9}, {
   3.731668788692629*^9, 3.7316687891711073`*^9}, {3.7316690573705893`*^9, 
   3.731669061639756*^9}, {3.731669135611772*^9, 3.731669135740073*^9}, {
   3.7316694979430237`*^9, 
   3.7316695002615023`*^9}},ExpressionUUID->"6e61ee5e-ad93-4023-b50e-\
8d39a990df7d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"movieFrames", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"movieFrameQ", "[", 
          RowBox[{"k", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"j", "-", "1"}], ",", "j", ",", 
           FractionBox["\[Delta]t", "numberOfFrames"]}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "lengthOfEpisode"}], "}"}]}], "]"}], "//",
      "Flatten"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.730738074299828*^9, 3.730738161749543*^9}, 
   3.7307382199612703`*^9, {3.730738302845745*^9, 3.730738308157305*^9}, {
   3.73073837137684*^9, 3.7307383779521523`*^9}, {3.731668263348434*^9, 
   3.731668264761877*^9}},ExpressionUUID->"86f21a35-1e0a-4511-a417-\
52db5d38a292"],

Cell["\<\
The graphics issues thrown, I think, are a product of the objects pointing to \
states x[t], y[t], \[Theta][t], etc., and \[Phi][t] are different. All states \
except \[Phi][t] are InterpolatingFunctions while \[Phi][t] is not.\
\>", "Text",
 CellChangeTimes->{{3.731239489825165*^9, 
  3.731239574577621*^9}},ExpressionUUID->"c2693d8a-9512-4bbc-bb24-\
6c55474bffe2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListAnimate", "[", "movieFrames", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.73073827209517*^9, 3.7307382781708097`*^9}, {
   3.730738464946306*^9, 3.730738465376524*^9}, {3.7307385213628263`*^9, 
   3.7307385220341988`*^9}, {3.7307385589156446`*^9, 3.730738582005795*^9}, 
   3.731066347168201*^9, {3.731180019847237*^9, 3.7311800217448807`*^9}, {
   3.731238532277028*^9, 3.731238535562408*^9}, 3.731668281077368*^9, 
   3.7317755644156933`*^9, 3.7318414986948957`*^9, 3.7318839656881847`*^9, 
   3.731948823305274*^9, 3.732039426026217*^9, 
   3.73298010104394*^9},ExpressionUUID->"780ef001-10a4-4f43-8747-\
eef06a44a847"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\<threelink_vary_k_headspeed_\>\"", "<>", "timeAndDateString", "<>", 
      "\"\<.avi\>\""}], ",", "movieFrames", ",", 
     RowBox[{"\"\<FrameRate\>\"", "\[Rule]", " ", "20"}]}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.731668128976362*^9, 3.731668182065098*^9}, {
   3.731668252055153*^9, 3.7316682523071833`*^9}, {3.731669394263279*^9, 
   3.731669394388237*^9}, {3.7316695178655977`*^9, 3.731669518887076*^9}, {
   3.731670267710436*^9, 3.7316702678688307`*^9}, 3.7316802226169367`*^9, {
   3.731683152150741*^9, 3.7316831662760973`*^9}, 3.731684792395947*^9, {
   3.7318464646954317`*^9, 3.731846470068903*^9}, 3.731846580864564*^9, {
   3.731869464652309*^9, 3.731869466263884*^9}, {3.731869511371046*^9, 
   3.7318695118989162`*^9}, 3.731883969646282*^9, {3.731948917121662*^9, 
   3.731948920640218*^9}, {3.731949008659952*^9, 3.731949040626864*^9}, {
   3.731949103905164*^9, 3.731949104509193*^9}, {3.7319491743720827`*^9, 
   3.731949174417349*^9}, 3.7320394298584127`*^9, {3.732040578928948*^9, 
   3.732040583289022*^9}},ExpressionUUID->"af50645d-a7e1-4b8e-b5de-\
0645d8453ffb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\<Qmatrix_\>\"", "<>", "timeAndDateString", "<>", "\"\<.dat\>\""}], 
     ",", "Qfinal"}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.732041672930606*^9, 3.732041704904112*^9}, 
   3.732978850229527*^9},ExpressionUUID->"f754bff1-5ec3-4c47-88a4-\
3d38c9420eac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{
    RowBox[{"\"\<Qmatrix_\>\"", "<>", "timeAndDateString"}], ",", "Qfinal"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.732981437561205*^9, 
  3.732981450200952*^9}},ExpressionUUID->"cf0676cf-5783-4708-986a-\
a55dc43bbd23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", "\"\<Made it to the end!\>\"", "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.732980107817503*^9, 
  3.7329801160801764`*^9}},ExpressionUUID->"8acad68f-d6ac-4dec-af0f-\
12c47d98b826"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1036},
WindowMargins->{{Automatic, 1280}, {-53, Automatic}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 277, 5, 102, "Title", "ExpressionUUID" -> \
"65565126-008d-42b3-95e0-47e7fd88f586"],
Cell[860, 29, 361, 7, 30, "Text", "ExpressionUUID" -> \
"c635dca0-4fec-47d3-968b-e6fec8e21b4b"],
Cell[1224, 38, 1810, 29, 32, "Input", "ExpressionUUID" -> \
"b27fd90a-6ec7-44d1-84f8-7d506d1cf733"],
Cell[3037, 69, 301, 9, 32, "Input", "ExpressionUUID" -> \
"2862318c-6057-47d9-8039-da32bc97d0cf"],
Cell[3341, 80, 1253, 37, 32, "Input", "ExpressionUUID" -> \
"46d18575-d182-41d3-a3c1-516af4cfbe28"],
Cell[4597, 119, 1582, 42, 32, "Input", "ExpressionUUID" -> \
"92b744bf-a269-43c1-a70b-6538b31d3beb"],
Cell[6182, 163, 852, 22, 32, "Input", "ExpressionUUID" -> \
"566c9fd2-4cd6-44e4-a489-38919ccfbed2"],
Cell[7037, 187, 780, 21, 32, "Input", "ExpressionUUID" -> \
"09c0f92e-0376-48f7-9890-08e25d5c9ff0"],
Cell[7820, 210, 900, 23, 32, "Input", "ExpressionUUID" -> \
"37f31493-655f-48cb-8f53-892df808608c"],
Cell[8723, 235, 362, 10, 32, "Input", "ExpressionUUID" -> \
"8f753220-eb58-4562-b2b3-4dfc563af66e"],
Cell[9088, 247, 363, 10, 32, "Input", "ExpressionUUID" -> \
"883e4078-c22a-48b4-ae86-cec05f093d6a"],
Cell[9454, 259, 374, 10, 32, "Input", "ExpressionUUID" -> \
"02016ab8-c2bb-41eb-8464-d15d675a9431"],
Cell[9831, 271, 781, 21, 32, "Input", "ExpressionUUID" -> \
"41f1ee41-0171-440b-b6bf-6680a77a678a"],
Cell[10615, 294, 961, 25, 32, "Input", "ExpressionUUID" -> \
"780b9a18-9a76-4f87-9f8d-08f285165221"],
Cell[11579, 321, 377, 10, 32, "Input", "ExpressionUUID" -> \
"93d59990-ab71-486e-ae4e-13ca5ada0cbe"],
Cell[11959, 333, 374, 10, 32, "Input", "ExpressionUUID" -> \
"09862e3a-eae4-4819-83b5-5c0112133e4d"],
Cell[12336, 345, 374, 10, 32, "Input", "ExpressionUUID" -> \
"3a4521fd-5de3-4117-8490-52d5fec5bfdd"],
Cell[12713, 357, 1002, 25, 32, "Input", "ExpressionUUID" -> \
"91abe85d-d62e-41da-b903-b14c4b89ab5e"],
Cell[13718, 384, 845, 21, 32, "Input", "ExpressionUUID" -> \
"24d5f724-cfb5-43fc-99d4-72110fbca83d"],
Cell[14566, 407, 3290, 83, 74, "Input", "ExpressionUUID" -> \
"6c0f1ab0-7ec3-4b19-a20a-f338dd8e6a69"],
Cell[CellGroupData[{
Cell[17881, 494, 300, 5, 75, "Chapter", "ExpressionUUID" -> \
"e2e4728e-4f72-4245-8bec-094aedb98f70"],
Cell[18184, 501, 490, 12, 32, "Input", "ExpressionUUID" -> \
"e6b3d87a-978e-441c-899b-fa046a244f5b"],
Cell[18677, 515, 431, 12, 32, "Input", "ExpressionUUID" -> \
"fac027ed-81a0-4e2d-ad4a-d61cc65046c6"],
Cell[19111, 529, 532, 16, 32, "Input", "ExpressionUUID" -> \
"d444d6f7-1678-479f-be4d-eaa4a0c09dda"],
Cell[19646, 547, 661, 18, 32, "Input", "ExpressionUUID" -> \
"0a217947-00a4-4a33-aa7d-b114cdd6e2e8"],
Cell[20310, 567, 1174, 33, 54, "Input", "ExpressionUUID" -> \
"0b8d6315-f4f1-4eee-a43d-79a1b2204a18"],
Cell[21487, 602, 1219, 35, 54, "Input", "ExpressionUUID" -> \
"59d46548-367b-4c49-b453-a690d97bdd89"],
Cell[22709, 639, 784, 22, 47, "Input", "ExpressionUUID" -> \
"18f08e75-8431-45b4-bc07-e73432a9a013"],
Cell[23496, 663, 403, 9, 32, "Input", "ExpressionUUID" -> \
"73bac04c-eb9c-459f-a786-28adced20b85"],
Cell[23902, 674, 357, 8, 32, "Input", "ExpressionUUID" -> \
"1a5043d0-16aa-4eef-954d-078e90f1385e"],
Cell[24262, 684, 350, 8, 32, "Input", "ExpressionUUID" -> \
"1a807eff-4d1d-4c63-9ebb-94a8f9f80fca"],
Cell[24615, 694, 866, 25, 49, "Input", "ExpressionUUID" -> \
"02314625-7866-450c-9965-b211d1bc6c51"],
Cell[25484, 721, 888, 27, 49, "Input", "ExpressionUUID" -> \
"fbe9ac21-758c-4065-acd7-3792b0a6ff9c"],
Cell[26375, 750, 1126, 30, 49, "Input", "ExpressionUUID" -> \
"bdf6a44c-de9d-4e80-b3e5-ba7eecf35672"],
Cell[27504, 782, 500, 11, 49, "Input", "ExpressionUUID" -> \
"c969b569-6134-4e9f-88d9-2e36e728cdfd"],
Cell[28007, 795, 237, 4, 30, "Text", "ExpressionUUID" -> \
"124c559b-8833-4121-b5f9-9fed8750067c"],
Cell[28247, 801, 438, 9, 32, "Input", "ExpressionUUID" -> \
"24fd083e-5723-4dee-adfa-b23d055710c7"],
Cell[28688, 812, 1876, 54, 32, "Input", "ExpressionUUID" -> \
"61bef6db-1ec2-4325-a767-c0524b136dd9"],
Cell[CellGroupData[{
Cell[30589, 870, 222, 5, 32, "Input", "ExpressionUUID" -> \
"1ea36baf-fe01-40c9-a0a9-755a52820d69"],
Cell[30814, 877, 8477, 120, 32, "Output", "ExpressionUUID" -> \
"be61e62b-67d1-490a-8cd5-40716a08ba99"]
}, Open  ]],
Cell[39306, 1000, 1756, 36, 61, "Text", "ExpressionUUID" -> \
"aff4e4ac-b9ec-4edd-9b14-e917bbd94080"],
Cell[41065, 1038, 315, 8, 32, "Input", "ExpressionUUID" -> \
"0aa1c19c-399f-426f-b1f4-8c55a17613e9"],
Cell[41383, 1048, 473, 12, 32, "Input", "ExpressionUUID" -> \
"4b151e68-d1d0-4189-93d7-3c811fbeda22"],
Cell[41859, 1062, 243, 6, 32, "Input", "ExpressionUUID" -> \
"12abcf83-df65-4618-80f0-b89f6435aa21"],
Cell[42105, 1070, 485, 12, 32, "Input", "ExpressionUUID" -> \
"30cc19d1-b5a4-4f98-bb4d-0099ad0e40f4"],
Cell[42593, 1084, 779, 13, 49, "Text", "ExpressionUUID" -> \
"18d02539-8340-41e5-bcc7-0eb4ee35038b"],
Cell[43375, 1099, 1162, 26, 32, "Input", "ExpressionUUID" -> \
"0e71f37e-16fe-41c1-a013-d46899d1aac8"],
Cell[44540, 1127, 886, 23, 32, "Input", "ExpressionUUID" -> \
"84374aa6-2e58-45a0-b27b-a96c6f2d34b8"],
Cell[45429, 1152, 788, 21, 32, "Input", "ExpressionUUID" -> \
"559a094e-5986-4caa-be85-c088dc686a7f"],
Cell[46220, 1175, 919, 24, 32, "Input", "ExpressionUUID" -> \
"4715d06b-1126-40f0-a6fa-a957c8136748"],
Cell[47142, 1201, 379, 9, 32, "Input", "ExpressionUUID" -> \
"ed01e1d6-d9cf-40c7-a528-31916385aa9c"],
Cell[47524, 1212, 208, 5, 32, "Input", "ExpressionUUID" -> \
"fda21af6-be5b-4d8a-a97a-3054df212f5d"],
Cell[47735, 1219, 397, 8, 32, "Input", "ExpressionUUID" -> \
"b7306465-d76c-4206-9d3c-04bd3fd81435"],
Cell[48135, 1229, 195, 5, 32, "Input", "ExpressionUUID" -> \
"33499477-8421-4ef5-a4d2-c8270f6085ee"],
Cell[48333, 1236, 5333, 86, 75, "Input", "ExpressionUUID" -> \
"1113d5e6-2822-43ed-971e-a44f43f5e6cf"],
Cell[53669, 1324, 239, 6, 30, "Text", "ExpressionUUID" -> \
"d5d4d92d-186d-49aa-8bdd-332d8e107b61"],
Cell[53911, 1332, 265, 6, 32, "Input", "ExpressionUUID" -> \
"97208c8c-c7b5-481d-91a9-c8cc69afba3d"],
Cell[54179, 1340, 300, 7, 53, "Input", "ExpressionUUID" -> \
"3a1f052e-10e5-416b-9aa7-f2757053d9ea"],
Cell[54482, 1349, 2690, 72, 54, "Input", "ExpressionUUID" -> \
"68ac759e-eaae-4efd-b911-34b462285ce2"],
Cell[57175, 1423, 1053, 26, 32, "Input", "ExpressionUUID" -> \
"1096e535-7692-4d59-b23d-634a2120a171"],
Cell[58231, 1451, 1928, 49, 54, "Input", "ExpressionUUID" -> \
"e55df6c5-7fba-4ab1-9ab4-22d168e52ff4"],
Cell[60162, 1502, 241, 5, 32, "Input", "ExpressionUUID" -> \
"9d694007-5df5-41b4-b7ed-9a788175bd4a"],
Cell[60406, 1509, 493, 13, 51, "Input", "ExpressionUUID" -> \
"8343363a-19cd-4526-9c9a-ffad1b878595"],
Cell[60902, 1524, 555, 10, 32, "Input", "ExpressionUUID" -> \
"99e65dee-09d1-42ae-a197-5dd10e77709f"],
Cell[61460, 1536, 883, 28, 32, "Input", "ExpressionUUID" -> \
"70d2a9f9-6ce0-4834-aabb-ca5b73ffaa12"],
Cell[62346, 1566, 733, 20, 34, "Text", "ExpressionUUID" -> \
"328111cb-647d-4447-9ed8-238be138d600"],
Cell[63082, 1588, 491, 14, 51, "Input", "ExpressionUUID" -> \
"c57a62c8-8176-455b-b61f-04365accc311"],
Cell[63576, 1604, 489, 14, 51, "Input", "ExpressionUUID" -> \
"9af9ceb4-9e54-4bf2-805a-0240de1e0801"],
Cell[64068, 1620, 535, 15, 51, "Input", "ExpressionUUID" -> \
"4d026c02-d50e-4d6b-95e8-697a7ae22515"],
Cell[64606, 1637, 537, 9, 30, "Text", "ExpressionUUID" -> \
"0fa791a5-e9e7-4270-8382-923b0c8fac2b"],
Cell[65146, 1648, 1197, 34, 32, "Input", "ExpressionUUID" -> \
"02ffd6c7-65c5-423c-a500-dceff1484e41"],
Cell[66346, 1684, 4371, 99, 136, "Input", "ExpressionUUID" -> \
"af3d02a9-0bce-4449-b317-36067a771fb1"],
Cell[70720, 1785, 448, 10, 32, "Input", "ExpressionUUID" -> \
"d3407dc6-d107-4ede-a8fd-bfb8052ff7b2"],
Cell[71171, 1797, 927, 26, 32, "Input", "ExpressionUUID" -> \
"e93db3ab-adf1-43c4-90bc-62ad70deffe3"],
Cell[72101, 1825, 309, 8, 32, "Input", "ExpressionUUID" -> \
"280ac593-f02a-4729-a891-1355cbe86492"],
Cell[72413, 1835, 229, 6, 30, "Text", "ExpressionUUID" -> \
"0f68e893-fd49-498d-9926-d075e32839d1"],
Cell[72645, 1843, 512, 14, 32, "Input", "ExpressionUUID" -> \
"43a25b65-d840-44c7-85a0-1c6f03c8781b"],
Cell[73160, 1859, 1045, 31, 32, "Input", "ExpressionUUID" -> \
"88e92be5-0560-438d-a4f3-477b6036063d"],
Cell[74208, 1892, 421, 12, 32, "Text", "ExpressionUUID" -> \
"acd089b2-302d-4193-87e2-2836aade64ec"],
Cell[74632, 1906, 905, 25, 32, "Input", "ExpressionUUID" -> \
"0597299c-0fb5-4767-be83-ffc51053aa5b"],
Cell[75540, 1933, 535, 13, 32, "Input", "ExpressionUUID" -> \
"18571f3f-ec42-4131-acf5-862f38dac258"],
Cell[76078, 1948, 357, 8, 30, "Text", "ExpressionUUID" -> \
"8a10895a-7f94-497d-9d4d-a92cd2df3390"],
Cell[76438, 1958, 373, 10, 32, "Input", "ExpressionUUID" -> \
"b9cbbd65-d87b-4fc7-9597-af1bfa551b7c"],
Cell[76814, 1970, 486, 9, 30, "Text", "ExpressionUUID" -> \
"2d0397b1-edfe-46af-a495-657e79a5db2e"],
Cell[77303, 1981, 900, 25, 32, "Input", "ExpressionUUID" -> \
"f8959aec-d331-4ce3-b244-3da80a5fecd5"],
Cell[78206, 2008, 484, 16, 32, "Input", "ExpressionUUID" -> \
"edc73b95-78af-47a0-8b30-59d8ee5be45b"],
Cell[78693, 2026, 653, 19, 32, "Input", "ExpressionUUID" -> \
"4529efd2-6985-49f7-ae0e-d35d00c2a6d8"],
Cell[79349, 2047, 553, 18, 32, "Input", "ExpressionUUID" -> \
"b805d9c0-8b7a-4236-891a-c55cea173696"],
Cell[79905, 2067, 556, 18, 32, "Input", "ExpressionUUID" -> \
"db34c793-062a-4986-9119-97f7f3bbe6c8"],
Cell[80464, 2087, 560, 18, 32, "Input", "ExpressionUUID" -> \
"bb172712-d63b-44e3-b611-a8c3906fe66e"],
Cell[81027, 2107, 612, 19, 32, "Input", "ExpressionUUID" -> \
"888a4d87-d3c0-4f07-844c-3aaf02e73544"],
Cell[81642, 2128, 819, 25, 32, "Input", "ExpressionUUID" -> \
"1616e9a2-0e42-4e13-99fb-7753a531c10e"],
Cell[82464, 2155, 300, 8, 32, "Input", "ExpressionUUID" -> \
"fbc19dac-7a96-494a-a127-046602b08eba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82801, 2168, 271, 5, 75, "Chapter", "ExpressionUUID" -> \
"deb91032-9e2d-4eba-be88-362bf62c51d1"],
Cell[83075, 2175, 593, 10, 30, "Text", "ExpressionUUID" -> \
"51df041e-571b-489a-8d73-59f8880dba77"],
Cell[83671, 2187, 478, 11, 49, "Input", "ExpressionUUID" -> \
"74edc770-86b0-4e87-8ac1-d7fc18379790"],
Cell[84152, 2200, 270, 7, 32, "Input", "ExpressionUUID" -> \
"421de4de-a778-4fb2-b855-a19924976355"],
Cell[84425, 2209, 1235, 27, 32, "Input", "ExpressionUUID" -> \
"a4e9e255-4bfe-4627-b819-09d89d9a5be6"],
Cell[85663, 2238, 963, 24, 32, "Input", "ExpressionUUID" -> \
"31a8b02e-9e60-4300-8b23-556da91f82cb"],
Cell[86629, 2264, 865, 22, 32, "Input", "ExpressionUUID" -> \
"8542604b-50c7-49b9-b305-221c1075bac6"],
Cell[87497, 2288, 994, 25, 32, "Input", "ExpressionUUID" -> \
"da99d68e-8e67-41e0-857f-b62c4baabd3c"],
Cell[88494, 2315, 613, 19, 32, "Input", "ExpressionUUID" -> \
"91bca2d2-6e86-4d4b-adb6-b7ddd08f1117"],
Cell[89110, 2336, 809, 16, 32, "Input", "ExpressionUUID" -> \
"aed19fc1-9e41-4b51-9400-3bb0d0bb0110"],
Cell[89922, 2354, 1034, 20, 274, "Text", "ExpressionUUID" -> \
"61e8cdf8-9e14-43b2-9173-d0dc35933a0c"],
Cell[90959, 2376, 906, 13, 30, "Text", "ExpressionUUID" -> \
"b19888ea-dc42-41c6-9341-422e4da2c3dd"],
Cell[91868, 2391, 204, 5, 32, "Input", "ExpressionUUID" -> \
"961106cc-c608-4e5e-b008-3c8ca2993abb"],
Cell[92075, 2398, 301, 6, 32, "Input", "ExpressionUUID" -> \
"f83bb67a-409f-4870-974b-ae9a608fcfc4"],
Cell[92379, 2406, 130, 2, 32, "Input", "ExpressionUUID" -> \
"d0e49bf1-98c3-44c3-bd1b-f4ac3bd19561"],
Cell[92512, 2410, 296, 6, 32, "Input", "ExpressionUUID" -> \
"c083763b-de5b-4a1b-b87c-840d6336e48f"],
Cell[92811, 2418, 410, 9, 32, "Input", "ExpressionUUID" -> \
"f10937c8-ae7c-4c28-a50f-c47ddbbfd95b"],
Cell[93224, 2429, 2451, 62, 54, "Input", "ExpressionUUID" -> \
"113c6429-ef33-4b94-862d-16b91c9f75d3"],
Cell[95678, 2493, 932, 25, 32, "Input", "ExpressionUUID" -> \
"684299d7-1856-4054-beeb-bfb0a11c3558"],
Cell[96613, 2520, 372, 7, 30, "Text", "ExpressionUUID" -> \
"b486a386-e19f-4244-b44c-d59bb2ec0f2b"],
Cell[96988, 2529, 1209, 35, 32, "Input", "ExpressionUUID" -> \
"8f52c5cf-e2cf-4837-b768-934a4ae40088"],
Cell[98200, 2566, 1526, 34, 35, "Input", "ExpressionUUID" -> \
"124ee6c3-3d83-42f6-8d4e-0fc9b8bcb4fa"],
Cell[99729, 2602, 3350, 72, 58, "Input", "ExpressionUUID" -> \
"850d7ab6-7d19-4cb9-9ac5-3222fc41b0fb"],
Cell[103082, 2676, 1199, 33, 32, "Input", "ExpressionUUID" -> \
"e873c949-4832-489b-9e73-21e3e8137842"],
Cell[104284, 2711, 411, 11, 32, "Input", "ExpressionUUID" -> \
"82b07ed4-248e-4516-917b-73b456dca9c8"],
Cell[104698, 2724, 5027, 106, 54, "Input", "ExpressionUUID" -> \
"99100ed1-089e-4d81-b821-40b6bc6c55db"],
Cell[109728, 2832, 2847, 77, 75, "Input", "ExpressionUUID" -> \
"e542a312-ce03-458a-8c3d-2f1b7ffc622a"],
Cell[112578, 2911, 996, 16, 32, "Input", "ExpressionUUID" -> \
"d015cf0d-eb22-4847-906f-f1fe1f4145dd"],
Cell[113577, 2929, 652, 11, 32, "Input", "ExpressionUUID" -> \
"988c1a63-2fdd-4ea5-a2e8-024d1c19b795"],
Cell[114232, 2942, 387, 8, 51, "Input", "ExpressionUUID" -> \
"2a7594d6-1598-4cfd-92a3-c3fa5bb051ee"],
Cell[114622, 2952, 1342, 35, 32, "Input", "ExpressionUUID" -> \
"db5bb125-87b7-4556-a344-ffdaa4fa4976"],
Cell[115967, 2989, 2630, 72, 54, "Input", "ExpressionUUID" -> \
"d13cfe11-f6b9-49dd-9009-692c196443a8"],
Cell[118600, 3063, 1346, 37, 32, "Input", "ExpressionUUID" -> \
"febe7fe7-f6dd-4487-a947-14a1a40503a6"],
Cell[119949, 3102, 241, 6, 32, "Input", "ExpressionUUID" -> \
"4d9fd8b7-59f0-4b73-88a9-eba41c5727b2"],
Cell[120193, 3110, 516, 12, 32, "Input", "ExpressionUUID" -> \
"11493537-9f45-4576-832d-f71ec78c71fa"],
Cell[120712, 3124, 235, 6, 32, "Input", "ExpressionUUID" -> \
"06cb1722-d373-41a2-8500-77796309252c"],
Cell[120950, 3132, 865, 18, 32, "Input", "ExpressionUUID" -> \
"9252ee7d-77ad-437b-bd9c-8adcf5b1142a"],
Cell[121818, 3152, 23027, 449, 931, "Input", "ExpressionUUID" -> \
"a77627b3-dc99-4ccd-a6b4-74a85a839b2e"],
Cell[CellGroupData[{
Cell[144870, 3605, 262, 6, 32, "Input", "ExpressionUUID" -> \
"6a94f4d2-6744-48e7-b6c8-6420e4fb9487"],
Cell[145135, 3613, 389, 6, 32, "Output", "ExpressionUUID" -> \
"31a02095-7df0-4a5c-9519-6c5b1955120e"]
}, Open  ]],
Cell[145539, 3622, 212, 5, 32, "Input", "ExpressionUUID" -> \
"2406a46b-6e2a-4559-8fe9-9292650fbd48"],
Cell[CellGroupData[{
Cell[145776, 3631, 231, 5, 32, "Input", "ExpressionUUID" -> \
"a94d5d13-2178-4a6e-8cad-eec5ec422eed"],
Cell[146010, 3638, 374, 6, 32, "Output", "ExpressionUUID" -> \
"f7a1b7b7-e1b8-43cb-aa51-4edad9e08769"]
}, Open  ]],
Cell[146399, 3647, 295, 6, 32, "Input", "ExpressionUUID" -> \
"8e4727ea-5bb3-412e-afe2-311f476db0e7"],
Cell[CellGroupData[{
Cell[146719, 3657, 279, 4, 63, "Subchapter", "ExpressionUUID" -> \
"6253d8fc-475f-493c-bae4-998f92580913"],
Cell[147001, 3663, 20864, 468, 831, "Input", "ExpressionUUID" -> \
"45725f42-39f2-4357-b579-b8e1199cc200"],
Cell[167868, 4133, 307, 8, 32, "Input", "ExpressionUUID" -> \
"5f2bf221-d293-49c8-a2c2-c63cf280e3d6"],
Cell[168178, 4143, 303, 8, 32, "Input", "ExpressionUUID" -> \
"c7dbdadb-d6f4-4352-a552-f3a8fd6fceb0"],
Cell[168484, 4153, 240, 6, 32, "Input", "ExpressionUUID" -> \
"e48e6591-bc2b-450e-96ff-870c69d18d9c"],
Cell[168727, 4161, 321, 7, 32, "Input", "ExpressionUUID" -> \
"212490a3-192d-4840-8681-6c553ff706dc"],
Cell[169051, 4170, 544, 13, 32, "Input", "ExpressionUUID" -> \
"0faaad17-dc8d-4f03-8775-5794d0529b89"],
Cell[169598, 4185, 413, 12, 32, "Input", "ExpressionUUID" -> \
"0073d0e0-60ed-4366-8a76-803571d95a4a"],
Cell[170014, 4199, 276, 7, 32, "Input", "ExpressionUUID" -> \
"05877f96-d73d-404e-a8ed-dd54f9096b7c"],
Cell[170293, 4208, 373, 8, 32, "Input", "ExpressionUUID" -> \
"6400a6f3-c5b9-4095-b801-24f86cf05346"],
Cell[170669, 4218, 243, 6, 32, "Input", "ExpressionUUID" -> \
"6bba8d71-d079-4e42-9ab3-e01ead95b361"],
Cell[170915, 4226, 864, 21, 32, "Input", "ExpressionUUID" -> \
"1433bdb5-c517-464d-a139-59aa1b354497"],
Cell[171782, 4249, 785, 17, 32, "Input", "ExpressionUUID" -> \
"1ece358e-64f3-4736-8a5f-f83e782dd84f"],
Cell[172570, 4268, 636, 13, 32, "Input", "ExpressionUUID" -> \
"7d874a78-0336-4671-a122-e0b916da8763"],
Cell[173209, 4283, 271, 6, 32, "Input", "ExpressionUUID" -> \
"0e29645f-6f0b-4e8f-9a76-707b95c41817"],
Cell[173483, 4291, 1726, 30, 32, "Input", "ExpressionUUID" -> \
"d6710fae-0a96-4149-80a1-033fc4f07071"],
Cell[175212, 4323, 770, 19, 32, "Input", "ExpressionUUID" -> \
"10404981-22b2-4d06-8d6d-a48ae635c6d0"],
Cell[175985, 4344, 602, 13, 32, "Input", "ExpressionUUID" -> \
"e81441ef-f5e8-4a66-81bd-b04c027d3a42"],
Cell[176590, 4359, 298, 8, 32, "Input", "ExpressionUUID" -> \
"0c2a5788-f6c4-43a7-a2ef-390f14bbd192"],
Cell[176891, 4369, 407, 11, 32, "Input", "ExpressionUUID" -> \
"a541ebe4-eca3-408e-a81e-3a3f6acb242c"],
Cell[177301, 4382, 767, 20, 32, "Input", "ExpressionUUID" -> \
"3a4690f3-bed6-47a6-87db-3592705ddefd"],
Cell[178071, 4404, 406, 11, 32, "Input", "ExpressionUUID" -> \
"1e9bce98-eee6-42ab-839e-009df34bc59e"],
Cell[178480, 4417, 425, 11, 32, "Input", "ExpressionUUID" -> \
"5a199c7a-3e34-4bb0-ae22-7e525f1af707"],
Cell[178908, 4430, 428, 11, 32, "Input", "ExpressionUUID" -> \
"e75d2385-f519-4174-8385-2bd03063a5ff"],
Cell[179339, 4443, 3187, 71, 54, "Input", "ExpressionUUID" -> \
"fa97aa46-7754-4513-b019-e941d0f50581"],
Cell[182529, 4516, 520, 10, 32, "Input", "ExpressionUUID" -> \
"6e61ee5e-ad93-4023-b50e-8d39a990df7d"],
Cell[183052, 4528, 896, 23, 37, "Input", "ExpressionUUID" -> \
"86f21a35-1e0a-4511-a417-52db5d38a292"],
Cell[183951, 4553, 377, 7, 30, "Text", "ExpressionUUID" -> \
"c2693d8a-9512-4bbc-bb24-6c55474bffe2"],
Cell[184331, 4562, 670, 11, 32, "Input", "ExpressionUUID" -> \
"780ef001-10a4-4f43-8747-eef06a44a847"],
Cell[185004, 4575, 1210, 22, 32, "Input", "ExpressionUUID" -> \
"af50645d-a7e1-4b8e-b5de-0645d8453ffb"],
Cell[186217, 4599, 374, 10, 32, "Input", "ExpressionUUID" -> \
"f754bff1-5ec3-4c47-88a4-3d38c9420eac"],
Cell[186594, 4611, 291, 8, 32, "Input", "ExpressionUUID" -> \
"cf0676cf-5783-4708-986a-a55dc43bbd23"],
Cell[186888, 4621, 232, 6, 32, "Input", "ExpressionUUID" -> \
"8acad68f-d6ac-4dec-af0f-12c47d98b826"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

