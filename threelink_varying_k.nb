(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    234896,       5517]
NotebookOptionsPosition[    216355,       5132]
NotebookOutlinePosition[    216715,       5148]
CellTagsIndexPosition[    216672,       5145]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Three-link Swimmer with Varying Stiffness and Amplitude", "Title",
 CellFrame->{{0, 0}, {2, 0}},
 CellChangeTimes->{{3.728147852297571*^9, 3.728147872824718*^9}, {
  3.728147993566083*^9, 
  3.728148013995943*^9}},ExpressionUUID->"972c159b-1ef8-4038-a76c-\
eb12eb2d9afa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\</Users/blake/threelinkQ\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.732041955857958*^9, 3.732041960518511*^9}, {
  3.732377744524441*^9, 3.732377766326355*^9}, {3.732377917820128*^9, 
  3.732377919533119*^9}},ExpressionUUID->"765502d8-67b4-4f52-80dc-\
9ca82f99ab18"],

Cell[BoxData["\<\"/Users/blake/threelinkQ\"\>"], "Output",
 CellChangeTimes->{3.732041961006385*^9, 3.7323780055708427`*^9, 
  3.7324561618952217`*^9, 3.7324845355857973`*^9, 3.73248466010853*^9, 
  3.732485780152936*^9, 3.732485863372826*^9, 3.732490231175942*^9, 
  3.732531744025714*^9},ExpressionUUID->"439e6aa6-ffef-4567-adea-\
0d5e14970763"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<MaTeX`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.72677543324012*^9, 
  3.7267754424434233`*^9}},ExpressionUUID->"e405923e-bde1-4e02-9e85-\
20ab1de12425"],

Cell["\<\
The obvious thing to do is start by reproducing the three-link using Scott\
\[CloseCurlyQuote]s notebook as a guide.\
\>", "Text",
 CellChangeTimes->{{3.7190237316943913`*^9, 3.719023756477062*^9}, {
  3.72446200039536*^9, 3.724462000630921*^9}, {3.72986835767623*^9, 
  3.729868366700389*^9}},ExpressionUUID->"6079f251-8e2f-4723-a84e-\
493989af1f49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"robotParameters", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "0.0725"}], ",", " ", 
     RowBox[{"b", "\[Rule]", "0.15"}], ",", " ", 
     RowBox[{"gap", "\[Rule]", " ", "0.02"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718028155766251*^9, 3.718028209231039*^9}, {
   3.718910361304373*^9, 3.718910429267473*^9}, 3.718910486322949*^9, {
   3.718912099516273*^9, 3.718912117815311*^9}, {3.7189412049190073`*^9, 
   3.718941218478373*^9}, 3.71894125687866*^9, {3.7190212672937803`*^9, 
   3.719021269785841*^9}, {3.7190222453731728`*^9, 3.719022252981271*^9}, {
   3.719022349330474*^9, 3.71902235315693*^9}, {3.719023164847548*^9, 
   3.7190231657581663`*^9}, {3.7190844541143227`*^9, 
   3.7190844726740217`*^9}, {3.719085562770052*^9, 3.719085573378058*^9}, {
   3.719085699776153*^9, 3.719085754144931*^9}, {3.7191968395761766`*^9, 
   3.719196903319669*^9}, {3.71923408176305*^9, 3.719234135021182*^9}, {
   3.7210900777353687`*^9, 3.721090099358502*^9}, 3.7210901384390097`*^9, {
   3.7239032766910057`*^9, 3.723903276762176*^9}, {3.723903899392838*^9, 
   3.7239038999316874`*^9}, {3.723904450285269*^9, 3.723904451569413*^9}, {
   3.7239136304730186`*^9, 3.7239136309032373`*^9}, {3.723914931185891*^9, 
   3.7239149545771*^9}, {3.723915010708448*^9, 3.723915011059268*^9}, {
   3.724692940339081*^9, 3.724693010597268*^9}, {3.724693248892469*^9, 
   3.724693249050291*^9}, {3.7263178953308783`*^9, 3.726317917318746*^9}, {
   3.7267603494440947`*^9, 3.726760358182069*^9}, {3.7267787180678263`*^9, 
   3.726778727124358*^9}, {3.72677878869862*^9, 3.726778796411099*^9}, {
   3.726793013297126*^9, 3.726793018490244*^9}, {3.731753210531802*^9, 
   3.73175322056208*^9}},ExpressionUUID->"af7ec7e7-ded0-446d-af71-\
0b6a06ce8f11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zbody", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], ",", " ", 
     RowBox[{"y", "[", "t", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7190857523705387`*^9},ExpressionUUID->"ab6754d9-414c-414e-83cd-\
7ef7b7973cd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zhead", "=", " ", 
   RowBox[{"zbody", "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.719085729984912*^9, {3.723903145188452*^9, 3.723903155747073*^9}, {
   3.723913536122883*^9, 3.7239135405493298`*^9}, {3.723916742591134*^9, 
   3.72391678455721*^9}},ExpressionUUID->"fc2e52a1-65c8-4c94-a3df-\
6299278c5d4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ztail", " ", "=", " ", 
   RowBox[{"zbody", "-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
          RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "gap"}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
          RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718910508206327*^9, 3.718910549589747*^9}, {
  3.718911996480999*^9, 3.7189120059151077`*^9}, {3.718912121608396*^9, 
  3.71891213595437*^9}, {3.71908447625718*^9, 3.719084478561014*^9}, {
  3.7190845646452703`*^9, 3.719084567252512*^9}, {3.719084814182561*^9, 
  3.719084814189521*^9}, {3.7190906872172527`*^9, 3.719090688192341*^9}, {
  3.723903158126718*^9, 3.723903164853403*^9}, {3.723913570053235*^9, 
  3.723913575074522*^9}},ExpressionUUID->"89597fee-ded8-4275-9a25-\
7a5a0d0d2c84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headPivot", " ", "=", " ", 
   RowBox[{"zbody", "+", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", "gap"}], ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", "gap"}], ")"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718910624667165*^9, 3.718910635195606*^9}, 
   3.718910713373279*^9, {3.718910762619812*^9, 3.7189107797255173`*^9}, {
   3.718912147343313*^9, 3.7189121524235*^9}, 3.719084510747632*^9, {
   3.723903168170869*^9, 3.7239031699325123`*^9}, {3.7239135770138683`*^9, 
   3.723913582016527*^9}},ExpressionUUID->"02f80c74-ca2d-44fd-b461-\
767e2b0dfcce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tailPivot", " ", "=", " ", 
   RowBox[{"zbody", "-", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", "gap"}], ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", "gap"}], ")"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7189107815596647`*^9, 3.718910829285324*^9}, {
   3.718912158441134*^9, 3.718912163893648*^9}, 3.7190845107601213`*^9, {
   3.723903171299857*^9, 3.723903173077107*^9}, {3.723913583774716*^9, 
   3.723913585714573*^9}},ExpressionUUID->"9836e676-578c-4523-ae6a-\
0b6ce331a978"],

Cell[BoxData[
 RowBox[{
  RowBox[{"body", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Purple", ",", 
       RowBox[{"Opacity", "[", "0.4", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"zbody", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "a"}], "}"}]}], "]"}]}], "}"}], "//", 
     RowBox[{
      RowBox[{"Rotate", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}], ",", "zbody"}], "]"}], "&"}]}], "//",
     "Graphics"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718910845696721*^9, 3.718910885737664*^9}, {
  3.7190845107696877`*^9, 3.719084510776277*^9}, {3.7192618036000757`*^9, 
  3.7192618182880793`*^9}, {3.71926191136646*^9, 3.719261911409773*^9}, {
  3.731684917062976*^9, 
  3.731684923271525*^9}},ExpressionUUID->"bbc9ff36-0b98-41cd-b137-\
23e6d2d8058a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headPivotDot", "=", 
   RowBox[{
    RowBox[{"Disk", "[", 
     RowBox[{"headPivot", ",", "0.02"}], "]"}], "//", "Graphics"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718910923277557*^9, 3.7189109543106823`*^9}, {
  3.7246930851308002`*^9, 
  3.724693085204927*^9}},ExpressionUUID->"5f2306ce-7bc6-47f7-b7ca-\
9e99e98a32a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headPivotLine1", "=", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"zbody", ",", "headPivot"}], "}"}], "]"}], "//", "Graphics"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7189109796559353`*^9, 3.71891104630532*^9}, 
   3.719084510788248*^9},ExpressionUUID->"7d4081bd-212f-434b-ab9f-\
9c6efd27bbf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"headPivotLine2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"headPivot", ",", "zhead"}], "}"}], "]"}], "//", "Graphics"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.718911053168841*^9, 3.718911075666708*^9}, 
   3.7190845255325947`*^9},ExpressionUUID->"57e15ba2-897e-4635-a2e6-\
03a9b87ceb36"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"head", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{"zhead", ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "a"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Rotate", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Phi]", "[", "t", "]"}]}]}], "]"}], "&"}]}], "//", 
     "Graphics"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.718911080286725*^9, 3.718911119994604*^9}, 
   3.7190845255418997`*^9, {3.719234369844544*^9, 3.719234380625535*^9}, {
   3.719234426134729*^9, 3.719234462500716*^9}, 
   3.719261511487323*^9},ExpressionUUID->"00bb100b-52f2-4556-a97f-\
29e327ee2706"],

Cell[BoxData[
 RowBox[{
  RowBox[{"head", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Purple", ",", 
       RowBox[{"Opacity", "[", "0.4", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"zhead", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "a"}], "}"}]}], "]"}]}], "}"}], "//", 
     RowBox[{
      RowBox[{"Rotate", "[", 
       RowBox[{"#", ",", " ", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
         RowBox[{"\[Phi]", "[", "t", "]"}]}]}], "]"}], "&"}]}], "//", 
    "Graphics"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719261493093008*^9, 3.719261506725206*^9}, {
  3.719261770974485*^9, 3.7192617743813477`*^9}, {3.719261915026943*^9, 
  3.71926191508974*^9}, {3.7316847392667103`*^9, 3.731684754626067*^9}, {
  3.731684908599557*^9, 
  3.7316849098615513`*^9}},ExpressionUUID->"1e55941d-cd89-4fef-88fc-\
8b7693e41ed5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tailPivotDot", " ", "=", " ", 
   RowBox[{
    RowBox[{"Disk", "[", 
     RowBox[{"tailPivot", ",", " ", "0.02"}], "]"}], "//", "Graphics"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7189111297070227`*^9, 3.7189111524783077`*^9}, {
  3.724693089685897*^9, 
  3.724693092437645*^9}},ExpressionUUID->"07093537-df42-4b46-ad65-\
ab2c46661c69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tailPivotLine1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"zbody", ",", "tailPivot"}], "}"}], "]"}], "//", "Graphics"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.718911160425712*^9, 3.7189111909257317`*^9}, 
   3.719084510802918*^9},ExpressionUUID->"51c6021b-a81e-49a1-9f22-\
6aada392197b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tailPivotLine2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"ztail", ",", "tailPivot"}], "}"}], "]"}], "//", "Graphics"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7189111927217913`*^9, 3.718911215315893*^9}, 
   3.719084536804084*^9},ExpressionUUID->"286b501b-3712-461f-8043-\
bf1ad75eeb28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tail", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Purple", ",", 
       RowBox[{"Opacity", "[", "0.4", "]"}], ",", 
       RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"ztail", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "a"}], "}"}]}], "]"}]}], "}"}], "//", 
     RowBox[{
      RowBox[{"Rotate", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
         RowBox[{"\[Theta]1", "[", "t", "]"}]}]}], "]"}], "&"}]}], "//", 
    "Graphics"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718911218487406*^9, 3.7189112700173607`*^9}, 
   3.719084536812491*^9, 3.719084814201388*^9, {3.7191512738798113`*^9, 
   3.719151284118373*^9}, {3.71926182568095*^9, 3.719261838289007*^9}, {
   3.719261917987289*^9, 3.719261918066553*^9}, {3.731684931384*^9, 
   3.731684934263953*^9}},ExpressionUUID->"3aef94fc-d0f1-430c-b73b-\
9fe9aed44b52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"water", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Blue", ",", 
      RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "8"}], " ", ",", "8"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "8"}], " ", ",", " ", "8"}], "}"}]}], "]"}]}], "}"}], "//",
     "Graphics"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719324857147009*^9, 3.719324878186445*^9}, {
  3.719324908702073*^9, 3.7193249418210278`*^9}, {3.71932503088068*^9, 
  3.719325032192664*^9}, {3.719325068290462*^9, 3.719325069531332*^9}, {
  3.719327326654928*^9, 3.719327346901902*^9}, {3.719327416433566*^9, 
  3.71932743988078*^9}},ExpressionUUID->"3ea85d80-0f01-4ca7-a5fd-\
995533b87382"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"eyeleft", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"White", ",", " ", 
     RowBox[{"Disk", "[", 
      RowBox[{"zhead", "+", "{"}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.719323379364708*^9, 
  3.7193234295861177`*^9}},ExpressionUUID->"287b3d88-0ffc-4036-b588-\
cf7d66b0d035"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "body", ",", "headPivotDot", ",", "head", ",", "tail", ",", 
           "tailPivotDot", ",", "headPivotLine1", ",", "headPivotLine2", ",", 
           "tailPivotLine1", ",", "tailPivotLine2"}], "}"}], "/.", 
         "robotParameters"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", " ", "X"}], ",", " ", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", " ", "Y"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", 
           "\[CapitalTheta]"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", " ", 
           "\[CapitalTheta]1"}], ",", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
           "\[CapitalPhi]"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"PlotRange", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
                "2"}], ")"}]}], " ", ",", " ", 
             RowBox[{
              RowBox[{"3", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
              "2"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
                "2"}], ")"}]}], " ", ",", " ", 
             RowBox[{
              RowBox[{"3", " ", "b"}], "+", " ", "gap", " ", "+", " ", 
              "2"}]}], "}"}]}], "}"}]}], " ", "/.", " ", 
        "robotParameters"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Y", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[CapitalTheta]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[CapitalTheta]1", ",", 
       FractionBox[
        RowBox[{"-", "\[Pi]"}], "2"], ",", 
       FractionBox["\[Pi]", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[CapitalPhi]", ",", 
       FractionBox[
        RowBox[{"-", "\[Pi]"}], "2"], ",", 
       FractionBox["\[Pi]", "2"]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.718911276771182*^9, 3.7189113835648947`*^9}, {
   3.7189114146651793`*^9, 3.7189116097463303`*^9}, {3.718911671855301*^9, 
   3.718911702105517*^9}, {3.718911733118062*^9, 3.7189117371844482`*^9}, {
   3.718912055902588*^9, 3.7189120618444757`*^9}, 3.718912508620569*^9, {
   3.718912811409225*^9, 3.718912826870206*^9}, 3.7190236697280903`*^9, {
   3.719024308172579*^9, 3.7190243146037483`*^9}, 3.719082604532221*^9, 
   3.71908481421309*^9, 3.719085829523987*^9, 3.719235835404845*^9, 
   3.7210867288768797`*^9, 3.7236657504532557`*^9, {3.723903043930779*^9, 
   3.723903044167186*^9}, 
   3.727615877768229*^9},ExpressionUUID->"df0e87a6-f602-4492-b69d-\
7a0ffa495d07"],

Cell[CellGroupData[{

Cell["Three-link System Dynamics", "Chapter",
 CellFrame->{{0, 0}, {2, 0}},
 CellChangeTimes->{{3.718912592755411*^9, 3.718912616922662*^9}, {
  3.718912704232243*^9, 3.7189127140738087`*^9}, {3.7192357709998407`*^9, 
  3.719235775768653*^9}},ExpressionUUID->"b6304e21-7a08-491c-9d19-\
d12d80ff7d1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ebodylong", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718026846915421*^9, 3.718026893159186*^9}, {
  3.718026954107463*^9, 3.718026956329226*^9}, {3.71891330515909*^9, 
  3.7189133330450163`*^9}},ExpressionUUID->"d3af6aaf-07fc-41cd-bb6c-\
6c3b4160abb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ebodylat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718026894898725*^9, 
  3.718026964185615*^9}},ExpressionUUID->"2182a14a-fdd3-436b-abc9-\
3b99cebdb9c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eheadlong", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7180269692459993`*^9, 
  3.7180269975005627`*^9}},ExpressionUUID->"57f38b3a-3971-4dc4-b42a-\
b77f4bc2c5d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eheadlat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
        RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], ",", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "+", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.718027035869513*^9, 3.718027040988626*^9}, {
  3.7180270946475554`*^9, 3.7180271089899197`*^9}, {3.718028036596389*^9, 
  3.718028117822002*^9}},ExpressionUUID->"74e526d6-1d19-46e3-8aa0-\
dec243997166"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"etaillong0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ",", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"etaillong", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}], ",", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.719084814224703*^9, 3.7190848142313023`*^9}, {
  3.720466038317972*^9, 3.7204660614298897`*^9}, {3.720466092125084*^9, 
  3.720466093083952*^9}, {3.723904822438242*^9, 
  3.723904825592289*^9}},ExpressionUUID->"7041702f-ecfa-497a-9301-\
603fb7f151c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"etaillat0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"etaillat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Theta]1", "[", "t", "]"}]}], "+", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.718028087081287*^9, 3.718028103051817*^9}, {
  3.719084814239978*^9, 3.719084814246525*^9}, {3.720466033368252*^9, 
  3.720466098187442*^9}, {3.723904837721046*^9, 
  3.723904840130303*^9}},ExpressionUUID->"f83ad41e-05e8-42d6-97ae-\
672eb6a07285"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ellipseMasses", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mLong", "\[Rule]", " ", 
      RowBox[{"\[Rho]", " ", "\[Pi]", " ", 
       SuperscriptBox["a", "2"]}]}], ",", 
     RowBox[{"mLat", " ", "\[Rule]", " ", 
      RowBox[{"\[Rho]", " ", "\[Pi]", " ", 
       SuperscriptBox["b", "2"]}]}], ",", " ", 
     RowBox[{"mRot", " ", "\[Rule]", " ", 
      RowBox[{"\[Rho]", " ", 
       FractionBox["\[Pi]", "8"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["b", "2"], "-", 
          SuperscriptBox["a", "2"]}], ")"}], "2"]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718913117290391*^9, 
  3.7189132160095367`*^9}},ExpressionUUID->"1f498509-9de9-4f1d-a607-\
7b30a7fa4774"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vhead", "=", 
   RowBox[{"D", "[", 
    RowBox[{"zhead", ",", "t"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718913255773003*^9, 3.718913276650957*^9}, {
   3.7189165953666887`*^9, 3.7189166310800343`*^9}, 3.719084525552739*^9, 
   3.719084591770535*^9, 3.72109134153366*^9, 
   3.7215842300944366`*^9},ExpressionUUID->"20cd1eae-89cc-47c9-98b1-\
6f63b9bfaf12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vbody", "=", 
   RowBox[{"D", "[", 
    RowBox[{"zbody", ",", " ", "t"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718916634227703*^9, 3.718916644611259*^9}, 
   3.719084510818919*^9, 3.719084603712569*^9, {3.721131357078837*^9, 
   3.7211313608490458`*^9}},ExpressionUUID->"121641db-d92b-4f06-b26f-\
605c564c57cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vtail", "=", 
   RowBox[{"D", "[", 
    RowBox[{"ztail", ",", "t"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718916646308762*^9, 3.718916656289501*^9}, 
   3.7190845367944613`*^9, 3.719084612488864*^9, 3.721131346233226*^9, 
   3.721584231758852*^9},ExpressionUUID->"ddf902bc-0639-4725-a483-\
a60d1da17d58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KEbody", " ", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", "mLong", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vbody", ".", "ebodylong"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "mLat", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vbody", ".", "ebodylat"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "mRot", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ")"}], "2"]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718916661933909*^9, 3.718916736422237*^9}, {
   3.7190846037245083`*^9, 3.7190846037312193`*^9}, 3.719084645100093*^9, 
   3.7210710331931667`*^9, 
   3.7221784976748238`*^9},ExpressionUUID->"fa1a0b21-c0c9-487a-bd7f-\
693d7de51634"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KEhead", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], "mLong", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vhead", ".", "eheadlong"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "mLat", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vhead", ".", "eheadlat"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "mRot", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "+", 
        RowBox[{
         RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], ")"}], "2"]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718916739058429*^9, 3.718916802800523*^9}, {
   3.7190845917825193`*^9, 3.719084591789049*^9}, 
   3.7190846540382633`*^9},ExpressionUUID->"09babf5c-58e5-4e72-83c3-\
d4f50ab240c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"KEtail", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", "mLong", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vtail", ".", "etaillong"}], ")"}], "2"]}], " ", "+", " ", 
    RowBox[{
     FractionBox["1", "2"], " ", "mLat", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"vtail", ".", "etaillat"}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], "mRot", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "-", 
        RowBox[{
         RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], ")"}], "2"]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718916804370028*^9, 3.7189168664576263`*^9}, {
   3.719084612476507*^9, 3.719084612483027*^9}, 3.7190846625889807`*^9, 
   3.719084823982109*^9, {3.722178579727702*^9, 3.722178580782734*^9}, {
   3.7221786158256283`*^9, 3.722178616094537*^9}, {3.722179000362907*^9, 
   3.722179006235456*^9}, {3.723904848948764*^9, 
   3.723904850779337*^9}},ExpressionUUID->"58f2c0ac-f15f-4098-9bd7-\
256e1d339938"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PEtail", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "2"], " ", "k1", " ", 
    SuperscriptBox[
     RowBox[{"\[Theta]1", "[", "t", "]"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7189168799471197`*^9, 3.718916939941894*^9}, {
   3.718917024367435*^9, 3.71891702470901*^9}, 3.719084763381665*^9, 
   3.719084814255311*^9, 3.7190848800195513`*^9, {3.719085426980977*^9, 
   3.71908542787505*^9}},ExpressionUUID->"07416327-1742-453c-8abb-\
c593d02c13ed"],

Cell["What are the units of k? N*m/rad, I think...", "Text",
 CellChangeTimes->{{3.724752786251102*^9, 3.7247528329903708`*^9}, {
  3.724752961592908*^9, 
  3.724752975095566*^9}},ExpressionUUID->"9bb73871-6920-4e6a-aca5-\
7e5760691924"],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"KEbody", "+", "KEhead", "+", "KEtail", "-", "PEtail"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.718977665114277*^9, 3.718977684980351*^9}, {
   3.719084645107326*^9, 3.71908466259459*^9}, 3.719084763375708*^9, {
   3.721071058978797*^9, 3.721071068698495*^9}, {3.721088656119906*^9, 
   3.721088657418161*^9}},ExpressionUUID->"c7f636e3-44a9-4cd3-a037-\
ba64a9d1a5cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"liftedAction", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{"xbar", " ", "+", " ", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]bar", "]"}]}], "-", 
       RowBox[{
        RowBox[{"y", "[", "t", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]bar", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"y", "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{"ybar", "+", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]bar", "]"}]}], "+", 
       RowBox[{
        RowBox[{"y", "[", "t", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]bar", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "+", "\[Theta]bar"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]bar", "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]bar", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]bar", "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]bar", "]"}]}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7239152147497253`*^9, 
  3.723915329627507*^9}},ExpressionUUID->"f6834e46-b73e-4d5c-b5c6-\
1776826761de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"L", " ", "-", " ", "L"}], "/.", "liftedAction"}]], "Input",
 CellChangeTimes->{{3.723915336261881*^9, 
  3.7239153433977203`*^9}},ExpressionUUID->"95d3a84b-d0c6-4d70-9cc4-\
3bc664bbb82a"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.723915344481678*^9, 3.723915424407296*^9, 3.7239158339468403`*^9, 
   3.723916523543078*^9, 3.7239170216787786`*^9, 3.724028519112628*^9, 
   3.724079491428833*^9, 3.724170412573181*^9, 3.724170641641676*^9, 
   3.724358272859214*^9, 3.72435844857651*^9, 3.7243585718856*^9, 
   3.724359326479899*^9, 3.724360611648082*^9, 3.7243618380773582`*^9, 
   3.7243619318239603`*^9, 3.724362324113883*^9, 3.724362760973269*^9, 
   3.724376125049292*^9, 3.724376826513031*^9, 3.724376985332438*^9, 
   3.724377088622286*^9, 3.7243771329731216`*^9, 3.7244202573086567`*^9, 
   3.724438807927217*^9, 3.7244417471807547`*^9, 3.7244448952187*^9, 
   3.724448626275807*^9, 3.724453597563143*^9, 3.724681701209649*^9, 
   3.724693025258761*^9, 3.724693155942602*^9, 3.724751721043931*^9, 
   3.724751937209231*^9, 3.724753088370027*^9, 3.724759245302133*^9, 
   3.724875831129406*^9, 3.724929841694149*^9, 3.724930180544142*^9, 
   3.725063421856248*^9, 3.725063510475103*^9, 3.725063974904468*^9, 
   3.725064056171266*^9, 3.7250645811912394`*^9, 3.725064714320528*^9, 
   3.725064790807787*^9, 3.725064872655711*^9, 3.725065124584127*^9, 
   3.7250656750358953`*^9, 3.7250657269860163`*^9, 3.7251131187701187`*^9, 
   3.7251139220042467`*^9, 3.725117414611794*^9, {3.725117578379019*^9, 
   3.7251176060001307`*^9}, 3.725117882820136*^9, 3.725117919710101*^9, 
   3.725118040687698*^9, {3.725118265540372*^9, 3.725118290604713*^9}, 
   3.725118356280477*^9, 3.7251183912354383`*^9, 3.725118594226144*^9, 
   3.725118895180928*^9, 3.725119690344224*^9, 3.72512287129745*^9, 
   3.72512457418556*^9, 3.725124616055861*^9, {3.7251249281533012`*^9, 
   3.725124955854375*^9}, 3.725125145339271*^9, 3.725126415252466*^9, 
   3.7251267892612867`*^9, 3.725127059640277*^9, 3.725194019255472*^9, 
   3.725194779657341*^9, 3.7251949411790743`*^9, 3.725195227981872*^9, 
   3.725196247247978*^9, 3.7251972309938507`*^9, 3.725197359288658*^9, 
   3.7251974015073338`*^9, 3.725198189122666*^9, 3.725207644230761*^9, 
   3.72520786738316*^9, 3.7252079534122667`*^9, 3.7252080851493597`*^9, 
   3.725208151949009*^9, 3.725208251717546*^9, 3.7252369690295887`*^9, 
   3.725237106128327*^9, 3.725237454382942*^9, 3.725237541301177*^9, 
   3.72527992599177*^9, 3.7252804770858727`*^9, 3.725280707206463*^9, 
   3.7252807565685663`*^9, 3.7252817979756107`*^9, 3.725307901843101*^9, 
   3.725365320790481*^9, 3.725365606104645*^9, 3.7253672104527693`*^9, 
   3.725387251432295*^9, 3.725400288132613*^9, 3.725401921084309*^9, 
   3.725494978067415*^9, 3.725556306334341*^9, 3.7255779890898523`*^9, 
   3.7255782704858017`*^9, 3.725627938108561*^9, 3.7256279839753723`*^9, 
   3.72562801540621*^9, 3.725628066786038*^9, 3.72562828141882*^9, 
   3.725628763615307*^9, 3.7256288765396833`*^9, 3.72575711478016*^9, 
   3.725757541013424*^9, 3.725887263503644*^9, 3.725905777686328*^9, 
   3.7259748577238417`*^9, 3.726180483318618*^9, 3.726180552596951*^9, 
   3.726317939263461*^9, 3.7263252844748373`*^9, 3.726489015113624*^9, {
   3.726497048885742*^9, 3.726497072179357*^9}, 3.7264973956343193`*^9, 
   3.726497642424144*^9, 3.726499217668344*^9, 3.7264995404772243`*^9, 
   3.726501862071851*^9, 3.726501987030443*^9, 3.726604965242798*^9, 
   3.7266069075661592`*^9, 3.72662066801412*^9, 3.726624051623665*^9, 
   3.7266622015738707`*^9, 3.726682077423038*^9, 3.726760569070725*^9, 
   3.726793137838435*^9, 3.7276270251348963`*^9, 3.72762707238302*^9, 
   3.727644976309133*^9, 3.72765790276722*^9, 3.727702780858465*^9, 
   3.7277062629665537`*^9, 3.727788319848596*^9, 3.7281377698469753`*^9, 
   3.728141871882976*^9, 3.728241434119474*^9, 3.728241566258309*^9, 
   3.728241621887339*^9, 3.72824173621111*^9, 3.7282417696266947`*^9, 
   3.728241825444652*^9, 3.728241863047792*^9, {3.728242166365774*^9, 
   3.728242184974112*^9}, 3.728242222065534*^9, 3.728242270029437*^9, 
   3.728242300052347*^9, 3.728242475997751*^9, {3.728242651280283*^9, 
   3.728242679886389*^9}, 3.7282427154396667`*^9, 3.728242855944253*^9, {
   3.728242915994685*^9, 3.7282429446789*^9}, 3.728242982408201*^9, 
   3.728740680656768*^9, 3.728925766019141*^9, 3.729000354573968*^9, 
   3.7293409234320097`*^9, 3.72934139435702*^9, 3.729342813184087*^9, 
   3.729344834777027*^9, 3.729346179364418*^9, 3.7293472896213083`*^9, 
   3.729528390652214*^9, 3.729533620304036*^9, 3.729533988148778*^9, 
   3.72953421908002*^9, 3.7296144229073763`*^9, 3.729614530148279*^9, 
   3.729614598724121*^9, 3.729707480658978*^9, 3.729707827001783*^9, 
   3.729707931957858*^9, 3.729709753681818*^9, 3.729710359323011*^9, 
   3.7297108520252237`*^9, 3.7297111479583797`*^9, 3.7298024066802797`*^9, 
   3.7298027468549643`*^9, 3.7298060298078413`*^9, 3.7298675087864323`*^9, 
   3.729868020992783*^9, 3.729868405904299*^9, 3.729868747809873*^9, 
   3.729877390307983*^9, 3.729948214464048*^9, 3.729948250634602*^9, {
   3.729948466957862*^9, 3.729948492648582*^9}, 3.729948585114808*^9, 
   3.729949191376505*^9, 3.729949740064251*^9, 3.7299591584009666`*^9, 
   3.729971889097332*^9, 3.729979190283742*^9, 3.729979471946624*^9, 
   3.729979572876651*^9, 3.729979984509823*^9, 3.730026519055122*^9, 
   3.730026804728965*^9, 3.730027516130587*^9, 3.730027594124914*^9, 
   3.730027632977326*^9, 3.730056099790279*^9, 3.7300561467541313`*^9, 
   3.730056641199358*^9, 3.730056731179493*^9, 3.730056837071946*^9, 
   3.7300576815551043`*^9, 3.7300577195371437`*^9, 3.730058160144937*^9, 
   3.730122879624173*^9, 3.730126701049461*^9, 3.730126901636256*^9, 
   3.730131584039547*^9, 3.73013163296132*^9, 3.730143822818418*^9, {
   3.730143962089829*^9, 3.730144008008656*^9}, 3.730144042870405*^9, 
   3.730413821323535*^9, 3.73041431860178*^9, 3.730414941065295*^9, 
   3.7304156304218283`*^9, 3.7304160174161654`*^9, 3.7304608964667797`*^9, 
   3.730484510579108*^9, 3.730491229754574*^9, 3.7304916317159843`*^9, 
   3.730545851940694*^9, 3.7305467362195168`*^9, 3.7305472268776503`*^9, 
   3.730548175262039*^9, 3.730549978163951*^9, 3.73055193355363*^9, 
   3.730554088677784*^9, 3.730554603226047*^9, 3.730554945363594*^9, 
   3.730556795531292*^9, 3.730556925383972*^9, 3.7305578109515257`*^9, 
   3.730557874089375*^9, 3.730558280869389*^9, 3.730562915014352*^9, 
   3.730563772310033*^9, 3.730563866915133*^9, 3.7305640041342993`*^9, 
   3.7305645269174*^9, 3.7305676011982803`*^9, 3.730567809688087*^9, 
   3.730716301789632*^9, 3.7307199827839108`*^9, 3.730720281520159*^9, 
   3.730720578384707*^9, 3.730724565732999*^9, 3.730725135398641*^9, 
   3.7307334365880117`*^9, 3.730736289271771*^9, 3.7307386804707317`*^9, 
   3.73074749842308*^9, 3.730747662234366*^9, 3.730904562403693*^9, 
   3.730904918933475*^9, 3.730907165285617*^9, {3.730907219991476*^9, 
   3.730907241273389*^9}, 3.7309074462144423`*^9, 3.73090765311187*^9, 
   3.730907710611927*^9, 3.731065404132494*^9, 3.7310659625833693`*^9, 
   3.731066372241045*^9, 3.731066602102007*^9, 3.731066928381302*^9, 
   3.731069103068449*^9, 3.731089219816348*^9, 3.7311508102987423`*^9, 
   3.731152301938232*^9, 3.7311611114909887`*^9, 3.7311797617290277`*^9, 
   3.731180393031889*^9, 3.7311807365019083`*^9, 3.731181062904529*^9, 
   3.7312341141483707`*^9, 3.731234633364031*^9, 3.73123734794527*^9, 
   3.731238227901252*^9, 3.731666793906983*^9, 3.731667380914716*^9, 
   3.7316801612214947`*^9, 3.731680336357648*^9, 3.731680456285262*^9, 
   3.731683945499544*^9, 3.7316847706196747`*^9, 3.731684957004264*^9, 
   3.731752159160714*^9, 3.731756396129838*^9, 3.7317683849276237`*^9, 
   3.731769100476083*^9, 3.731770956879012*^9, 3.7317778557556343`*^9, 
   3.7317917719950113`*^9, 3.7318335438400087`*^9, 3.731840758675273*^9, 
   3.731842509539193*^9, 3.731857614396366*^9, 3.7318677921760273`*^9, 
   3.731884105941925*^9, 3.731926452230463*^9, 3.731936567814948*^9, 
   3.731938114459262*^9, 3.731939628983775*^9, 3.731940936606471*^9, 
   3.731942807821268*^9, 3.73194284242798*^9, 3.731946374055468*^9, 
   3.732040875765328*^9, 3.732378013467572*^9, 3.7324561643784723`*^9, 
   3.732484537141633*^9, 3.732484661384735*^9, 3.73248578251022*^9, 
   3.7324858645197783`*^9, 3.732490233234977*^9, 
   3.73253174502626*^9},ExpressionUUID->"ee60be63-5222-4167-a4c0-\
ef25e7b0eb65"]
}, Open  ]],

Cell[TextData[{
 "Define the infinitesimal generators. Let me make sure that I conceptually \
understand the infinitesimal generator. If \[CapitalPhi] acts on elements of \
G x Q and results in \[OpenCurlyDoubleQuote]motion\[CloseCurlyDoubleQuote] in \
Q, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Zeta]", "Q"], TraditionalForm]],ExpressionUUID->
  "b2a7d9c1-c26a-4dd0-aba9-ecec2ca03ebd"],
 " (the infinitesimal generator) is a vector field that takes as arguments \
elements of Q and gives tangent vectors in Q, according to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["d", "d\[Epsilon]"], 
    SubscriptBox["|", 
     RowBox[{"\[Epsilon]", "=", "0"}]], 
    RowBox[{"(", 
     RowBox[{"\[CapitalPhi]", "(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"\[Epsilon]", " ", "\[Zeta]"}], ")"}], ",", "q"}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"10809bd4-d0ab-4304-9502-6b195fa28e25"],
 ". It isn\[CloseCurlyQuote]t entirely clear why we need to define two Lie \
algebra elements. Oh, wait. A Lie algebra element is needed for each joint \
motion."
}], "Text",
 CellChangeTimes->{{3.718977951581862*^9, 3.7189779935656843`*^9}, 
   3.718978390845457*^9, {3.718978517602282*^9, 3.7189785176801653`*^9}, {
   3.7189785600024023`*^9, 3.718978623524781*^9}, {3.718978660470437*^9, 
   3.718978674935272*^9}, {3.7189787232886267`*^9, 3.718978845676446*^9}, {
   3.71897887929501*^9, 3.718978980290846*^9}, {3.7189799906028547`*^9, 
   3.718980093268216*^9}, {3.7189807637305727`*^9, 3.718980764193894*^9}, {
   3.7189816278544617`*^9, 3.71898169678473*^9}, {3.723915157184494*^9, 
   3.7239151868314543`*^9}, {3.723915352998468*^9, 
   3.7239153532341022`*^9}},ExpressionUUID->"bd3d54fe-bff7-481b-8f7e-\
db5cfdb3e513"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Zeta]", "=", 
   RowBox[{"{", 
    RowBox[{"\[Zeta]1", ",", " ", "\[Zeta]2", ",", " ", "\[Zeta]3"}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.718977997716864*^9, 3.718978021234399*^9}, 
   3.723915197814952*^9},ExpressionUUID->"06624722-45bd-4b63-b311-\
92f1e18e64f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Zeta]Q", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Zeta]1", " ", "-", " ", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], " ", "\[Zeta]3"}]}], ",", " ", 
     RowBox[{"\[Zeta]2", " ", "+", " ", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], " ", "\[Zeta]3"}]}], ",", " ", 
     "\[Zeta]3", ",", " ", "0", ",", " ", "0"}], "}"}]}], ";"}]], "Input",Expr\
essionUUID->"a2703cc2-9fa7-4e16-a34d-cd3bf796f70e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]1", ",", " ", "\[Lambda]2", ",", " ", "\[Lambda]3"}], 
    "}"}]}], ";"}]], "Input",ExpressionUUID->"12fedbd9-c01c-4c44-b419-\
ce3b352ab33c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]Q", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]1", " ", "-", " ", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], " ", "\[Lambda]3"}]}], ",", " ", 
     RowBox[{"\[Lambda]2", " ", "+", " ", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], " ", "\[Lambda]3"}]}], ",", " ", 
     "\[Lambda]3", ",", " ", "0", ",", " ", "0"}], "}"}]}], ";"}]], "Input",Ex\
pressionUUID->"4eba9901-237e-4933-bd54-a1a038c104ab"],

Cell["\<\
Since there is an SE(2) symmetry, the momentum maps associated with this \
symmetry are obtained by the natural pairing of the infinitesimal generators \
with the fiber derivative of the Lagrangian. (Skip to where we define the \
momentum maps. The following code just defines the ODEs for the three link \
swimmer.)\
\>", "Text",
 CellChangeTimes->{{3.718982637951312*^9, 3.718982666766885*^9}, {
   3.718982736433609*^9, 3.7189827473297*^9}, {3.71902052903123*^9, 
   3.719020568628771*^9}, {3.719023005632502*^9, 3.719023008948236*^9}, {
   3.719151491723859*^9, 3.719151492184904*^9}, 3.7281487166747627`*^9, {
   3.728148798144038*^9, 3.72814883201753*^9}, {3.728148877060255*^9, 
   3.728148921284296*^9}},ExpressionUUID->"56752aa5-b95d-4f49-a0a5-\
1d4bc85b907a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{
          RowBox[{"x", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
     "-", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190207199647093`*^9, 3.719020722374579*^9}, {
   3.719021483694234*^9, 3.719021494041192*^9}, {3.7190215528600407`*^9, 
   3.7190215615404463`*^9}, {3.719021602310233*^9, 3.7190216177353992`*^9}, {
   3.719174022102764*^9, 3.7191740255918818`*^9}, 3.719174411460841*^9, {
   3.7191977949214277`*^9, 3.719197796693228*^9}, {3.7191978498375807`*^9, 
   3.719197851412695*^9}, {3.721089635242494*^9, 3.721089639349965*^9}, {
   3.721089704523946*^9, 3.721089706937447*^9}, {3.721090527192341*^9, 
   3.721090535023093*^9}, {3.7210905736428328`*^9, 3.721090574090988*^9}, 
   3.721513041765123*^9, 3.721584225312303*^9, 3.725389001998167*^9, 
   3.725389038545429*^9},ExpressionUUID->"4f6003c7-204f-4667-af81-\
f2fa277e9fa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"yode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{
          RowBox[{"y", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
     "-", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190216212427883`*^9, 3.719021638342125*^9}, {
   3.719174010727219*^9, 3.719174018918293*^9}, {3.7191744220852013`*^9, 
   3.719174423492921*^9}, {3.719197802169883*^9, 3.719197804215314*^9}, {
   3.71919785373524*^9, 3.719197853923852*^9}, {3.721089645902275*^9, 
   3.721089648247664*^9}, 3.721089709284676*^9, {3.721090540542625*^9, 
   3.72109054373046*^9}, 
   3.721090576688198*^9},ExpressionUUID->"04a6fcac-ff7a-41a7-a6d7-\
d63e0d901179"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]ode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190216405092382`*^9, 3.719021661912898*^9}, {
   3.719174000292056*^9, 3.719174007687325*^9}, 3.719174427717031*^9, {
   3.719197807528124*^9, 3.7191978117521772`*^9}, {3.719199690309474*^9, 
   3.719199691593696*^9}, {3.721089652236102*^9, 
   3.721089686692568*^9}},ExpressionUUID->"774e1970-de23-446b-977f-\
ea3f60a20096"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]1ode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{
          RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"-", "c1"}], " ", 
     RowBox[{
      RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719021690060938*^9, 3.719021738109384*^9}, {
   3.719022313427668*^9, 3.7190223380219717`*^9}, {3.719084814279318*^9, 
   3.719084824009861*^9}, {3.7192358286863213`*^9, 3.7192358294681883`*^9}, 
   3.7192359146249723`*^9, 3.724759589906724*^9, 3.725388983872902*^9, 
   3.72662053843545*^9},ExpressionUUID->"c961904b-22b8-4272-9845-\
849f48d97745"],

Cell[BoxData[
 RowBox[{
  RowBox[{"odes", " ", "=", 
   RowBox[{"{", 
    RowBox[{"xode", ",", "yode", ",", "\[Theta]ode", ",", "\[Theta]1ode"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7190217436075163`*^9, 3.719021760357444*^9}, {
   3.7190821432677927`*^9, 3.719082165268042*^9}, 
   3.719182769189693*^9},ExpressionUUID->"0f5ab49d-4b29-44cc-9b66-\
d512aa87e728"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freq", " ", "=", " ", "0.2"}], ";"}]], "Input",
 CellChangeTimes->{{3.725757069662077*^9, 
  3.725757094848605*^9}},ExpressionUUID->"ae6ebfd9-a260-4389-b708-\
a603d905fdb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"omega", " ", "=", " ", 
   RowBox[{"2", " ", "3.14159", " ", "freq"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725627857338091*^9, 3.72562790221765*^9}, {
  3.725628044543508*^9, 3.725628058864991*^9}, {3.7256282763112593`*^9, 
  3.7256282772052813`*^9}, {3.725757045898604*^9, 
  3.725757064710824*^9}},ExpressionUUID->"9bddcdf1-dba4-4cf6-9545-\
cd51af089b20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.7281480758250237`*^9, 
  3.728148077022893*^9}},ExpressionUUID->"e342ba2c-ec2e-44a6-872d-\
65627d9567d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"shapeChange", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
     RowBox[{"A", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2.0", " ", "\[Pi]", " ", "freq", " ", "t"}], "]"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fluidAndSpringParams", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "\[Rule]", " ", "1.0"}], ",", 
     RowBox[{"\[Rho]", "\[Rule]", " ", "1000"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dampingParams", "=", 
   RowBox[{"{", 
    RowBox[{"c1", "\[Rule]", " ", 
     RowBox[{"2", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"k1", " ", "mRot"}], "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.719021816049778*^9, 3.719021869741192*^9}, {
   3.719022744334559*^9, 3.7190227465033283`*^9}, {3.719023172500269*^9, 
   3.7190231926848373`*^9}, 3.719085453268361*^9, {3.719150722935849*^9, 
   3.719150723075191*^9}, {3.719151831204376*^9, 3.71915185118675*^9}, {
   3.7191554494083357`*^9, 3.7191554503028584`*^9}, {3.719170940715567*^9, 
   3.719170942074362*^9}, {3.719170996550137*^9, 3.71917103062925*^9}, {
   3.71917162693427*^9, 3.719171627557405*^9}, 3.719174048922192*^9, {
   3.719174122043973*^9, 3.719174151515204*^9}, 3.719174213055107*^9, {
   3.719174783429*^9, 3.719174818228191*^9}, {3.719182945129719*^9, 
   3.7191829463640614`*^9}, {3.719183386385182*^9, 3.719183410009406*^9}, 
   3.719183560007409*^9, {3.719184316665613*^9, 3.719184334918503*^9}, {
   3.7191950830835533`*^9, 3.7191950892777233`*^9}, {3.719196478303507*^9, 
   3.719196483594782*^9}, {3.719196519025782*^9, 3.719196535505713*^9}, {
   3.719198077944169*^9, 3.719198095906692*^9}, {3.719235193387355*^9, 
   3.719235193465639*^9}, {3.719235227211679*^9, 3.719235248266815*^9}, {
   3.719236949077181*^9, 3.719236949506579*^9}, 3.719253189597741*^9, 
   3.71925331964729*^9, {3.719253436269411*^9, 3.719253468520537*^9}, {
   3.719253503237681*^9, 3.7192535034470253`*^9}, {3.719253569860602*^9, 
   3.719253572339445*^9}, {3.719253607694365*^9, 3.7192536126249037`*^9}, {
   3.719254067028459*^9, 3.719254095550935*^9}, {3.719254146447546*^9, 
   3.719254148870943*^9}, {3.7192587759674892`*^9, 3.71925878153102*^9}, {
   3.7192588194395514`*^9, 3.719258849153039*^9}, {3.719258894560063*^9, 
   3.7192588946071777`*^9}, {3.719258924738007*^9, 3.7192590090100822`*^9}, {
   3.719261945428501*^9, 3.719261953691764*^9}, {3.7192619918326674`*^9, 
   3.719261995941285*^9}, {3.7192624648884583`*^9, 3.719262476436986*^9}, {
   3.719262511832241*^9, 3.719262520167465*^9}, {3.7192625675486193`*^9, 
   3.71926256959394*^9}, {3.7193236082671967`*^9, 3.719323608327552*^9}, {
   3.719323647117181*^9, 3.719323678043412*^9}, {3.7204662587508793`*^9, 
   3.720466285431953*^9}, {3.720466330608432*^9, 3.720466330865178*^9}, {
   3.7210888125830393`*^9, 3.721088814712167*^9}, {3.721088874094129*^9, 
   3.721088886035144*^9}, {3.7210891184853697`*^9, 3.7210891186141577`*^9}, {
   3.72108915065769*^9, 3.721089169420952*^9}, {3.721089217856078*^9, 
   3.7210892179265203`*^9}, {3.72108928331094*^9, 3.721089284140175*^9}, {
   3.721089756015686*^9, 3.721089779622983*^9}, {3.721089817634056*^9, 
   3.721089819684889*^9}, {3.721089923168249*^9, 3.7210899494254103`*^9}, {
   3.721090121183275*^9, 3.7210901214316998`*^9}, {3.7210905806586113`*^9, 
   3.721090600212965*^9}, {3.722178724724524*^9, 3.7221787248165913`*^9}, {
   3.7221788391262693`*^9, 3.722178840436854*^9}, {3.722179051564919*^9, 
   3.722179068796442*^9}, {3.722179114253725*^9, 3.722179114332264*^9}, {
   3.722180415217308*^9, 3.722180421401774*^9}, 3.722180454938405*^9, {
   3.722180503885668*^9, 3.722180504780271*^9}, {3.722180686290868*^9, 
   3.722180698018962*^9}, {3.7222620924461727`*^9, 3.722262110512703*^9}, {
   3.722262215809609*^9, 3.722262216271294*^9}, {3.7222623340529757`*^9, 
   3.7222623344992943`*^9}, {3.722262467402169*^9, 3.7222624682133427`*^9}, 
   3.723904964887466*^9, {3.724681671670025*^9, 3.724681671968561*^9}, {
   3.724749632337097*^9, 3.724749660240486*^9}, {3.724749764547962*^9, 
   3.724749765012249*^9}, {3.724751698279698*^9, 3.724751712905531*^9}, {
   3.724751840881854*^9, 3.72475184600541*^9}, {3.724753025844709*^9, 
   3.724753031917201*^9}, {3.724753134957077*^9, 3.724753138110527*^9}, {
   3.724760970342145*^9, 3.724760971075461*^9}, {3.7247610761591167`*^9, 
   3.724761076231183*^9}, {3.724929740825219*^9, 3.724929742320548*^9}, {
   3.724929836164599*^9, 3.724929836590774*^9}, {3.724929929754785*^9, 
   3.724929932436027*^9}, {3.724929968049383*^9, 3.7249299706320353`*^9}, {
   3.725627837226083*^9, 3.725627841820395*^9}, {3.725627926060306*^9, 
   3.725627928011331*^9}, {3.725627992735043*^9, 3.7256280413421*^9}, {
   3.7256286682202883`*^9, 3.725628668410901*^9}, 3.7263252102033167`*^9, {
   3.726497218473094*^9, 3.72649730250568*^9}, {3.726498983467677*^9, 
   3.726498983627304*^9}, {3.726501833890522*^9, 3.726501834683069*^9}, 
   3.726620534521459*^9, {3.726665199142583*^9, 3.7266652280490303`*^9}, {
   3.728148043278668*^9, 3.7281480707353287`*^9}, {3.728241311838447*^9, 
   3.7282413128941107`*^9}, {3.728242583791995*^9, 
   3.728242592367032*^9}},ExpressionUUID->"fed17696-2e1c-4e34-a9c5-\
99d1d4315613"],

Cell["\<\
How can I always ensure the system is critically (or close to) damped for \
simulation?\
\>", "Text",
 CellChangeTimes->{{3.7247597382767344`*^9, 
  3.724759760772958*^9}},ExpressionUUID->"31a3cd5a-43c4-468d-952e-\
7b48de54102b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numofcycles", " ", "=", " ", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.725902643287157*^9, 3.725902648151464*^9}, {
  3.726620040016403*^9, 
  3.7266200406092997`*^9}},ExpressionUUID->"afbc2866-ba39-4204-bd06-\
a2fc202e6b47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"duration", " ", "=", " ", 
   FractionBox["numofcycles", "freq"]}], ";"}]], "Input",
 CellChangeTimes->{{3.7192532285960817`*^9, 3.719253230582872*^9}, {
  3.7259026543777313`*^9, 
  3.7259026634073563`*^9}},ExpressionUUID->"adf8328f-10c2-4c70-9e8a-\
eac7631a59a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solutionControl", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"odes", "/.", "dampingParams"}], "/.", "ellipseMasses"}],
             "/.", "fluidAndSpringParams"}], "/.", "robotParameters"}], "/.", 
          "shapeChange"}], "/.", 
         RowBox[{"D", "[", 
          RowBox[{"shapeChange", ",", "t"}], "]"}]}], "/.", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"shapeChange", ",", "t"}], "]"}], ",", "t"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "duration"}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<EquationSimplification\>\"", "\[Rule]", " ", "\"\<Residual\>\""}],
        "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQPcFdy33H1teO6X9P+IDooIjLISD6VujVUBC94UmV
/U4gLcBl4Aiig4r7S0B04A/bChD90+ZpH4iesCtoBohu0anoOQikjx2dBKa3
/3WJPQykk7sSwHRnoE0KiP53cgWYLmKNKADRfAf5i0B0lODhChCd2JNbC6Jf
WtxyPg6kF7wP9gTRooXM4SB69tOsSBB9QjHuC1i8PuAriH7l9PwPiC5y/Qmm
H/62XPEQSAv32oJpl1dx818C6fDofDA9oWXT4V2HXzueE5h/BETLlhh67gbS
U56VgGnH/9mtILppwnIwDQD+r7KS
  
  "],ExpressionUUID->"0b11ede0-2b8c-44cd-892b-422dfc5d365a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], ",", " ", 
        RowBox[{"y", "[", "t", "]"}], ",", " ", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}], " ", "/.", " ", 
      "solutionControl"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", " ", "0", ",", " ", "duration"}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.719154214144156*^9, 3.719154284946344*^9}, {
   3.719155069762321*^9, 3.719155072497171*^9}, 3.719170955281891*^9, {
   3.719184364625164*^9, 3.719184371612853*^9}, {3.719253247651205*^9, 
   3.719253248187573*^9}, 3.728148709907085*^9, 3.7282414166882973`*^9, 
   3.7320406652736197`*^9},ExpressionUUID->"1e183ae4-3e92-4510-851a-\
c19023cb46b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movieFrame", "[", "time_", "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "body", ",", "head", ",", "tail", ",", "tailPivotLine1", ",", 
           "tailPivotDot", ",", "tailPivotLine2", ",", "headPivotDot", ",", 
           "headPivotLine1", ",", "headPivotLine2"}], "}"}], "/.", 
         "robotParameters"}], "/.", "shapeChange"}], "/.", 
       "solutionControl"}], "/.", 
      RowBox[{"t", "\[Rule]", " ", "time"}]}], ",", 
     RowBox[{
      RowBox[{"PlotRange", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
              "2"}], ")"}]}], " ", ",", " ", 
           RowBox[{
            RowBox[{"6", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
            "2"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
              "2"}], ")"}]}], " ", ",", " ", 
           RowBox[{
            RowBox[{"6", " ", "b"}], " ", "+", " ", "gap", " ", "+", " ", 
            "2"}]}], "}"}]}], "}"}]}], " ", "/.", " ", "robotParameters"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719150903160173*^9, 3.7191510131601048`*^9}, {
  3.7191828271371727`*^9, 3.719182827781157*^9}, {3.719183963400749*^9, 
  3.719183993546331*^9}, {3.719324952013503*^9, 3.719324953253909*^9}, {
  3.72108949828334*^9, 3.7210895159116087`*^9}, {3.7210900247740297`*^9, 
  3.721090035016567*^9}, {3.722178813414523*^9, 
  3.7221788154923887`*^9}},ExpressionUUID->"8532347b-1b17-4253-9dcc-\
bb679222a7f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numberOfFrames", " ", "=", " ", "300"}], ";"}]], "Input",
 CellChangeTimes->{{3.719151019680471*^9, 3.719151025397862*^9}, 
   3.719151056118771*^9},ExpressionUUID->"df38a4a2-882b-472f-8c32-\
975c92b9e0fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieFrames", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"movieFrame", "[", "k", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "duration", ",", 
       FractionBox["duration", "numberOfFrames"]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.719151027664564*^9, 3.7191510617645273`*^9}, {
  3.7191510956371727`*^9, 
  3.719151099842898*^9}},ExpressionUUID->"99882efe-f1dd-444c-b3ce-\
c05108082101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListAnimate", "[", "movieFrames", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.719151105740284*^9, 3.719151111507498*^9}, 
   3.719182808466977*^9, {3.719183079024004*^9, 3.719183081271974*^9}, 
   3.719186725648326*^9, 3.719197757051524*^9, 3.722788798485487*^9, {
   3.723904503612796*^9, 3.723904527745037*^9}, 3.7239048807660303`*^9, 
   3.724376117084903*^9, 3.724693279899246*^9, 3.728148686660961*^9, 
   3.7282412434819403`*^9, 
   3.728314937487113*^9},ExpressionUUID->"ded927f4-c997-468d-802a-\
47c0563e8579"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FL", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"D", "[", 
      RowBox[{"L", ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7238542152733097`*^9, 
  3.723854264933135*^9}},ExpressionUUID->"0eea9e28-8b1d-47b1-bb1f-\
3e3fba44ebba"],

Cell[TextData[{
 "We define the momentum map by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"<", 
     RowBox[{"J", "(", 
      SubscriptBox["v", "q"], ")"}]}], ",", 
    RowBox[{"\[Eta]", ">", " ", 
     RowBox[{"which", " ", "equals"}], " ", "<", 
     RowBox[{"FL", "(", 
      SubscriptBox["v", "q"], ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Eta]", "Q"], "(", "q", ")"}], ">"}]}], 
   TraditionalForm]],ExpressionUUID->"67fe9bf1-ad56-4601-861e-dc2e1f4684d4"]
}], "Text",
 CellChangeTimes->{{3.723855716594654*^9, 3.7238558323198442`*^9}, {
  3.723905479294417*^9, 3.7239054863468027`*^9}, {3.7239165181703997`*^9, 
  3.723916533242518*^9}},ExpressionUUID->"ebc76714-32a7-4a5f-a2f9-\
a3ade5a50a42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"J1", " ", "=", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"FL", ".", "\[Zeta]Q"}], "\[Zeta]1"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}]}], "}"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.723855845322154*^9, 3.7238558677310534`*^9}, {
  3.7238559108361807`*^9, 
  3.7238559947069397`*^9}},ExpressionUUID->"aff69efc-c77d-407f-a7d6-\
b11b4ac47054"],

Cell[BoxData[
 RowBox[{
  RowBox[{"J2", " ", "=", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"FL", ".", "\[Zeta]Q"}], "\[Zeta]2"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}]}], "}"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7238559983066196`*^9, 3.7238560367780533`*^9}, {
  3.731702545917457*^9, 
  3.731702547363813*^9}},ExpressionUUID->"af3e1f2a-51a9-4189-8c54-\
4200afe888f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"J3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"FL", ".", "\[Zeta]Q"}], "\[Zeta]3"], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
       RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723856038036436*^9, 3.723856065523519*^9}, {
  3.7317025763133497`*^9, 
  3.7317025785563393`*^9}},ExpressionUUID->"442a3479-1e2f-499f-8399-\
bc23dbd9338c"],

Cell["\<\
Everything so far is commensurate with Scott\[CloseCurlyQuote]s analysis of a \
similar 3-link swimmer. Let\[CloseCurlyQuote]s get to the good stuff. We \
will, as per Scott\[CloseCurlyQuote]s analysis, need the locked inertia \
tensor, the connection form, and the local connection form.\
\>", "Text",
 CellChangeTimes->{{3.723917050763983*^9, 3.723917121792287*^9}, {
  3.723982047582286*^9, 3.7239820583706503`*^9}, {3.723982316321804*^9, 
  3.7239823320583057`*^9}},ExpressionUUID->"da6b2ce2-7029-4bd2-87a7-\
992097dd20bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rightpairing", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[Lambda]Q", ".", "FL"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
       RowBox[{"\[Zeta]Q", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723984525918538*^9, 
  3.7239846089572687`*^9}},ExpressionUUID->"679b727a-34ae-477e-b349-\
32bdcdbbfe8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lockedInertiaTensor", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]1", " ", "\[Lambda]1"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]2", " ", "\[Lambda]1"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]3", " ", "\[Lambda]1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]1", " ", "\[Lambda]2"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]2", " ", "\[Lambda]2"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]3", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]3", " ", "\[Lambda]2"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]1", " ", "\[Lambda]3"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]3", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]2", " ", "\[Lambda]3"}]], ",", 
        FractionBox[
         RowBox[{"rightpairing", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Zeta]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Zeta]2", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]1", "\[Rule]", " ", "0"}], ",", 
            RowBox[{"\[Lambda]2", "\[Rule]", " ", "0"}]}], "}"}]}], 
         RowBox[{"\[Zeta]3", " ", "\[Lambda]3"}]]}], "}"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7239846136379833`*^9, 3.723984623881216*^9}, {
  3.723984716458552*^9, 3.723985034786542*^9}, {3.7239850659556513`*^9, 
  3.72398512645441*^9}, {3.723985196560464*^9, 3.7239852195819893`*^9}, {
  3.731776077325582*^9, 
  3.73177608740467*^9}},ExpressionUUID->"97d19866-0964-4440-b794-\
afa384e00bc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalGamma]", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "lockedInertiaTensor", "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"J1", ",", "J2", ",", "J3"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723985228371304*^9, 3.723985239029908*^9}, {
  3.723985314836556*^9, 3.723985332774108*^9}, {3.7317682152272673`*^9, 
  3.7317682162418613`*^9}},ExpressionUUID->"8cc8546c-f7c2-48c1-bcce-\
d034caa79bd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Adg", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", 
       RowBox[{"y", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"x", "[", "t", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723987209851028*^9, 3.7239872110870457`*^9}, {
  3.7239885977073812`*^9, 
  3.7239886523644533`*^9}},ExpressionUUID->"8d009a33-4ad2-429b-85c2-\
ea5f325a119b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"localLIT", " ", "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "Adg", "]"}], ".", "lockedInertiaTensor", ".", 
    "Adg"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.723988656459087*^9, 
  3.723988682178249*^9}},ExpressionUUID->"461436ab-766f-47d4-a7f6-\
f9d1057cfdf8"],

Cell["\<\
The following verification checks out when the joint angles are zero. Huzzah!\
\
\>", "Text",
 CellChangeTimes->{{3.723988787557687*^9, 
  3.723988813877265*^9}},ExpressionUUID->"c81a9eb3-da0c-4807-adff-\
4fa1379f4e94"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"localLIT", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
      "}"}]}], "//", "Simplify"}], "//", "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.7239887099338703`*^9, 3.723988742501141*^9}, 
   3.731867687527285*^9},ExpressionUUID->"8b1eddb3-732e-4ef4-a61d-\
b381d6f83b25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SE2BV", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], " ", "-", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724022018652658*^9, 
  3.7240220708012342`*^9}},ExpressionUUID->"c51ed6d2-1fab-45ed-a2b2-\
7fa779b1794f"],

Cell[TextData[{
 "A mechanical connection is given by \[CapitalGamma]=A(r) rdot + ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["g", 
     RowBox[{"-", "1"}]], "gdot"}], TraditionalForm]],ExpressionUUID->
  "a16d2e00-7ebc-4b60-b0e1-3e799da341ba"],
 "=A(r) rdot + SE2BV"
}], "Text",
 CellChangeTimes->{{3.724022690734201*^9, 
  3.724022808865158*^9}},ExpressionUUID->"6b6f4764-a9bb-47b4-af72-\
59abc1b8ae35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"x", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ",", " ", 
       RowBox[{"y", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724022814372036*^9, 3.724022856089695*^9}, {
  3.724022899054438*^9, 
  3.724022907919812*^9}},ExpressionUUID->"35d361be-a101-46d0-a6f2-\
9d0d3f706dd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "g", "]"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"g", ",", "t"}], "]"}]}], "//", "FullSimplify"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.724022860563093*^9, 3.724022879551888*^9}, {
   3.724022930128436*^9, 3.724022962093515*^9}, {3.724023063888568*^9, 
   3.7240230644406843`*^9}, {3.72791855088173*^9, 3.7279185534419413`*^9}, 
   3.731867684506136*^9},ExpressionUUID->"0915ccc1-3ab8-4d52-a18e-\
c953d139b468"],

Cell["\<\
Okay, great. Just wanted to check my understanding of how we represent the \
body velocity. I now recall that we represent the above matrix as a 3x1 \
vector.\
\>", "Text",
 CellChangeTimes->{{3.724023156553172*^9, 3.724023180254148*^9}, {
  3.724089794766246*^9, 
  3.724089815802911*^9}},ExpressionUUID->"ed381682-c4f6-49d8-8019-\
31f163ea7e29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "Adg", "]"}], ".", "\[CapitalGamma]"}], " ", "-",
     " ", "SE2BV"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7240232034878273`*^9, 3.724023241958338*^9}, {
  3.7240233359531*^9, 
  3.724023336417205*^9}},ExpressionUUID->"f8c41aaa-919e-402b-9e8f-\
115a5818d392"],

Cell["\<\
Much like Scott\[CloseCurlyQuote]s approach to finding the local connection \
form, I will not wait for Mathematica to simplify A. How can I exploit what I \
know A should look like so as to require less from Mathematica \
computationally?\
\>", "Text",
 CellChangeTimes->{{3.724520061521446*^9, 3.7245201587681026`*^9}, {
  3.724520976805497*^9, 3.724521002468075*^9}, {3.728222134246348*^9, 
  3.728222202901018*^9}},ExpressionUUID->"32c3bdf9-9800-499f-815a-\
638b655143c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trickA", "=", 
   RowBox[{"\[CapitalGamma]", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731762926420959*^9, 3.731762931507889*^9}, {
  3.731762963966353*^9, 
  3.731763012783085*^9}},ExpressionUUID->"f2de355c-6485-403a-8fb1-\
6339dfbe38bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ax\[Phi]", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
     "}"}]}]}], ";"}]], "Input",ExpressionUUID->"28c1e52a-562e-4ac8-bd19-\
a309ae723108"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ax\[Theta]1", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731762908220282*^9, 3.731762921484962*^9}, {
  3.731767961899249*^9, 3.731767981921259*^9}, {3.7317680361177683`*^9, 
  3.731768039891116*^9}},ExpressionUUID->"ee1e54ff-16ba-47d5-8041-\
6fae9114f20e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ay\[Phi]", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731768004620933*^9, 
  3.731768022758128*^9}},ExpressionUUID->"927439a2-deaa-4a03-8a73-\
f0015a0e806d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ay\[Theta]1", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731768027917622*^9, 
  3.731768052565219*^9}},ExpressionUUID->"39be680e-e4cf-4129-82e5-\
3ad3920308f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A\[Theta]\[Phi]", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731768083102728*^9, 
  3.731768108966717*^9}},ExpressionUUID->"c046c7d7-cb3a-4672-8303-\
c8be940947d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A\[Theta]\[Theta]1", "=", 
   RowBox[{
    RowBox[{"trickA", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", "0"}], ",", 
      
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", "1"}]}], 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731767985265614*^9, 3.731767986481103*^9}, {
  3.731768255690613*^9, 
  3.731768272077602*^9}},ExpressionUUID->"765fa55c-db82-42f0-a90b-\
34c0feec0c98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fiberODE", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"SE2BV", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"trickA", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"SE2BV", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"trickA", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"SE2BV", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"trickA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7317686637609673`*^9, 
  3.731768730387073*^9}},ExpressionUUID->"ba025625-a3a7-49d4-8425-\
db2e419b7b3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Q-learning for Varying Stiffness and Head Speed", "Chapter",
 CellFrame->{{0, 0}, {2, 0}},
 CellChangeTimes->{{3.728238232077935*^9, 3.728238249803187*^9}, {
  3.731162100604533*^9, 
  3.731162115688817*^9}},ExpressionUUID->"3d018a3e-e30a-41a0-9279-\
b7b116a3ca5a"],

Cell["\<\
We want to determine the optimal way to vary the stiffness of a spring in the \
three-link swimmer over some specified number of cycles. This seems like a \
good starting point. We can then add the amplitude variation after \
successfully optimizing the spring stiffness.\
\>", "Text",
 CellChangeTimes->{{3.728238913850534*^9, 3.7282389530359507`*^9}, {
   3.728239133762086*^9, 3.728239178850523*^9}, 3.72823995467794*^9, {
   3.728240016743865*^9, 3.728240035720553*^9}, {3.728314510865096*^9, 
   3.7283145190882807`*^9}},ExpressionUUID->"e3aa5790-f262-4af7-8c5b-\
d9de1a208878"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PEtailk", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "2"], " ", "k1", " ", 
    SuperscriptBox[
     RowBox[{"\[Theta]1", "[", "t", "]"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7282411114148283`*^9, 3.728241111590726*^9}, {
  3.728241186201686*^9, 3.728241187353037*^9}, {3.729533586792864*^9, 
  3.729533590087604*^9}, {3.729710816866212*^9, 
  3.729710817640074*^9}},ExpressionUUID->"efe353e8-c9db-4fbb-b83e-\
498866e3a0fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Lk", " ", "=", " ", 
   RowBox[{"KEbody", "+", "KEhead", "+", "KEtail", "-", "PEtailk"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.728241192056383*^9, 
  3.728241610151043*^9},ExpressionUUID->"0ab2e938-1d24-4b8a-907f-\
84cf6f661af6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xodek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"x", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
     "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190207199647093`*^9, 3.719020722374579*^9}, {
   3.719021483694234*^9, 3.719021494041192*^9}, {3.7190215528600407`*^9, 
   3.7190215615404463`*^9}, {3.719021602310233*^9, 3.7190216177353992`*^9}, {
   3.719174022102764*^9, 3.7191740255918818`*^9}, 3.719174411460841*^9, {
   3.7191977949214277`*^9, 3.719197796693228*^9}, {3.7191978498375807`*^9, 
   3.719197851412695*^9}, {3.721089635242494*^9, 3.721089639349965*^9}, {
   3.721089704523946*^9, 3.721089706937447*^9}, {3.721090527192341*^9, 
   3.721090535023093*^9}, {3.7210905736428328`*^9, 3.721090574090988*^9}, 
   3.721513041765123*^9, 3.721584225312303*^9, 3.725389001998167*^9, 
   3.725389038545429*^9, 3.728241193385578*^9, {3.7282413924316*^9, 
   3.728241393710966*^9}},ExpressionUUID->"6c3a9fc3-fe03-4653-bba5-\
c18a4df5085d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"yodek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"y", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
     "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190216212427883`*^9, 3.719021638342125*^9}, {
   3.719174010727219*^9, 3.719174018918293*^9}, {3.7191744220852013`*^9, 
   3.719174423492921*^9}, {3.719197802169883*^9, 3.719197804215314*^9}, {
   3.71919785373524*^9, 3.719197853923852*^9}, {3.721089645902275*^9, 
   3.721089648247664*^9}, 3.721089709284676*^9, {3.721090540542625*^9, 
   3.72109054373046*^9}, 3.721090576688198*^9, 3.7282411946985693`*^9, {
   3.728241395263239*^9, 
   3.728241396704973*^9}},ExpressionUUID->"c306cd95-f1bb-4637-9ade-\
a248c898e815"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]odek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7190216405092382`*^9, 3.719021661912898*^9}, {
   3.719174000292056*^9, 3.719174007687325*^9}, 3.719174427717031*^9, {
   3.719197807528124*^9, 3.7191978117521772`*^9}, {3.719199690309474*^9, 
   3.719199691593696*^9}, {3.721089652236102*^9, 3.721089686692568*^9}, 
   3.728241195994112*^9, {3.7282413982712812`*^9, 
   3.728241399647963*^9}},ExpressionUUID->"2fd8bfa9-0dba-4e7f-8b13-\
1ad56be0244e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]1odek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}]}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"-", "c1"}], " ", 
     RowBox[{
      RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719021690060938*^9, 3.719021738109384*^9}, {
   3.719022313427668*^9, 3.7190223380219717`*^9}, {3.719084814279318*^9, 
   3.719084824009861*^9}, {3.7192358286863213`*^9, 3.7192358294681883`*^9}, 
   3.7192359146249723`*^9, 3.724759589906724*^9, 3.725388983872902*^9, 
   3.72662053843545*^9, 3.728241197050728*^9, {3.728241400975713*^9, 
   3.728241402368166*^9}},ExpressionUUID->"0ad87fa4-0a36-4d74-b620-\
1dabf8302ead"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]odek", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Lk", ",", 
         RowBox[{
          RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
      "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{"Lk", ",", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.729129346101903*^9, 3.729129356400942*^9}, {
  3.7295331431791058`*^9, 
  3.729533156938293*^9}},ExpressionUUID->"c2f7648e-ad96-4d7e-aa9d-\
3a72bab9c540"],

Cell[BoxData[
 RowBox[{
  RowBox[{"odesk", " ", "=", 
   RowBox[{"{", 
    RowBox[{
    "xodek", ",", "yodek", ",", "\[Theta]odek", ",", "\[Theta]1odek"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7190217436075163`*^9, 3.719021760357444*^9}, {
   3.7190821432677927`*^9, 3.719082165268042*^9}, 3.719182769189693*^9, {
   3.728241199385078*^9, 3.728241204793434*^9}, {3.729081598729553*^9, 
   3.729081603509693*^9}, {3.729129073976609*^9, 3.729129074950397*^9}, {
   3.7291293609957943`*^9, 3.7291293634766617`*^9}, {3.729346166632288*^9, 
   3.729346166904277*^9}, {3.729346745244274*^9, 3.729346748792362*^9}, 
   3.7309072076755533`*^9, {3.730907682679954*^9, 3.730907684406332*^9}, {
   3.7310639102923822`*^9, 
   3.7310639104312*^9}},ExpressionUUID->"851b3600-42a0-4941-b254-\
3ddc733db90f"],

Cell[TextData[{
 "PSEUDOCODE\n\n",
 StyleBox["Establish Q matrix, states, and actions.\nDefine terminal state\n",
  
  FontSlant->"Italic"],
 "\n",
 StyleBox["Start a loop:\n\tInitialize state\n\tStart another loop:\n\t\t\
Choose the action based on the policy\n\t\tTake action, observe reward and \
next state\n\t\tUpdate Q function\n\t\tUpdate state\n\tuntil S is terminal",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.728312075130899*^9, 3.728312114272393*^9}, {
   3.728312149185536*^9, 3.72831220387523*^9}, 3.728312384970686*^9, {
   3.728312426092157*^9, 3.7283124650028667`*^9}, 3.72831272814659*^9, {
   3.7283128795436687`*^9, 3.7283128881995*^9}, {3.72831294325867*^9, 
   3.728313128634997*^9}, {3.728313168636168*^9, 3.7283131763636208`*^9}, {
   3.728313522057901*^9, 3.7283136190171022`*^9}, 3.7283137285744343`*^9, {
   3.728313805904724*^9, 3.7283138379043283`*^9}, {3.731160992612631*^9, 
   3.731160993002286*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"f211e56f-6570-48c5-9297-3914db59ee34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rlmodel", "=", 
   GraphicsBox[
    TagBox[RasterBox[CompressedData["
1:eJztnelzVNeZxjseV3mSqlQWlysfnKRwkgEmiafGZY9lMh5nbIWK7QCmHCMS
iA1RjBmMjdkcMJudCNkgNBCzSmY1YBZJICQhJCSBhFYaRQIJJIHnQ/6EfMrn
d/q2ejn33NuiW+q3z3uunl/VY4u+y3lvn0fn0blL92OF77361gOhUGjNP0f+
8+rv1z2/evXvP/j1NyP/mLdizbKlK5a8+dKKtUuWLln9TOE/RV78W0SffiUU
ejAEAAAAAJAWBEE5EgAgeJgeV6DJIwBA8DA9rkCTRwCA4GF6XIEmjwAAwcP1
ez48NARBWZHuLYMeBwDwgQyBWKR7y6DHAQB8IEMgFuneMuhxAAAfyBCIRbq3
DHocAMAHMgRike4tgx4HAPCBDIFYpHvLoMcBAHwgQyAW6d4y6HEAAB/IEIhF
urcMehwAwAcyBGKR7i2DHgcA8IEMgVike8ugxwEAfCBDIBbp3jLocQAAH8gQ
iEW6twx6HADABzIEYpHuLYMeBwDwgQyBWKR7y6DHAQB8IEMgFuneMuhxAAAf
yBCIRbq3DHocAMAHMgRike4tgx4HAPCBDIFYpHvLoMcBAOOjNKLv3GcdZAjE
It1brE4HAHDg/N7+IzR2liBDIBbp3sqB3wEA2UX9/U2VJcgQiEW6t3LmegBA
tvD7PdazBBkCscjHewBMFD9fQWYUzxJkCMQiH88BMFFMj5sQMgTKkXw8B8BE
gZdyy1jZgXNZEKt8vAfARIGXcstY2eG3jvFxBwqOdG/lzPUgyMBLuWWs7FDX
QYZAWZfurRz4HQQfeCm34BlDyJh0b7E6HUwW4CV5IEMgFuneMuhxEBzgJXkg
QyAW6d4y6HEQHOAleSBDIBbp3jLocRAc4CV5IEMgFuneMuhxEBzgJXkgQyAW
6d4y6HEQHOAleSBDIBbp3jLocRAc4CV5IEMgFuneMuhxEBzgJXkgQzJWH7VV
HKDNyzfQqc47AuqRKd1bBj0OggO8JA8LM6SPji/7GT2Wl0+zZ82ngoKChGbP
mhVVQcEiWvLOWira9RnVtPZmpd27/VfoyNZl9KzyfhWevSHg/ZAp3VvGHA6C
BLwkDwszZIj6Oq5Sc2QusEir/8kXZtNrb8xzjfOOnttwim5PsM07l7ZTfmT/
L/4oud/l55AhyBCQQ+AleViZIXHdPLY8UftPN1Yry8JUsfkV17HlfVKX9TZz
kSEnF3zbyvmO7i0T5gaBA16Sh9UZMnB+fYoMGdXZwh8rxzeXztwczmqb3Bny
ZXs5/cTS+Y7uLSPuBkEDXpJHoDNkSFkeCs2ko70jWW2Td2zvop0vjraz+lyf
8fc6U+neMmFuEDjgJXkEO0Nqt6SdIb1N5+jQrr1UfqScSotL6Fh1i+81FLXN
lTUD5Jw3qz68J7JNMe0o2UdVbbfGrDm9dq7RnoWPJNpZdPASXe/poNaOnglf
10GGAIuBl+QR6AypWvmMcnyFVHPbey7rXvgCbXj5e35jHoXy11F173CKNqfT
mn176d0nvdst3FE77nZGBqtpnt86MZVlYS6FDAGWAi/JIzAZMv1P6jXzQard
uch1bPP3t/rs4wpt/v7o8h+8VUZdw6OvXy1715U9Z5UcGXCdHxvVY3lPe157
/Vj7ONsZpButrdR6/tPE/WXz99dSV2sTtTR3Ur+A9x0ZAgwBL8kjMBkybdE2
Ol15mg6UrKNf/9B9XL/9i3de4Kj+j08nxm99jtJY9HxyH0tPpMiQQjrUNvr8
yb1wPW38udruKmoeHn87d/srE/ORlTW4HgJACF6SSGAyxFdLj1D3oP+26jmj
hzZWepbfC5+ml32upahtFp7t1/ZZ6XpmpbhxYNzt3O0/ndguIPdlQfJkG7bW
HWRcnjI97kwkQx5+/wI554EOF34zeUx56+jSsP+2d5t2Re+bddbzu5bi7OvI
wocT+4qP4/e7Lys55xhdPt52kCFQDmQbttYdZAKTIfHxeWTwIi1Vj2vFcf9t
K8a+Hu9IPc+UboYMVKxyLR9vOwHMECAHW/vE1rqDTOAyxNGdS1tdx/Xmye60
t1V1edMLGWfI0PkP3RkyznaQIYARW/vE1rqDTCAzxFHLttnKsc2k8usjKbcN
5W2hNp9zXsmxfUZi+/tlSOfu1xLb7OscGXc7aobgmjrIMrb2ia11B5nAZojz
7F/8Oe+o8osS99Q6cq51L1KOvbjRu/8Thd+ILX87cV3FnSH62N5H5a/G9jlt
ffS+rPG2o2ZIfmmD8fcaGRIobO0TW+sOMlZnyJDrmnqVZ/m98AnlnqeIlpa5
nq9w3VerZYy6rfqsh5ohv9POkQ0o57FWK3OU8bSjZsh3V5wezaeFj2vPnciV
7q1cmhrcF1v7xNa6g4ylGTJIAz31VPScWv9c2t0Y9nwWyM0vVrvHsjnv0cEL
LXSjf5CczxT55KXksq/O3071HdepveEovTcl9vriclfuuO8nnk5Ldhyjpo4e
ajy8MXH/VX6p/hnBmbfjZMjLnnF4Ou2z5HuvdG/lztIgDWztE1vrDjIWZohy
vshXCzyfz1u5Ls+7Xn4JhaPLu+jgqpk++5lOr3/8eWwdd361nfqYFj7l0/a0
V2h71bUUdWfazhA17X5dWW8GbTpjxxwEGSIeW/vE1rqDjIUZwqOBniaqqaym
luYGuljXQuEUzyaq6utoiqzbQFcaaqm2uTOtz0PMtJ07/d3UGZnn9KdRjyTp
3jLoceDF1j6xte4ggwyBWKR7y6DHgRdb+8TWuoMMMgRike4tgx4HXmztE1vr
DjLIEIhFurcMehx4sbVPbK3bVkoj+s591kGGQCzSvcXqdJAptvaJrXXbivNe
/yM0dpYgQyAW6d7Kgd9B+tjaJ7bWbSvq72+qLEGGQCzSvZUz14N0sLVPbK3b
Vvx+j/UsQYZALPLxHpCDrX0ivW4/3wdV8SxBhkAs8vEckIOtfSK9btPjOjIE
Cox8PAfkYGufSK9ben2ZMlZ24FwWxCof7wE52Non0uuWXl+mjJUdfusYH3eg
4Ej3Vs5cD9LB1j6RXrf0+jJlrOxQ10GGQFmX7q0c+B2kj619Ir1u6fVlCp4x
hIxJ9xar00Gm2Non0uuWXh8HyBCIRbq3DHoceLG1T6TXLb0+DpAhEIt0bxn0
OPBia59Ir1t6fRwgQyAW6d4y6HHgxdY+kV639Po4QIZALNK9ZdDjwIutfSK9
bun1cYAMgVike8ugx4EXW/tEet3S6+MAGQKxSPeWQY8DL7b2ifS6pdfHATIE
YpHuLYMeB15s7RPpdUuvjwNkCMQi3VsGPQ682Non0uuWXh8HyBCIRbq3DHoc
eLG1T6TXLb0+DpAhEIt0bxn0OPBia59Ir1t6fRwgQyAW6d4y6HHgxdY+kV63
9Po4QIZALNK9ZdDjwIutfSK9bun1cYAMgVike8ugx4EXW/tEet3S6+MAGQKx
SPeWQY8DL7b2ifS6pdfHATIEYpHuLYMeB15s7RPpdUuvjwNkCMQi3VsGPQ68
2Non0uuWXh8HyBCIRbq3DHoceLG1T6TXLb0+DpAhEIt0bxn0OPBia59Ir1t6
fRwgQyAW6d4y6HHgxdY+kV639Po4QIZALNK9ZdDjwIutfSK9bun1cYAMgVik
e8ugx4EXW/tEet3S6+MAGQKxSPeWQY8DL7b2ifS6pdfHATIEYpHuLYMeB15s
7RPpdUuvjwO/33UI4hCQg619Ir1u6fVxYHpcgSaPgBxs7RPpdUuvjwPT4wo0
eQTkYGufSK9ben0cmB5XoMkjIAdb+0R63dLrAwCAbGDrWCe9bun1AQBANrB1
rJNet/T6AAAgG9g61kmvW3p9AACQDWwd66TXLb0+AADIBraOddLrll4fAABk
A1vHOul1S68PAACywUTGuqciuqXsY2pED0Q0JaKvZKO4MZA+RkuvDwAAssF4
x7prse2cDHkkoveVfcXzhBPpY7T0+gAAIBuMZ6z7WyiZHyp1yv6mKK8/qGzj
rPOt2OuPhpLzGGf54gxqyPUY/YuI/q60+/591keGAAAmA5mOdeXKNg9oy55N
scwZe515y+Mh9xjs/L80ogLl9a8x1T0R4tn4UURfD43OseJ5mApkCABgMpDJ
WPc1Zf0Cn+UfhZJzijiPhtzZoJ7vejb2mjp/+VYoPXI1Rs+OtTNbee2BNNpH
hgAAJgOZjHUfKes/5LM8fq5HPc/j/Bw/5/WIsn1piv2mey0+V2N0PN/U412c
RvvIEADAZCCTsS5+Hf3vPsseUvY1RXndGYPjf8Or56we1LbXz4vdj1yN0fHr
NadCo+exHJxaPwqNfd8AMgQAMBnIZKxTx1Md9VqHmg/q3+/qvVwTJdcZoqo8
je2QIQCAycB4MuRtn2WlIfe1EOe6xjVl+VeUtvy2z5RcjdHfCnkzJJ22kSEA
gMnAeDJkyhj7+Sj278Uh9zmvR5V1Hs28zJTt5QIn/5znKeM56XfOTgcZAgCY
DIwnQx7XXlfH1inKftX5hvoMYjaeYeceo6eERo+3VHvdqf1vIWQIAAA4ZDLW
xZ//iJ+vcsZT9XkRR1NDyecnvq5sGx93s3EtJBTiH6Pj9fpl3keh+9+HjAwB
AEwGMh3rnPNQz2p6ICb1tUeUbR5U2lk84YpH4R6j43Muv+vnuB4CAACj5GKs
m6K088jYq6YNd93xe8jU5+adn+PPwOjn83SQIQCAyUAuxjrnnNb7oft/xlQm
5KJu53mW9zU513j8nq/UQYYAACYDto510uuWXh8AAGQDW8c66XVLr4+DVM/R
QFC2BeRga59Ir1t6fRyYHlegySMgB1v7RHrd0uvjwPS4Ak0eATnY2ifS65Ze
HwemxxVo8gjIwdY+kV639Po4cP2eDw8NQVBWpHvLoMeBF1v7RHrd0uvjABkC
sUj3lkGPAy+29on0uqXXxwEyBGKR7i2DHgdebO0T6XVLr48DZAjEIt1bBj0O
vNjaJ9Lrll4fB8gQiEW6twx6HHixtU+k1y29Pg6QIRCLdG8Z9DjwYmufSK9b
en0cIEMgFuneMuhx4MXWPpFet/T6OECGQCzSvWXQ48CLrX0ivW7p9XGADIFY
pHvLoMeBF1v7RHrd0uvjABkCsUj3lkGPAy+29on0uqXXxwEyBGKR7i2DHgde
bO0T6XVLr48DZAjEIt1bBj0OvNjaJ9Lrll4fB8gQiEW6twx6HHixtU+k1y29
Pg6QIRCLdG8Z9DjwYmufSK9ben0cIEMgFuneMuhx4MXWPpFet/T6OECGQCzS
vWXQ48CLrX0ivW7p9XGADIFYpHvLoMeBF1v7RHrd0uvjABkCsUj3lkGPAy+2
9on0uqXXxwEyBGKR7i2DHgdebO0T6XVLr48DZAjEIt1bBj0OvNjaJ9Lrll4f
B8iQjNVHbRUHaPPyDXSq846AemRK95ZBjwMvtvaJ9Lql18eBhRnSR8eX/Ywe
y8un2bPmU0FBQUKzZ82KqqBgES15Zy0V7fqMalp7s9Lu3f4rdGTrMnpWeb8K
z94Q8H7IlO4tYw4HftjaJ9Lrll4fBxZmyBD1dVyl5shcYJFW/5MvzKbX3pjn
GucdPbfhFN2eYJt3Lm2n/Mj+X/xRcr/LzyFDkCFWYmufSK9ben0cWJkhcd08
tjxR+083VivLwlSx+RXXseV9Upf1NnORIScXfNvK+Y7uLRPmBimxtU+k1y29
Pg6szpCB8+tTZMiozhb+WDm+uXTm5nBW2+TOkC/by+knls53dG8ZcTdIha19
Ir1u6fVxEOgMGVKWh0Iz6WjvSFbb5B3bu2jni6PtrD7XZ/y9zlS6t0yYG6TE
1j6RXref7yeVTI87ExnPfTOkdkvaGdLbdI4O7dpL5UfKqbS4hI5Vt/heQ1Hb
XFkzQM55s+rDeyLbFNOOkn1U1XZrzJrTa+ca7Vn4SKKdRQcv0fWeDmrt6Jnw
dR1kCAjZ2yfS6zY+hpuW6XEn2xlStfIZ5fgKqea291zWvfAF2vDy9/zfk/x1
VN07nKLN6bRm315690nvdgt31I67nZHBapo3Rh+VZWEuhQyZ9NjaJ7bWHWQC
kyHT/6ReMx+k2p2LXMc2f3+rzz6u0Obvjy7/wVtl1DU8+vrVsndd2XNWyZEB
1/mxUT2W97TntdePtY+znUG60dpKrec/TdxfNn9/LXW1NlFLcyf1C3jfkSHW
Y2uf2Fp3kAlMhkxbtI1OV56mAyXr6Nc/dB/Xb//inRc4qv/j04nxW5+jNBY9
n9zH0hMpMqSQDrWNPn9yL1xPG3+utruKmofH387d/srEfGRlDa6HgKxia5/Y
WneQCUyG+GrpEeoe9N9WPWf00MZKz/J74dP0cmJfyWspapuFZ/u1fVa6nlkp
bhwYdzt3+08ntsN9WSDL2NonttYdZAKTIQ+/f4Gc80CHC7+ZPKa8dXRp2H/b
u027ovfNOuv5XUtx9nVk4cOJfcXH8fvdl5Wcc4wuH287yBDAiK19YmvdQSYw
GRIfn0cGL9JS9bhWHPfftmLs6/GO1PNM6WbIQMUq1/LxtoMMAYzY2ie21h1k
Apchju5c2uo6rjdPdqe9rarLm17IOEOGzn/ozpBxtoMMAYzY2ie21h1kApkh
jlq2zVaObSaVXx9JuW0obwu1+ZzzSo7tMxLb3y9DOne/lthmX+fIuNtRMwTX
1EGWsbVPbK07yAQ2Q5xn/+LPeUeVX5S4p9aRc617kXLsxY3e/Z8o/EZs+duJ
6yruDNHH9j4qfzW2z2nro/dljbcdNUPySxuMv9fIkEBha5/YWneQsTpDhlzX
1Ks8y++FTyj3PEW0tMz1fIXrvlotY9Rt1Wc91Az5nXaObEA5j7VamaOMpx01
Q7674vRoPi18XHvuRK50b+XS1OC+2NonttYdZCzNkEEa6KmnoufU+ufS7saw
57NAbn6x2j2WzXmPDl5ooRv9g+R8psgnLyWXfXX+dqrvuE7tDUfpvSmx1xeX
u3LHfT/xdFqy4xg1dfRQ4+GNifuv8kv1zwjOvB0nQ172jMPTaZ8l33uleyt3
lgZpYGuf2Fp3kLEwQ5TzRb5a4Pl83sp1ed718ksoHF3eRQdXzfTZz3R6/ePP
Y+u486vt1Me08Cmftqe9QturrqWoO9N2hqhp9+vKejNo0xk75iDIEPHY2ie2
1h1kLMwQHg30NFFNZTW1NDfQxboWCqd4NlFVX0dTZN0GutJQS7XNnWl9HmKm
7dzp76bOyDynP416JEn3lkGPAy+29omtdQcZZAjEIt1bY3jwOxGVsjsdqNg6
Fttad5BBhkAs0r3l4714dvwjxXLAh61jsa11BxlkCMQi3VuK5/TswLiQe2x9
z22tO8ggQyAW6d4Kpc4OjAu5x9b33Na6gwwyBGKR7q1Q6uyAzMk2bK07yCBD
IBbp3gohQyTKNmytO8ggQyAW6d4K4VwWmDjwijyQIRCLdG8pnsM1dTBe4BV5
IEMgFune8vEe7u0FmYIMkQcyBGKR7q0xPIhnDEG6IEPkgQwRqz6q2rONdpSU
0OGWvwqoJzPp3jLocRAc4CV5MGdIHx1f9jN6LC+fZs+aTwUFBQn9ZtasyGuz
6FeRn9944y1as2YDlez6jCrq2lyfXztZNVS7Jdk3eVt9P5NRsnRvGXM4CBLw
kjzY5yF9HVepueKA63uYopr2TCw/5tGMf9HHmxm0Zt8l4+OgSd1t2p58P/J3
WZerurcMeBsED3hJHjk7l3Xz2PJEO0+srfQsv157jN590l3PE2tPGR8LzWmQ
Wk4doB0l+6j6+m0B9WQm3Vtm7A0CBrwkj5xlyNjfWxtXH53WvmPjV/ubjY+H
UObSvWXG3iBgwEvyEJYhjgbpyMKHlbpm0rHrI8bHRCgz6d4y5G8QLOAleQjM
kCH6sr088b2yjp4sbYh+F1Nbayt1dnTE1Br5d4frO5yGbiTXcf7fE/2+W2dZ
HzWc2k1bS07Grk2Hqe7zMiotLqbte4/S1RvDvnXc7W+n6sN7outtLSmhneVH
qaa11//4eurp8PattPdiOPrvwfZ6+nzvdiouLqHdJ+pd1zP6W8/RoV2jy8qO
16e+1tF9ObrPfRe6UtR3hSqOJOsrO34hxbX3cPQ4iiPrlezaR1/UtUTPk+2v
8t8vMgQIBV6Sh8gMcXRm2b8q15RL6Pzm//AZl6ZTceNAYpsrRf/tWv7TDz6j
8i3L6NnEa3PpUNVhWurZz1w62eue61wte9d1/V9dP++TeP2D1FZxgFbNeyKx
bPqfKuly2RJvrflF0fH9wuZXvMvm7FLG/kFqPX+I1s/7eXL5+1We98dVn3Ys
/3uxL7Heve7TyePNy1feC//9IkOAYOAleYjNkMubnlJqe5tqbg9T9+drXPmx
1+ccV/0fn44un7+/mRqL5kTG/6mxHJjqOj/29gcfuL4T/WFlPFXnQfmlddHX
RgYbadMTye1P3ByOvFYdHZ+nTvWO5c+8tTEyP1jmmk/F9ZP5KyJzglWu8fzN
k92xdi7Se1Pc+9Tfr5Zts2PLFtChtlvR1/orPlDaWEXNw6N5dGTh6GtrznQn
MqquaH7a/YAMAYKAl+QhNkN6j73jGvOPxuYJZwu/nnh99bkb2naNtNI1ho7q
ROE3kvtavIfaYsvu9lcm7znO20JdsdcHKlYl1l9+rs+nJvf8x8mcZB5Mj8wD
wollN79Y7cq9TWfaE8vuXNqeyJiHNrrvVbsXPpHYp/p+qfn2wYUBZZuLyvxq
BpVH8tXJo6Wxf+/rVPO2i4q/57SJDAFWAS/JQ2yGqOurGfJl+57k3/Z5WxPj
vjpeO9dP1H1d3vSCa/6QXBamXf/lPtfkvD5UuzUxFqtjb/fnyVxbruTX3f7T
NC9xLqvO1baTU/NSHPfYy077Lksci5J5cdVtWxSZv0yNzHP+HM3Q+DwpFJuz
lCnPu7f9768i+72IDAE2AS/JQ2yGJMd95zzUemVeMUgnF3w7sWxlTXye0Ef7
Xkz+DZ4qQ9zXPZQM0Z4Fv3WjJ3a9PkwXyv7sOu8VGiND0s2C8S0L07bnkuer
2obHfg+d9yRxfInzaJvoZGP4PtshQ4BI4CV5iM2Q+HWNkM98w/UM95zt0bH/
/67uHZ2fLC6n2ynzKP0Mccbf2p3vJeY80xZtol3rZxrPELVefR7ip5GrnyX2
o2raom3UeNP/fjRkCBAKvCQPkRminuMJRc8P6ev3UfmryeWbr9xK3JOVnJdM
JEOu0ScvJc8Blcf+br9Xk/wMK+MZEnqbLqXIkLv9Ydc9zyOD1+jYugXecT1v
HbXc5skRT1sATBx4SR4iM6Sx6HnfayGqktcsQsl7Vqet9z2/k2mGXNz8VGJ9
9XqIegzmMyRE75zV7ylwNEgH/i1Ec0/2Rn+u2bOHGmI5cS98mXb/4T+1c3Le
zEWGAKHAS/IQlyHu+3ede2sbUqwbpp0vuuuf86n/56JkliFh2v7v8dfc162H
XBmSHHtzlyF6vr5N57TzUfF7x/7Sdid6LFsiPy/W7l9rP/xOGu8vMgSIA16S
R84yRB1/9XuXRtVFFZt/66rnibXHPdc2UuWS33OCcSXv7Z2r3ZfV53NfVlcy
QyLaUDU6/v710kF6/QfJ11ecqKHDhb+kDy700chgZcr7srK9TH+GPzStkPZd
aKGu1kt0dEvs/ZsT/5zf2DX4/BLXtZ67/ccT+8A8BFgEvCSPHGTIYPRzQIqe
U8e9X9Af1n4U/dyNo0fKaNv6Qvfz06Hp9D+fpfPZ713J+5SWnvBfp/uMcn/r
dFpzpj2RS4NXTyqfST+DPo4911GzcqrrfXkszzMeJuY1BzsH3M+M52+my723
E8d+TZ1X5a+j6us3Y+07yzYo5+NWUkVkWXy79sNr3dv13kwcU/TZSd96RpV8
diU5z/rq/CK60Hkzkk39dGnPW7F1F3jmMcgQIJgxfQ+ZV/bHEve177HkfE/V
gnc30O4TF6h7MP024uP9lssDnmWu73FS9ZuddG5nge8y529+55l0V+ZFtHDH
efprzxnlWv9c+rSlK3Y/sVfr6lvos1/6L5vzaQWVL/RftrKmPeU+1fsFmnav
8K6T93s63HJLeQ/CrjmVvm4Z4/cj+rQJQDYwPk5CqcU1nvAp9hy2z/N2E9cg
hTs66HpPB/X0J/9WH7rRHv2sRwnfCXW3v5vqq+uopbmB6ho6fc/73bpxI/L6
YPS7wC7Wjb0uMgQAkCFWZ0jvoTejdc872GG8Fsgt3VvmLA4AYMSqDLl+fj99
/GEx7TlSFfn7e3/svNICqmJ6xgEav3RvGfQ4AIAPazJEf+4wLnzPoUzp/WTI
3wAAXqzJkORn8ibl3Psr4boE5JXuLVMGBwCwYlGGOPfinqGdW9bThx/uoKMX
+b6DD5q4dG8Z9DgAgA+rMgSyR7q3DHocAMAHMgRike4tgx4HAPCBDIFYpHvL
oMcBAHwgQyAW6d4y6HEAAB/IEIhFurcMehwAwAcyBGKR7i2DHgcA8IEMgVik
e8ugxwEAfCBDIBbp3jLocQAAH8gQiEW6twx6HADABzIEYpHuLYMeBwDwgQyB
WKR7y6DHAQB8IEMgFuneMuhxAAAfyBCIRbq3DHocAMAHMgRike4tgx4HAPCB
DIFYpHvLoMcBAHwgQyAW6d4y6HEAAB9+v+sQxCEAQPAwPa5Ak0cAgOBhelyB
Jo8AAMHD9LgCTR4BAAAAAIzJ/wPVaOFC
      "], {{0, 223}, {401, 0}}, {0, 255},
      ColorFunction->RGBColor],
     BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
     Selectable->False],
    DefaultBaseStyle->"ImageGraphics",
    ImageSize->Automatic,
    ImageSizeRaw->{401, 223},
    PlotRange->{{0, 401}, {0, 223}}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728314040176456*^9, 
  3.7283140539438667`*^9}},ExpressionUUID->"19ec3ce1-8acc-415d-9da1-\
2055fadb9cf5"],

Cell[CellGroupData[{

Cell[BoxData["rlmodel"], "Input",
 CellChangeTimes->{{3.7283140565643797`*^9, 
  3.7283140574947147`*^9}},ExpressionUUID->"5457366f-5689-4dfd-a721-\
dcd7e60ae77b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnelzVNeZxjseV3mSqlQWlysfnKRwkgEmiafGZY9lMh5nbIWK7QCmHCMS
iA1RjBmMjdkcMJudCNkgNBCzSmY1YBZJICQhJCSBhFYaRQIJJIHnQ/6EfMrn
d/q2ejn33NuiW+q3z3uunl/VY4u+y3lvn0fn0blL92OF77361gOhUGjNP0f+
8+rv1z2/evXvP/j1NyP/mLdizbKlK5a8+dKKtUuWLln9TOE/RV78W0SffiUU
ejAEAAAAAJAWBEE5EgAgeJgeV6DJIwBA8DA9rkCTRwCA4GF6XIEmjwAAwcP1
ez48NARBWZHuLYMeBwDwgQyBWKR7y6DHAQB8IEMgFuneMuhxAAAfyBCIRbq3
DHocAMAHMgRike4tgx4HAPCBDIFYpHvLoMcBAHwgQyAW6d4y6HEAAB/IEIhF
urcMehwAwAcyBGKR7i2DHgcA8IEMgVike8ugxwEAfCBDIBbp3jLocQAAH8gQ
iEW6twx6HADABzIEYpHuLYMeBwDwgQyBWKR7y6DHAQB8IEMgFuneMuhxAAAf
yBCIRbq3DHocAMAHMgRike4tgx4HAPCBDIFYpHvLoMcBAOOjNKLv3GcdZAjE
It1brE4HAHDg/N7+IzR2liBDIBbp3sqB3wEA2UX9/U2VJcgQiEW6t3LmegBA
tvD7PdazBBkCscjHewBMFD9fQWYUzxJkCMQiH88BMFFMj5sQMgTKkXw8B8BE
gZdyy1jZgXNZEKt8vAfARIGXcstY2eG3jvFxBwqOdG/lzPUgyMBLuWWs7FDX
QYZAWZfurRz4HQQfeCm34BlDyJh0b7E6HUwW4CV5IEMgFuneMuhxEBzgJXkg
QyAW6d4y6HEQHOAleSBDIBbp3jLocRAc4CV5IEMgFuneMuhxEBzgJXkgQyAW
6d4y6HEQHOAleSBDIBbp3jLocRAc4CV5IEMgFuneMuhxEBzgJXkgQzJWH7VV
HKDNyzfQqc47AuqRKd1bBj0OggO8JA8LM6SPji/7GT2Wl0+zZ82ngoKChGbP
mhVVQcEiWvLOWira9RnVtPZmpd27/VfoyNZl9KzyfhWevSHg/ZAp3VvGHA6C
BLwkDwszZIj6Oq5Sc2QusEir/8kXZtNrb8xzjfOOnttwim5PsM07l7ZTfmT/
L/4oud/l55AhyBCQQ+AleViZIXHdPLY8UftPN1Yry8JUsfkV17HlfVKX9TZz
kSEnF3zbyvmO7i0T5gaBA16Sh9UZMnB+fYoMGdXZwh8rxzeXztwczmqb3Bny
ZXs5/cTS+Y7uLSPuBkEDXpJHoDNkSFkeCs2ko70jWW2Td2zvop0vjraz+lyf
8fc6U+neMmFuEDjgJXkEO0Nqt6SdIb1N5+jQrr1UfqScSotL6Fh1i+81FLXN
lTUD5Jw3qz68J7JNMe0o2UdVbbfGrDm9dq7RnoWPJNpZdPASXe/poNaOnglf
10GGAIuBl+QR6AypWvmMcnyFVHPbey7rXvgCbXj5e35jHoXy11F173CKNqfT
mn176d0nvdst3FE77nZGBqtpnt86MZVlYS6FDAGWAi/JIzAZMv1P6jXzQard
uch1bPP3t/rs4wpt/v7o8h+8VUZdw6OvXy1715U9Z5UcGXCdHxvVY3lPe157
/Vj7ONsZpButrdR6/tPE/WXz99dSV2sTtTR3Ur+A9x0ZAgwBL8kjMBkybdE2
Ol15mg6UrKNf/9B9XL/9i3de4Kj+j08nxm99jtJY9HxyH0tPpMiQQjrUNvr8
yb1wPW38udruKmoeHn87d/srE/ORlTW4HgJACF6SSGAyxFdLj1D3oP+26jmj
hzZWepbfC5+ml32upahtFp7t1/ZZ6XpmpbhxYNzt3O0/ndguIPdlQfJkG7bW
HWRcnjI97kwkQx5+/wI554EOF34zeUx56+jSsP+2d5t2Re+bddbzu5bi7OvI
wocT+4qP4/e7Lys55xhdPt52kCFQDmQbttYdZAKTIfHxeWTwIi1Vj2vFcf9t
K8a+Hu9IPc+UboYMVKxyLR9vOwHMECAHW/vE1rqDTOAyxNGdS1tdx/Xmye60
t1V1edMLGWfI0PkP3RkyznaQIYARW/vE1rqDTCAzxFHLttnKsc2k8usjKbcN
5W2hNp9zXsmxfUZi+/tlSOfu1xLb7OscGXc7aobgmjrIMrb2ia11B5nAZojz
7F/8Oe+o8osS99Q6cq51L1KOvbjRu/8Thd+ILX87cV3FnSH62N5H5a/G9jlt
ffS+rPG2o2ZIfmmD8fcaGRIobO0TW+sOMlZnyJDrmnqVZ/m98AnlnqeIlpa5
nq9w3VerZYy6rfqsh5ohv9POkQ0o57FWK3OU8bSjZsh3V5wezaeFj2vPnciV
7q1cmhrcF1v7xNa6g4ylGTJIAz31VPScWv9c2t0Y9nwWyM0vVrvHsjnv0cEL
LXSjf5CczxT55KXksq/O3071HdepveEovTcl9vriclfuuO8nnk5Ldhyjpo4e
ajy8MXH/VX6p/hnBmbfjZMjLnnF4Ou2z5HuvdG/lztIgDWztE1vrDjIWZohy
vshXCzyfz1u5Ls+7Xn4JhaPLu+jgqpk++5lOr3/8eWwdd361nfqYFj7l0/a0
V2h71bUUdWfazhA17X5dWW8GbTpjxxwEGSIeW/vE1rqDjIUZwqOBniaqqaym
luYGuljXQuEUzyaq6utoiqzbQFcaaqm2uTOtz0PMtJ07/d3UGZnn9KdRjyTp
3jLoceDF1j6xte4ggwyBWKR7y6DHgRdb+8TWuoMMMgRike4tgx4HXmztE1vr
DjLIEIhFurcMehx4sbVPbK3bVkoj+s591kGGQCzSvcXqdJAptvaJrXXbivNe
/yM0dpYgQyAW6d7Kgd9B+tjaJ7bWbSvq72+qLEGGQCzSvZUz14N0sLVPbK3b
Vvx+j/UsQYZALPLxHpCDrX0ivW4/3wdV8SxBhkAs8vEckIOtfSK9btPjOjIE
Cox8PAfkYGufSK9ben2ZMlZ24FwWxCof7wE52Non0uuWXl+mjJUdfusYH3eg
4Ej3Vs5cD9LB1j6RXrf0+jJlrOxQ10GGQFmX7q0c+B2kj619Ir1u6fVlCp4x
hIxJ9xar00Gm2Non0uuWXh8HyBCIRbq3DHoceLG1T6TXLb0+DpAhEIt0bxn0
OPBia59Ir1t6fRwgQyAW6d4y6HHgxdY+kV639Po4QIZALNK9ZdDjwIutfSK9
bun1cYAMgVike8ugx4EXW/tEet3S6+MAGQKxSPeWQY8DL7b2ifS6pdfHATIE
YpHuLYMeB15s7RPpdUuvjwNkCMQi3VsGPQ682Non0uuWXh8HyBCIRbq3DHoc
eLG1T6TXLb0+DpAhEIt0bxn0OPBia59Ir1t6fRwgQyAW6d4y6HHgxdY+kV63
9Po4QIZALNK9ZdDjwIutfSK9bun1cYAMgVike8ugx4EXW/tEet3S6+MAGQKx
SPeWQY8DL7b2ifS6pdfHATIEYpHuLYMeB15s7RPpdUuvjwNkCMQi3VsGPQ68
2Non0uuWXh8HyBCIRbq3DHoceLG1T6TXLb0+DpAhEIt0bxn0OPBia59Ir1t6
fRwgQyAW6d4y6HHgxdY+kV639Po4QIZALNK9ZdDjwIutfSK9bun1cYAMgVik
e8ugx4EXW/tEet3S6+MAGQKxSPeWQY8DL7b2ifS6pdfHATIEYpHuLYMeB15s
7RPpdUuvjwO/33UI4hCQg619Ir1u6fVxYHpcgSaPgBxs7RPpdUuvjwPT4wo0
eQTkYGufSK9ben0cmB5XoMkjIAdb+0R63dLrAwCAbGDrWCe9bun1AQBANrB1
rJNet/T6AAAgG9g61kmvW3p9AACQDWwd66TXLb0+AADIBraOddLrll4fAABk
A1vHOul1S68PAACywUTGuqciuqXsY2pED0Q0JaKvZKO4MZA+RkuvDwAAssF4
x7prse2cDHkkoveVfcXzhBPpY7T0+gAAIBuMZ6z7WyiZHyp1yv6mKK8/qGzj
rPOt2OuPhpLzGGf54gxqyPUY/YuI/q60+/591keGAAAmA5mOdeXKNg9oy55N
scwZe515y+Mh9xjs/L80ogLl9a8x1T0R4tn4UURfD43OseJ5mApkCABgMpDJ
WPc1Zf0Cn+UfhZJzijiPhtzZoJ7vejb2mjp/+VYoPXI1Rs+OtTNbee2BNNpH
hgAAJgOZjHUfKes/5LM8fq5HPc/j/Bw/5/WIsn1piv2mey0+V2N0PN/U412c
RvvIEADAZCCTsS5+Hf3vPsseUvY1RXndGYPjf8Or56we1LbXz4vdj1yN0fHr
NadCo+exHJxaPwqNfd8AMgQAMBnIZKxTx1Md9VqHmg/q3+/qvVwTJdcZoqo8
je2QIQCAycB4MuRtn2WlIfe1EOe6xjVl+VeUtvy2z5RcjdHfCnkzJJ22kSEA
gMnAeDJkyhj7+Sj278Uh9zmvR5V1Hs28zJTt5QIn/5znKeM56XfOTgcZAgCY
DIwnQx7XXlfH1inKftX5hvoMYjaeYeceo6eERo+3VHvdqf1vIWQIAAA4ZDLW
xZ//iJ+vcsZT9XkRR1NDyecnvq5sGx93s3EtJBTiH6Pj9fpl3keh+9+HjAwB
AEwGMh3rnPNQz2p6ICb1tUeUbR5U2lk84YpH4R6j43Muv+vnuB4CAACj5GKs
m6K088jYq6YNd93xe8jU5+adn+PPwOjn83SQIQCAyUAuxjrnnNb7oft/xlQm
5KJu53mW9zU513j8nq/UQYYAACYDto510uuWXh8AAGQDW8c66XVLr4+DVM/R
QFC2BeRga59Ir1t6fRyYHlegySMgB1v7RHrd0uvjwPS4Ak0eATnY2ifS65Ze
HwemxxVo8gjIwdY+kV639Po4cP2eDw8NQVBWpHvLoMeBF1v7RHrd0uvjABkC
sUj3lkGPAy+29on0uqXXxwEyBGKR7i2DHgdebO0T6XVLr48DZAjEIt1bBj0O
vNjaJ9Lrll4fB8gQiEW6twx6HHixtU+k1y29Pg6QIRCLdG8Z9DjwYmufSK9b
en0cIEMgFuneMuhx4MXWPpFet/T6OECGQCzSvWXQ48CLrX0ivW7p9XGADIFY
pHvLoMeBF1v7RHrd0uvjABkCsUj3lkGPAy+29on0uqXXxwEyBGKR7i2DHgde
bO0T6XVLr48DZAjEIt1bBj0OvNjaJ9Lrll4fB8gQiEW6twx6HHixtU+k1y29
Pg6QIRCLdG8Z9DjwYmufSK9ben0cIEMgFuneMuhx4MXWPpFet/T6OECGQCzS
vWXQ48CLrX0ivW7p9XGADIFYpHvLoMeBF1v7RHrd0uvjABkCsUj3lkGPAy+2
9on0uqXXxwEyBGKR7i2DHgdebO0T6XVLr48DZAjEIt1bBj0OvNjaJ9Lrll4f
B8iQjNVHbRUHaPPyDXSq846AemRK95ZBjwMvtvaJ9Lql18eBhRnSR8eX/Ywe
y8un2bPmU0FBQUKzZ82KqqBgES15Zy0V7fqMalp7s9Lu3f4rdGTrMnpWeb8K
z94Q8H7IlO4tYw4HftjaJ9Lrll4fBxZmyBD1dVyl5shcYJFW/5MvzKbX3pjn
GucdPbfhFN2eYJt3Lm2n/Mj+X/xRcr/LzyFDkCFWYmufSK9ben0cWJkhcd08
tjxR+083VivLwlSx+RXXseV9Upf1NnORIScXfNvK+Y7uLRPmBimxtU+k1y29
Pg6szpCB8+tTZMiozhb+WDm+uXTm5nBW2+TOkC/by+knls53dG8ZcTdIha19
Ir1u6fVxEOgMGVKWh0Iz6WjvSFbb5B3bu2jni6PtrD7XZ/y9zlS6t0yYG6TE
1j6RXref7yeVTI87ExnPfTOkdkvaGdLbdI4O7dpL5UfKqbS4hI5Vt/heQ1Hb
XFkzQM55s+rDeyLbFNOOkn1U1XZrzJrTa+ca7Vn4SKKdRQcv0fWeDmrt6Jnw
dR1kCAjZ2yfS6zY+hpuW6XEn2xlStfIZ5fgKqea291zWvfAF2vDy9/zfk/x1
VN07nKLN6bRm315690nvdgt31I67nZHBapo3Rh+VZWEuhQyZ9NjaJ7bWHWQC
kyHT/6ReMx+k2p2LXMc2f3+rzz6u0Obvjy7/wVtl1DU8+vrVsndd2XNWyZEB
1/mxUT2W97TntdePtY+znUG60dpKrec/TdxfNn9/LXW1NlFLcyf1C3jfkSHW
Y2uf2Fp3kAlMhkxbtI1OV56mAyXr6Nc/dB/Xb//inRc4qv/j04nxW5+jNBY9
n9zH0hMpMqSQDrWNPn9yL1xPG3+utruKmofH387d/srEfGRlDa6HgKxia5/Y
WneQCUyG+GrpEeoe9N9WPWf00MZKz/J74dP0cmJfyWspapuFZ/u1fVa6nlkp
bhwYdzt3+08ntsN9WSDL2NonttYdZAKTIQ+/f4Gc80CHC7+ZPKa8dXRp2H/b
u027ovfNOuv5XUtx9nVk4cOJfcXH8fvdl5Wcc4wuH287yBDAiK19YmvdQSYw
GRIfn0cGL9JS9bhWHPfftmLs6/GO1PNM6WbIQMUq1/LxtoMMAYzY2ie21h1k
Apchju5c2uo6rjdPdqe9rarLm17IOEOGzn/ozpBxtoMMAYzY2ie21h1kApkh
jlq2zVaObSaVXx9JuW0obwu1+ZzzSo7tMxLb3y9DOne/lthmX+fIuNtRMwTX
1EGWsbVPbK07yAQ2Q5xn/+LPeUeVX5S4p9aRc617kXLsxY3e/Z8o/EZs+duJ
6yruDNHH9j4qfzW2z2nro/dljbcdNUPySxuMv9fIkEBha5/YWneQsTpDhlzX
1Ks8y++FTyj3PEW0tMz1fIXrvlotY9Rt1Wc91Az5nXaObEA5j7VamaOMpx01
Q7674vRoPi18XHvuRK50b+XS1OC+2NonttYdZCzNkEEa6KmnoufU+ufS7saw
57NAbn6x2j2WzXmPDl5ooRv9g+R8psgnLyWXfXX+dqrvuE7tDUfpvSmx1xeX
u3LHfT/xdFqy4xg1dfRQ4+GNifuv8kv1zwjOvB0nQ172jMPTaZ8l33uleyt3
lgZpYGuf2Fp3kLEwQ5TzRb5a4Pl83sp1ed718ksoHF3eRQdXzfTZz3R6/ePP
Y+u486vt1Me08Cmftqe9QturrqWoO9N2hqhp9+vKejNo0xk75iDIEPHY2ie2
1h1kLMwQHg30NFFNZTW1NDfQxboWCqd4NlFVX0dTZN0GutJQS7XNnWl9HmKm
7dzp76bOyDynP416JEn3lkGPAy+29omtdQcZZAjEIt1bY3jwOxGVsjsdqNg6
Fttad5BBhkAs0r3l4714dvwjxXLAh61jsa11BxlkCMQi3VuK5/TswLiQe2x9
z22tO8ggQyAW6d4Kpc4OjAu5x9b33Na6gwwyBGKR7q1Q6uyAzMk2bK07yCBD
IBbp3gohQyTKNmytO8ggQyAW6d4K4VwWmDjwijyQIRCLdG8pnsM1dTBe4BV5
IEMgFune8vEe7u0FmYIMkQcyBGKR7q0xPIhnDEG6IEPkgQwRqz6q2rONdpSU
0OGWvwqoJzPp3jLocRAc4CV5MGdIHx1f9jN6LC+fZs+aTwUFBQn9ZtasyGuz
6FeRn9944y1as2YDlez6jCrq2lyfXztZNVS7Jdk3eVt9P5NRsnRvGXM4CBLw
kjzY5yF9HVepueKA63uYopr2TCw/5tGMf9HHmxm0Zt8l4+OgSd1t2p58P/J3
WZerurcMeBsED3hJHjk7l3Xz2PJEO0+srfQsv157jN590l3PE2tPGR8LzWmQ
Wk4doB0l+6j6+m0B9WQm3Vtm7A0CBrwkj5xlyNjfWxtXH53WvmPjV/ubjY+H
UObSvWXG3iBgwEvyEJYhjgbpyMKHlbpm0rHrI8bHRCgz6d4y5G8QLOAleQjM
kCH6sr088b2yjp4sbYh+F1Nbayt1dnTE1Br5d4frO5yGbiTXcf7fE/2+W2dZ
HzWc2k1bS07Grk2Hqe7zMiotLqbte4/S1RvDvnXc7W+n6sN7outtLSmhneVH
qaa11//4eurp8PattPdiOPrvwfZ6+nzvdiouLqHdJ+pd1zP6W8/RoV2jy8qO
16e+1tF9ObrPfRe6UtR3hSqOJOsrO34hxbX3cPQ4iiPrlezaR1/UtUTPk+2v
8t8vMgQIBV6Sh8gMcXRm2b8q15RL6Pzm//AZl6ZTceNAYpsrRf/tWv7TDz6j
8i3L6NnEa3PpUNVhWurZz1w62eue61wte9d1/V9dP++TeP2D1FZxgFbNeyKx
bPqfKuly2RJvrflF0fH9wuZXvMvm7FLG/kFqPX+I1s/7eXL5+1We98dVn3Ys
/3uxL7Heve7TyePNy1feC//9IkOAYOAleYjNkMubnlJqe5tqbg9T9+drXPmx
1+ccV/0fn44un7+/mRqL5kTG/6mxHJjqOj/29gcfuL4T/WFlPFXnQfmlddHX
RgYbadMTye1P3ByOvFYdHZ+nTvWO5c+8tTEyP1jmmk/F9ZP5KyJzglWu8fzN
k92xdi7Se1Pc+9Tfr5Zts2PLFtChtlvR1/orPlDaWEXNw6N5dGTh6GtrznQn
MqquaH7a/YAMAYKAl+QhNkN6j73jGvOPxuYJZwu/nnh99bkb2naNtNI1ho7q
ROE3kvtavIfaYsvu9lcm7znO20JdsdcHKlYl1l9+rs+nJvf8x8mcZB5Mj8wD
wollN79Y7cq9TWfaE8vuXNqeyJiHNrrvVbsXPpHYp/p+qfn2wYUBZZuLyvxq
BpVH8tXJo6Wxf+/rVPO2i4q/57SJDAFWAS/JQ2yGqOurGfJl+57k3/Z5WxPj
vjpeO9dP1H1d3vSCa/6QXBamXf/lPtfkvD5UuzUxFqtjb/fnyVxbruTX3f7T
NC9xLqvO1baTU/NSHPfYy077Lksci5J5cdVtWxSZv0yNzHP+HM3Q+DwpFJuz
lCnPu7f9768i+72IDAE2AS/JQ2yGJMd95zzUemVeMUgnF3w7sWxlTXye0Ef7
Xkz+DZ4qQ9zXPZQM0Z4Fv3WjJ3a9PkwXyv7sOu8VGiND0s2C8S0L07bnkuer
2obHfg+d9yRxfInzaJvoZGP4PtshQ4BI4CV5iM2Q+HWNkM98w/UM95zt0bH/
/67uHZ2fLC6n2ynzKP0Mccbf2p3vJeY80xZtol3rZxrPELVefR7ip5GrnyX2
o2raom3UeNP/fjRkCBAKvCQPkRminuMJRc8P6ev3UfmryeWbr9xK3JOVnJdM
JEOu0ScvJc8Blcf+br9Xk/wMK+MZEnqbLqXIkLv9Ydc9zyOD1+jYugXecT1v
HbXc5skRT1sATBx4SR4iM6Sx6HnfayGqktcsQsl7Vqet9z2/k2mGXNz8VGJ9
9XqIegzmMyRE75zV7ylwNEgH/i1Ec0/2Rn+u2bOHGmI5cS98mXb/4T+1c3Le
zEWGAKHAS/IQlyHu+3ede2sbUqwbpp0vuuuf86n/56JkliFh2v7v8dfc162H
XBmSHHtzlyF6vr5N57TzUfF7x/7Sdid6LFsiPy/W7l9rP/xOGu8vMgSIA16S
R84yRB1/9XuXRtVFFZt/66rnibXHPdc2UuWS33OCcSXv7Z2r3ZfV53NfVlcy
QyLaUDU6/v710kF6/QfJ11ecqKHDhb+kDy700chgZcr7srK9TH+GPzStkPZd
aKGu1kt0dEvs/ZsT/5zf2DX4/BLXtZ67/ccT+8A8BFgEvCSPHGTIYPRzQIqe
U8e9X9Af1n4U/dyNo0fKaNv6Qvfz06Hp9D+fpfPZ713J+5SWnvBfp/uMcn/r
dFpzpj2RS4NXTyqfST+DPo4911GzcqrrfXkszzMeJuY1BzsH3M+M52+my723
E8d+TZ1X5a+j6us3Y+07yzYo5+NWUkVkWXy79sNr3dv13kwcU/TZSd96RpV8
diU5z/rq/CK60Hkzkk39dGnPW7F1F3jmMcgQIJgxfQ+ZV/bHEve177HkfE/V
gnc30O4TF6h7MP024uP9lssDnmWu73FS9ZuddG5nge8y529+55l0V+ZFtHDH
efprzxnlWv9c+rSlK3Y/sVfr6lvos1/6L5vzaQWVL/RftrKmPeU+1fsFmnav
8K6T93s63HJLeQ/CrjmVvm4Z4/cj+rQJQDYwPk5CqcU1nvAp9hy2z/N2E9cg
hTs66HpPB/X0J/9WH7rRHv2sRwnfCXW3v5vqq+uopbmB6ho6fc/73bpxI/L6
YPS7wC7Wjb0uMgQAkCFWZ0jvoTejdc872GG8Fsgt3VvmLA4AYMSqDLl+fj99
/GEx7TlSFfn7e3/svNICqmJ6xgEav3RvGfQ4AIAPazJEf+4wLnzPoUzp/WTI
3wAAXqzJkORn8ibl3Psr4boE5JXuLVMGBwCwYlGGOPfinqGdW9bThx/uoKMX
+b6DD5q4dG8Z9DgAgA+rMgSyR7q3DHocAMAHMgRike4tgx4HAPCBDIFYpHvL
oMcBAHwgQyAW6d4y6HEAAB/IEIhFurcMehwAwAcyBGKR7i2DHgcA8IEMgVik
e8ugxwEAfCBDIBbp3jLocQAAH8gQiEW6twx6HADABzIEYpHuLYMeBwDwgQyB
WKR7y6DHAQB8IEMgFuneMuhxAAAfyBCIRbq3DHocAMAHMgRike4tgx4HAPCB
DIFYpHvLoMcBAHwgQyAW6d4y6HEAAB9+v+sQxCEAQPAwPa5Ak0cAgOBhelyB
Jo8AAMHD9LgCTR4BAAAAAIzJ/wPVaOFC
    "], {{0, 223}, {401, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSizeRaw->{401, 223},
  PlotRange->{{0, 401}, {0, 223}}]], "Output",
 CellChangeTimes->{{3.72831405817378*^9, 3.728314062459689*^9}, 
   3.728740683998905*^9, 3.728925770837056*^9, 3.729000360627757*^9, 
   3.729340934023889*^9, 3.729341405374997*^9, 3.7293428235161657`*^9, 
   3.729344847921084*^9, 3.729346185346468*^9, 3.72934729439552*^9, 
   3.7295283939178553`*^9, 3.72953362462249*^9, 3.7295339918740997`*^9, 
   3.729534222768367*^9, 3.729614427176529*^9, 3.729614534355196*^9, 
   3.729614602432926*^9, 3.729707484866021*^9, 3.729707830883132*^9, 
   3.7297079351572027`*^9, 3.7297097573940153`*^9, 3.72971036334653*^9, 
   3.7297108805793457`*^9, 3.729711152228676*^9, 3.7298024099286118`*^9, 
   3.729802749987686*^9, 3.72980603272472*^9, 3.729867511864678*^9, 
   3.7298680240808573`*^9, 3.7298684088367043`*^9, 3.7298687505902157`*^9, 
   3.7298773948797493`*^9, 3.729948219179989*^9, 3.729948255282167*^9, {
   3.729948472663354*^9, 3.729948497868229*^9}, 3.7299485888708277`*^9, 
   3.729949197724555*^9, 3.729949747573988*^9, 3.7299591624628572`*^9, 
   3.729971892331526*^9, 3.729979194564438*^9, 3.729979476273242*^9, 
   3.729979576924808*^9, 3.729979988693499*^9, 3.730026523785017*^9, 
   3.73002680896621*^9, 3.7300275200447483`*^9, 3.730027598226358*^9, 
   3.730027636064333*^9, 3.730056103153121*^9, 3.730056150637291*^9, 
   3.7300566445756598`*^9, 3.730056734080228*^9, 3.730056840841549*^9, 
   3.73005768556841*^9, 3.730057722971909*^9, 3.730058163843348*^9, 
   3.730122884156865*^9, 3.7301267055011997`*^9, 3.730126905345685*^9, 
   3.7301315887311153`*^9, 3.730131637409268*^9, 3.730143828220682*^9, 
   3.730143966355281*^9, 3.730144012536359*^9, 3.730144047855483*^9, 
   3.730413827327155*^9, 3.730414323661771*^9, 3.730414944794099*^9, 
   3.730415635214053*^9, 3.730416021318921*^9, 3.730460900522197*^9, 
   3.730484514623117*^9, 3.730491234333399*^9, 3.730491638215014*^9, 
   3.730545855431669*^9, 3.730546740900648*^9, 3.73054723113616*^9, 
   3.730548179705243*^9, 3.730549983332707*^9, 3.730551938971293*^9, 
   3.7305540935014677`*^9, 3.730554608382564*^9, 3.730554950221344*^9, 
   3.730556800341064*^9, 3.7305569297534037`*^9, 3.7305578192319393`*^9, 
   3.730557878421071*^9, 3.7305582851200657`*^9, 3.730562920358842*^9, 
   3.730563777580185*^9, 3.7305638716742163`*^9, 3.730564008637157*^9, 
   3.730564532075446*^9, 3.730567606383917*^9, 3.73056781474004*^9, 
   3.730716307847968*^9, 3.730719989131919*^9, 3.73072029194211*^9, 
   3.730720583909561*^9, 3.730724571800304*^9, 3.730725139984758*^9, 
   3.7307334392569847`*^9, 3.730736292822474*^9, 3.730738684285839*^9, 
   3.730747501474621*^9, 3.730747665401395*^9, 3.730904568506119*^9, 
   3.7309049232378073`*^9, 3.730907168974811*^9, {3.730907224154282*^9, 
   3.730907245506283*^9}, 3.7309074500600843`*^9, 3.73090765765396*^9, 
   3.730907714431731*^9, 3.731065407251844*^9, 3.7310659663876247`*^9, 
   3.731066375392034*^9, 3.731066605117929*^9, 3.7310669316828423`*^9, 
   3.7310691063371687`*^9, 3.731089223342671*^9, 3.7311508136258993`*^9, 
   3.7311523058906507`*^9, 3.731161115498938*^9, 3.731179764443775*^9, 
   3.731180396487262*^9, 3.731180739860141*^9, 3.73118106714872*^9, 
   3.7312341195465918`*^9, 3.7312346373107233`*^9, 3.731237352740034*^9, 
   3.731238231121169*^9, 3.7316667963527613`*^9, 3.7316673834094133`*^9, 
   3.7316801641587763`*^9, 3.7316803397827682`*^9, 3.731680460574054*^9, 
   3.731683949512727*^9, 3.731684774866972*^9, 3.731684961088006*^9, 
   3.7317523970967827`*^9, 3.73175662068858*^9, 3.73176860713559*^9, 
   3.731769361661381*^9, 3.731771215020426*^9, 3.731778193007277*^9, 
   3.731792152511859*^9, 3.73183388345499*^9, 3.73184110466378*^9, 
   3.731842854949786*^9, 3.731857964231038*^9, 3.7318681230837717`*^9, 
   3.7318844295349007`*^9, 3.73192678095082*^9, 3.731938456699237*^9, 
   3.731939951082726*^9, 3.731941258580056*^9, 3.73194317935452*^9, 
   3.731946701023036*^9, 3.732041236164167*^9, 3.732378371945009*^9, 
   3.732456515103804*^9, 3.732485009282215*^9, 3.732486274963648*^9, 
   3.732490574871024*^9, 
   3.732532080967581*^9},ExpressionUUID->"2525ab5c-8798-47dc-a520-\
5725b3b79b3e"]
}, Open  ]],

Cell["Define learning rate, discount factor, time step", "Text",
 CellChangeTimes->{{3.728314126201619*^9, 3.7283141982138433`*^9}, {
   3.7283143841250057`*^9, 3.728314430797217*^9}, {3.728314581809507*^9, 
   3.7283145824334297`*^9}, {3.72832141013498*^9, 3.728321523994196*^9}, {
   3.7283215599024553`*^9, 3.728321593004086*^9}, {3.728321627533634*^9, 
   3.728321667230465*^9}, {3.7283476582334623`*^9, 3.72834767141339*^9}, {
   3.728391356962105*^9, 3.72839136532132*^9}, {3.728391466348716*^9, 
   3.72839147566226*^9}, {3.72839496664959*^9, 3.728394975812171*^9}, {
   3.728395067271146*^9, 3.7283950745505047`*^9}, {3.728404627399394*^9, 
   3.728404647778544*^9}, {3.728407075649516*^9, 3.728407095004986*^9}, {
   3.730058048850017*^9, 3.730058086048973*^9}, 3.730131613148938*^9, {
   3.731161893766534*^9, 
   3.7311618957624273`*^9}},ExpressionUUID->"bf459b46-c5ba-40e8-99be-\
c9f29e4d42cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", "=", "0.9"}], ";"}]], "Input",
 CellChangeTimes->{{3.7298685839389877`*^9, 
  3.729868596072126*^9}},ExpressionUUID->"6d11b515-1864-44fe-b384-\
e6d3abffb9d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]", "=", "0.95"}], ";"}]], "Input",
 CellChangeTimes->{{3.7298685998571987`*^9, 3.729868603304302*^9}, {
  3.73046083860798*^9, 3.730460839000787*^9}, {3.7318838667721977`*^9, 
  3.731883867032817*^9}},ExpressionUUID->"d35007f3-e225-4b79-bbb4-\
e488b13a391a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]t", "=", "1"}], ";"}]], "Input",ExpressionUUID->"c83904af-cdd7-4b67-9b17-d402bcde9d1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eps", "=", "0.3"}], ";"}]], "Input",
 CellChangeTimes->{{3.730557792925255*^9, 3.7305577935908623`*^9}, {
  3.7318838582237673`*^9, 3.731883864074996*^9}, {3.732490161987074*^9, 
  3.732490165044389*^9}},ExpressionUUID->"b987e7b6-4b5e-4946-81e8-\
249225bd3885"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Reward", "[", 
    RowBox[{"currentSol_", ",", "pastSol_"}], "]"}], ":=", 
   RowBox[{"currentSol", "-", "pastSol"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7284072339062223`*^9, 3.728407250434235*^9}, {
  3.728407284208919*^9, 3.7284074218612547`*^9}, {3.728689538613014*^9, 
  3.7286895522081423`*^9}},ExpressionUUID->"47ad7e23-f59d-47fd-a142-\
1ea243819c13"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QUpdate", "[", 
    RowBox[{
    "newPos_", ",", "oldPos_", ",", "actionPos_", ",", "reward_", ",", "Q_"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{"Q", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"oldPos", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"oldPos", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"oldPos", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"oldPos", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"actionPos", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"actionPos", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "+", 
    RowBox[{"\[Alpha]", " ", 
     RowBox[{"(", 
      RowBox[{"reward", "+", 
       RowBox[{"\[Gamma]", " ", 
        RowBox[{"Max", "[", " ", 
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"newPos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"newPos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"newPos", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"newPos", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], "-", 
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"oldPos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"oldPos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"oldPos", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"oldPos", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"actionPos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"actionPos", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.728407466944422*^9, 3.728407505001459*^9}, {
  3.728407601163583*^9, 3.728407649437986*^9}, {3.7284079603100967`*^9, 
  3.728408144355372*^9}, {3.7289151861606092`*^9, 3.728915220728875*^9}, {
  3.7289178868813753`*^9, 3.7289178876803083`*^9}, {3.729709414674202*^9, 
  3.729709477518569*^9}, {3.729709514362439*^9, 3.729709548781636*^9}, {
  3.7298708898467827`*^9, 3.729870905572448*^9}, {3.730461022288055*^9, 
  3.730461040938581*^9}},ExpressionUUID->"e6e0ea36-ada3-4d30-9ee4-\
d34a3a3eb264"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getActionPos", "[", "action_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"stiffnessAction", ",", 
         RowBox[{"action", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"\[Phi]dotAction", ",", 
         RowBox[{"action", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729870934723309*^9, 3.7298710001986523`*^9}, {
  3.7298768800126133`*^9, 3.729876884683591*^9}, {3.730026629157143*^9, 
  3.730026635642105*^9}},ExpressionUUID->"1b1b2fe0-a4f2-48d0-992d-\
abf645d6d3c3"],

Cell["\<\
We could define an epsilon that decays as the number of episodes increases.\
\>", "Text",
 CellChangeTimes->{{3.728696394544428*^9, 3.728696414019815*^9}, {
  3.72869650560732*^9, 3.728696517145562*^9}, {3.728742340358164*^9, 
  3.7287423418439083`*^9}, {3.7305577802243147`*^9, 
  3.730557785726963*^9}},ExpressionUUID->"582f3bc5-601e-4248-842b-\
5bd97eb5a47a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getMaxPos", "[", 
    RowBox[{"state_", ",", "Q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"state", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
      RowBox[{"Max", "[", 
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"state", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"state", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"state", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], "]"}], 
    "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7293426382443542`*^9, 
  3.729342682898212*^9}},ExpressionUUID->"11720fa8-c1ec-41f7-9f8d-\
507c66d5729a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chooseAction", "[", 
    RowBox[{"eps_", ",", "state_", ",", "Q_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"eps", ">", 
      RowBox[{"Random", "[", "]"}]}], ",", 
     RowBox[{"action", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomChoice", "[", "stiffnessAction", "]"}], ",", 
        RowBox[{"RandomChoice", "[", "\[Phi]dotAction", "]"}]}], "}"}]}], ",", 
     RowBox[{"action", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"stiffnessAction", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"getMaxPos", "[", 
            RowBox[{"state", ",", "Q"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"\[Phi]dotAction", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"getMaxPos", "[", 
            RowBox[{"state", ",", "Q"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.728696562078178*^9, 3.728696616949601*^9}, 
   3.728739271567623*^9, {3.728739511018176*^9, 3.72873952301724*^9}, {
   3.72873980656207*^9, 3.728739862193487*^9}, {3.728739900164473*^9, 
   3.728739911684786*^9}, {3.728740079577585*^9, 3.728740133207677*^9}, {
   3.728740175769524*^9, 3.728740197992474*^9}, {3.7287407343132753`*^9, 
   3.728740802747878*^9}, {3.728740874669862*^9, 3.7287409126067467`*^9}, {
   3.728741104132782*^9, 3.728741111028878*^9}, {3.72874115093542*^9, 
   3.728741151381824*^9}, {3.728918459647079*^9, 3.728918466445197*^9}, {
   3.7289186084509573`*^9, 3.728918662709717*^9}, {3.728918752713559*^9, 
   3.72891875690452*^9}, {3.7289263822068233`*^9, 3.7289264115703173`*^9}, {
   3.729341036034458*^9, 3.729341046430855*^9}, {3.729341165476618*^9, 
   3.72934116646585*^9}, {3.729341337865615*^9, 3.729341338168112*^9}, {
   3.729341988563365*^9, 3.729342008180361*^9}, {3.7293423596170473`*^9, 
   3.729342368842514*^9}, {3.7293426918268023`*^9, 3.729342788435853*^9}, {
   3.7293441740724783`*^9, 
   3.729344175575026*^9}},ExpressionUUID->"91616ac1-7556-4696-a9ca-\
85b87a541bb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]Update", "[", 
    RowBox[{"\[Phi]0_", ",", "t_", ",", "\[Phi]dot_"}], "]"}], ":=", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"\[Phi]0", "+", 
      RowBox[{"Integrate", "[", 
       RowBox[{"\[Phi]dot", ",", "t"}], "]"}]}], ",", 
     RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}], ";"}]], "Input",ExpressionUUID->\
"02757c68-9131-45f9-b1d3-481347a55125"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"takeAction", "[", 
    RowBox[{"action_", ",", "initialCon_", ",", "time_", ",", "\[Phi]0_"}], 
    "]"}], ":=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"odesk", "/.", 
               RowBox[{"{", 
                RowBox[{"c1", "\[Rule]", " ", "1"}], "}"}]}], "/.", 
              "ellipseMasses"}], "/.", 
             RowBox[{"{", 
              RowBox[{"k1", "\[Rule]", " ", 
               RowBox[{"action", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
              RowBox[{"\[Phi]0", "+", 
               RowBox[{
                RowBox[{"action", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "\[Delta]t"}]}]}], 
             "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
             RowBox[{"action", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Phi]", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
            "0.0"}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", "\[Rule]", " ", "1000"}], "}"}]}], "/.", 
        "robotParameters"}], ",", "initialCon"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "time", ",", " ", 
       RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<EquationSimplification\>\"", "\[Rule]", " ", "\"\<Residual\>\""}],
        "}"}]}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "All"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.72874119359476*^9, 3.728741215030493*^9}, {
   3.728741283780876*^9, 3.728741309334283*^9}, {3.728741411224587*^9, 
   3.728741463994328*^9}, {3.7287532341513433`*^9, 3.728753263433487*^9}, {
   3.7287533650838118`*^9, 3.728753374125037*^9}, {3.7289196970389*^9, 
   3.7289196990233793`*^9}, {3.729004234025774*^9, 3.7290042618810472`*^9}, {
   3.729081500728117*^9, 3.729081503931939*^9}, 3.729081783873748*^9, {
   3.729129125271319*^9, 3.729129126704165*^9}, {3.729129262805717*^9, 
   3.729129311995133*^9}, {3.729183059755*^9, 3.729183059918483*^9}, {
   3.7291831925368032`*^9, 3.729183192778504*^9}, {3.729344260395535*^9, 
   3.729344264680663*^9}, {3.729345840726055*^9, 3.729345882944232*^9}, {
   3.72934604997388*^9, 3.7293461275933332`*^9}, {3.729346316335318*^9, 
   3.729346327853944*^9}, {3.729346503476449*^9, 3.729346511556594*^9}, 
   3.7293466515281*^9, {3.729346928269916*^9, 3.7293469796624947`*^9}, {
   3.72934703893356*^9, 3.729347065472699*^9}, {3.729528496371563*^9, 
   3.729528496561482*^9}, {3.729529420093976*^9, 3.729529446895047*^9}, {
   3.729529491263261*^9, 3.7295294958391037`*^9}, {3.729529832615241*^9, 
   3.729529865138102*^9}, 3.729533732877241*^9, {3.7298025185007067`*^9, 
   3.729802525807848*^9}, {3.730027499581511*^9, 3.73002749992901*^9}, {
   3.730027562620401*^9, 3.7300275656747828`*^9}, {3.73005679303533*^9, 
   3.730056822394429*^9}, {3.7300568568677273`*^9, 3.730056859171741*^9}, {
   3.7307138589269*^9, 3.730713865057369*^9}, 3.730714714256014*^9, {
   3.730720209856659*^9, 3.730720214278102*^9}, {3.730720501877512*^9, 
   3.7307205019826393`*^9}, {3.730724543574522*^9, 3.7307245464011173`*^9}, {
   3.730747426663999*^9, 3.730747435120429*^9}, 3.730747466868417*^9, 
   3.730747515919881*^9, {3.730904495714592*^9, 3.730904507517613*^9}, {
   3.730905988884878*^9, 3.730905989093745*^9}, 3.73090615977544*^9, {
   3.730907606083803*^9, 3.7309076146216593`*^9}, {3.731063920656481*^9, 
   3.73106392430418*^9}, {3.731064099019403*^9, 3.7310640990814447`*^9}, {
   3.731064255042082*^9, 3.73106425739196*^9}, {3.7310648108667097`*^9, 
   3.73106483283309*^9}, {3.731064875875238*^9, 3.731064882434531*^9}, {
   3.731065355226468*^9, 3.7310653555928164`*^9}, {3.731065926391384*^9, 
   3.731065928020215*^9}, {3.731150165034245*^9, 3.731150179476763*^9}, {
   3.731150211526746*^9, 3.731150215431122*^9}, {3.731835295279316*^9, 
   3.731835304524167*^9}, 
   3.731857459369842*^9},ExpressionUUID->"f9d78e1e-bad1-42e4-b252-\
83cceea8c2db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"takeActionReduced", "[", 
    RowBox[{"action_", ",", "initialCon_", ",", "time_", ",", "\[Phi]0_"}], 
    "]"}], ":=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"fiberODE", ",", "\[Theta]1odek"}], "}"}], "/.", 
               RowBox[{"{", 
                RowBox[{"c1", "\[Rule]", " ", "1"}], "}"}]}], "/.", 
              "ellipseMasses"}], "/.", 
             RowBox[{"{", 
              RowBox[{"k1", "\[Rule]", 
               RowBox[{"action", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
              RowBox[{"\[Phi]0", "+", 
               RowBox[{
                RowBox[{"action", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "\[Delta]t"}]}]}], 
             "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
             RowBox[{"action", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Phi]", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
            "0.0"}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", "\[Rule]", " ", "1000"}], "}"}]}], "/.", 
        "robotParameters"}], ",", "initialCon"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ",", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "time", ",", " ", 
       RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<EquationSimplification\>\"", "\[Rule]", " ", "\"\<Residual\>\""}],
        "}"}]}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "All"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.731768974259246*^9, 3.731769024043787*^9}, 
   3.731835520583036*^9, 3.731839480958338*^9, 3.7318402730909843`*^9, {
   3.731857439590958*^9, 
   3.7318574481272717`*^9}},ExpressionUUID->"5c14b6a9-f4c9-47ce-9140-\
74be624794fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numOfEpisodes", " ", "=", " ", "100"}], ";"}]], "Input",
 CellChangeTimes->{{3.728689460162578*^9, 3.7286894634039*^9}, {
   3.728689562363535*^9, 3.728689576193242*^9}, {3.730415959461584*^9, 
   3.730415963411379*^9}, 3.730460864294846*^9, {3.7304912156396637`*^9, 
   3.730491216582067*^9}, {3.730491598975088*^9, 3.730491621869946*^9}, 
   3.730545803228072*^9, {3.730554067177697*^9, 3.730554069641202*^9}, {
   3.73090462454426*^9, 3.730904626848365*^9}, {3.73090488874546*^9, 
   3.730904889272147*^9}, {3.731883767986432*^9, 3.73188376817168*^9}, {
   3.7319364834762297`*^9, 3.731936483669071*^9}, 3.732377995247504*^9, 
   3.7324898748924847`*^9, 
   3.732531642327228*^9},ExpressionUUID->"1d0a6b2c-fbe0-4976-b612-\
60c2410f7b50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lengthOfEpisode", "=", "20"}], ";"}]], "Input",
 CellChangeTimes->{{3.72875321279453*^9, 3.728753219030221*^9}, 
   3.728918372842695*^9, {3.7304147107972803`*^9, 3.730414711445558*^9}, {
   3.7304159657140217`*^9, 3.730415980135003*^9}, {3.730416079092004*^9, 
   3.730416079651176*^9}, 3.730460866387972*^9, {3.730491218165984*^9, 
   3.730491219079081*^9}, {3.7305458051002502`*^9, 3.7305458054794416`*^9}, {
   3.730545882763659*^9, 3.730545886457247*^9}, {3.731680319118318*^9, 
   3.731680319210245*^9}, {3.731883770361217*^9, 
   3.731883770753084*^9}},ExpressionUUID->"6ee0abc5-656d-46db-a11b-\
45c6c46bebfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportCounter", "=", 
   FractionBox["numOfEpisodes", "10"]}], ";"}]], "Input",
 CellChangeTimes->{{3.73246031331255*^9, 3.732460340662651*^9}, 
   3.732489877125704*^9, {3.732489981860093*^9, 3.73248998347567*^9}, 
   3.732531644862196*^9},ExpressionUUID->"6e55b638-6b2d-4d0e-9b74-\
70db1d61a02d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getStatePos", "[", "state_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"states", ",", 
        RowBox[{"state", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"states", ",", 
        RowBox[{"state", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"states", ",", 
        RowBox[{"state", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"states", ",", 
        RowBox[{"state", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728917758352169*^9, 3.7289178415028467`*^9}, {
  3.7297096646176643`*^9, 3.729709738094046*^9}, {3.729878952013752*^9, 
  3.729879046380938*^9}, {3.729879099159412*^9, 3.729879110151094*^9}, {
  3.729879548872061*^9, 3.729879557765242*^9}, {3.729948561843144*^9, 
  3.729948567076433*^9}},ExpressionUUID->"6d771656-3ad6-4a7d-9a11-\
4b74b259b767"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getClosestStatePos", "[", 
    RowBox[{"states_", ",", "newState_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"states", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"states", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"states", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"states", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7299580455357533`*^9, 3.72995806693486*^9}, {
  3.729958246314361*^9, 3.729958300906825*^9}, {3.729958342974906*^9, 
  3.729958421920725*^9}, {3.7299587001143312`*^9, 3.729958715123528*^9}, {
  3.730718701690763*^9, 3.730718918193884*^9}, {3.730718978629118*^9, 
  3.730719015312976*^9}},ExpressionUUID->"59f61ab9-9abe-490c-be65-\
0e0a0d161974"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getInitialPos", "[", 
    RowBox[{"state1_", ",", "state2_", ",", "state3_", ",", "state4_"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"state1", ",", "0."}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"state2", ",", "0."}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"state3", ",", "0"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"state4", ",", "0."}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729958864995276*^9, 3.729958942296916*^9}, {
  3.7299590041548033`*^9, 3.729959009786365*^9}, {3.729959202913114*^9, 
  3.7299592277444344`*^9}, {3.729959285682823*^9, 3.729959367862871*^9}, {
  3.730713602403161*^9, 
  3.730713612442644*^9}},ExpressionUUID->"3ec8f14d-154a-4b43-9c2b-\
3246b7741fb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"currentTimeAndDate", "=", 
   RowBox[{"DateList", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732039766856236*^9, 
  3.732039774869223*^9}},ExpressionUUID->"46ecd9f1-3c3d-4c73-ae07-\
c8da570817ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeAndDateStrings", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"ToString", "[", "#", "]"}], "&"}], "/@", 
     "currentTimeAndDate"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732039702002762*^9, 3.732039789628271*^9}, {
   3.732039833086803*^9, 3.7320398459312696`*^9}, {3.732039899481348*^9, 
   3.732039900874133*^9}, {3.7320399516281633`*^9, 3.732040041680122*^9}, 
   3.732040852132677*^9},ExpressionUUID->"f6697599-a3ef-4f8b-801a-\
4db1a5deac00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"space", "=", 
   RowBox[{"ToString", "[", "_", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7320403748254623`*^9, 
  3.732040380199196*^9}},ExpressionUUID->"7770b6b4-b5dd-4b04-970f-\
66ade8c87fb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeAndDateString", "=", 
   RowBox[{
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "<>", "space", "<>", 
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "<>", "space", "<>", 
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "<>", "space", "<>", 
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "<>", "space", "<>", 
    RowBox[{"timeAndDateStrings", "[", 
     RowBox[{"[", "5", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732040048776979*^9, 3.732040071857229*^9}, {
   3.732040107205275*^9, 3.732040199058991*^9}, {3.732040254059189*^9, 
   3.7320402559598627`*^9}, {3.732040285979056*^9, 3.7320403990089417`*^9}, 
   3.732040447212699*^9},ExpressionUUID->"6b73ffa1-d627-489d-a736-\
9189e7b8edbc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Initialize", " ", "Q", " ", "matrix"}], ",", " ", "states", ",", 
    " ", "actions", ",", " ", 
    RowBox[{"and", " ", "terminal", " ", "state", " ", 
     RowBox[{"(", 
      RowBox[{
      "defined", " ", "as", " ", "the", " ", "maximum", " ", "time", " ", 
       "one", " ", "can", " ", "wander", " ", "through", " ", "the", " ", 
       "state", " ", "space"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"begintime", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]states", " ", "=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"2", "\[Pi]"}], ",", 
       FractionBox["\[Pi]", "10"]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Theta]1states", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"2", "\[Pi]"}], ",", 
       FractionBox["\[Pi]", "10"]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Phi]states", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"2", " ", "\[Pi]"}], ",", 
       FractionBox["\[Pi]", "10"]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Theta]1dotstates", "=", 
     RowBox[{"Range", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "\[Pi]"}], "2"], ",", 
       FractionBox["\[Pi]", "2"], ",", 
       FractionBox["\[Pi]", "10"]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Phi]dotAction", "=", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "1.2"}], ",", "1.2", ",", "1.2"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"stiffnessAction", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.2", ",", "1.5", ",", 
       FractionBox["1", "10"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stopForExport", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"states", "=", 
     RowBox[{"{", 
      RowBox[{
      "\[Theta]states", ",", "\[Theta]1states", ",", "\[Theta]1dotstates", 
       ",", "\[Phi]states"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0.0", ",", 
       RowBox[{"{", 
        RowBox[{"s1", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Theta]states", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s2", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Theta]1states", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s3", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Theta]1dotstates", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s4", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Phi]states", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a1", ",", "1", ",", 
         RowBox[{"Length", "[", "stiffnessAction", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a2", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Phi]dotAction", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Run", " ", "a", " ", "series", " ", "of", " ", "episodes"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "\[LessEqual]", " ", "numOfEpisodes"}], ",", " ", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"initialConditions", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{
            RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}],
           "}"}]}], ";"}], "*)"}], 
      RowBox[{
       RowBox[{"initialConditions", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "Initialize", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"statePos", "=", 
        RowBox[{"getInitialPos", "[", 
         RowBox[{
         "\[Theta]states", ",", "\[Theta]1states", ",", "\[Theta]1dotstates", 
          ",", "\[Phi]states"}], "]"}]}], ";", " ", 
       RowBox[{"pastx", "=", "0"}], ";", 
       RowBox[{"\[Phi]0", "=", "0.0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Take", " ", "\"\<lengthOfEpisode\>\"", " ", "steps", " ", "in", " ", 
         "the", " ", "environment"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "0"}], ",", " ", 
         RowBox[{"j", "<", "lengthOfEpisode"}], ",", " ", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Choose", " ", "the", " ", "action", " ", "from", " ", "current", 
           " ", "state", " ", "using", " ", "desired", " ", "policy"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"action", "=", 
           RowBox[{"chooseAction", "[", 
            RowBox[{"eps", ",", "statePos", ",", "Q"}], "]"}]}], ";", 
          RowBox[{"actionPos", "=", 
           RowBox[{"getActionPos", "[", "action", "]"}]}], ";", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Take", " ", "action", " ", "and", " ", "observe", " ", "distance",
             " ", "in", " ", "x", " ", "direction", " ", 
            RowBox[{"(", "reward", ")"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"solution", "=", 
           RowBox[{"takeActionReduced", "[", 
            RowBox[{
            "action", ",", "initialConditions", ",", "j", ",", "\[Phi]0"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"newx", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "t", "]"}], "/.", "solution"}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"t", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"j", "+", "\[Delta]t"}], ")"}]}], "}"}]}], ")"}], 
            "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Observe", " ", "new", " ", "state"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"newState", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
                  RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
                  RowBox[{
                   RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], ",", 
                  RowBox[{"\[Phi]0", "+", 
                   RowBox[{
                    RowBox[{"action", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "\[Delta]t"}]}]}], 
                 "}"}], "/.", "solution"}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"t", "\[Rule]", 
                RowBox[{"j", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Phi]0", "=", 
           RowBox[{"newState", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Use", " ", 
            RowBox[{"Mod", "[", 
             RowBox[{"anglestates", ",", 
              RowBox[{"2", "pi"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"newState", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"newState", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"newState", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", 
             RowBox[{"newState", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"newState", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Determine", " ", "which", " ", "discretized", " ", "state", " ", 
            "newState", " ", "is", " ", "closest", " ", 
            RowBox[{"to", ".", " ", "Really"}], " ", "this", " ", "finds", 
            " ", "the", " ", "closest", " ", "position", " ", "in", " ", 
            "the", " ", "set", " ", "of", " ", "states", " ", "and", " ", 
            "returns", " ", "it", " ", "so", " ", "it", " ", "can", " ", "be",
             " ", "matched", " ", "in", " ", "the", " ", "Q", " ", 
            RowBox[{"matrix", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"newStatePos", "=", 
           RowBox[{"getClosestStatePos", "[", 
            RowBox[{"states", ",", "newState"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Compute", " ", "reward", " ", "and", " ", "update", " ", 
            "previous", " ", "x", " ", "position"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"r", "=", 
           RowBox[{"Reward", "[", 
            RowBox[{"newx", ",", "pastx"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pastx", "=", "newx"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Update", " ", "Q", " ", "matrix"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"statePos", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"statePos", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"statePos", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"statePos", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", 
              RowBox[{"actionPos", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"actionPos", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"QUpdate", "[", 
            RowBox[{
            "newStatePos", ",", "statePos", ",", "actionPos", ",", "r", ",", 
             "Q"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"statePos", "=", "newStatePos"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"initialConditions", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                    RowBox[{"x", "[", "t", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"y", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                    RowBox[{"y", "[", "t", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", " ", 
                    RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "'"}], "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"x", "'"}], "[", "t", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"y", "'"}], "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"y", "'"}], "[", "t", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Theta]", "'"}], "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]1", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                    RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Theta]1", "'"}], "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}], "}"}], "/.",
                   "solution"}], ")"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"t", "\[Rule]", 
                  RowBox[{"j", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}], 
          RowBox[{"initialConditions", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                   RowBox[{"x", "[", "t", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"y", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                   RowBox[{"y", "[", "t", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"\[Theta]", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", " ", 
                   RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"\[Theta]1", "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                   RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]1", "'"}], "[", 
                    RowBox[{"j", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}], "}"}], "/.",
                 "solution"}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"t", "\[Rule]", 
                RowBox[{"j", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "stopForExport"}], ",", 
            RowBox[{
             RowBox[{"Export", "[", 
              RowBox[{
               RowBox[{
               "\"\<Qmatrix_\>\"", "<>", "timeAndDateString", "<>", 
                "\"\<_N\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.dat\>\""}], 
               ",", "Q"}], "]"}], ";", 
             RowBox[{"stopForExport", "=", 
              RowBox[{"stopForExport", "+", "exportCounter"}]}]}], ",", "0"}],
            "]"}]}]}], "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"endtime", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.728689581518546*^9, 3.728689615312394*^9}, 
   3.7286941647736464`*^9, {3.728695737261636*^9, 3.7286957380791807`*^9}, {
   3.72869585929565*^9, 3.728695955553832*^9}, {3.728696081194812*^9, 
   3.728696092176812*^9}, {3.728696215164219*^9, 3.728696231322385*^9}, 
   3.728696359787573*^9, {3.728739570779256*^9, 3.7287395858067703`*^9}, {
   3.7287396194999657`*^9, 3.728739653525442*^9}, {3.728739683790032*^9, 
   3.728739785361299*^9}, {3.728740028520664*^9, 3.728740075946369*^9}, {
   3.7287409427356253`*^9, 3.7287409682726603`*^9}, {3.728741070309183*^9, 
   3.728741071042869*^9}, {3.728741176006822*^9, 3.728741177572742*^9}, 
   3.728741540909439*^9, {3.728742299252442*^9, 3.728742311779398*^9}, {
   3.728742350947892*^9, 3.728742513041638*^9}, {3.728748005735429*^9, 
   3.728748026855509*^9}, {3.728748139820073*^9, 3.7287482061088133`*^9}, {
   3.7287482493597527`*^9, 3.728748377458127*^9}, {3.7287489006699457`*^9, 
   3.728748921357315*^9}, {3.728753223241434*^9, 3.7287532240787153`*^9}, 
   3.728753361788067*^9, {3.72891523714695*^9, 3.728915293420721*^9}, {
   3.728915354061791*^9, 3.7289153587506227`*^9}, {3.728915520978806*^9, 
   3.728915667848031*^9}, {3.728915773771941*^9, 3.728915895108242*^9}, {
   3.7289177452810583`*^9, 3.72891775492566*^9}, {3.728917846513974*^9, 
   3.7289178612014236`*^9}, {3.728917909186531*^9, 3.728918061351039*^9}, {
   3.728918105148635*^9, 3.7289181285534687`*^9}, {3.728918209421192*^9, 
   3.7289183170966597`*^9}, {3.7289185020005817`*^9, 3.72891850786688*^9}, {
   3.7289196442425222`*^9, 3.728919664926812*^9}, {3.7289197070430527`*^9, 
   3.728919834548545*^9}, {3.728923389818783*^9, 3.72892340904414*^9}, {
   3.728925246691921*^9, 3.728925374951153*^9}, {3.72892540690519*^9, 
   3.728925448091036*^9}, {3.7289254893062696`*^9, 3.728925524561845*^9}, 
   3.728925757356737*^9, 3.728926602512512*^9, 3.72892670521178*^9, 
   3.729340917802877*^9, {3.729533875029812*^9, 3.729533893507629*^9}, {
   3.729534031243046*^9, 3.7295340545844717`*^9}, {3.729534200619631*^9, 
   3.72953420520735*^9}, {3.729614326394968*^9, 3.729614328232863*^9}, {
   3.729614398289344*^9, 3.729614409024219*^9}, {3.729614469876074*^9, 
   3.729614511117608*^9}, {3.729614577855783*^9, 3.7296145817400293`*^9}, {
   3.7296147800442133`*^9, 3.729614781999806*^9}, {3.729614854526167*^9, 
   3.729614856616632*^9}, {3.72961489971248*^9, 3.729614902637236*^9}, {
   3.729707617625288*^9, 3.729707617882737*^9}, {3.729707660884027*^9, 
   3.729707669190926*^9}, 3.7297077158432198`*^9, {3.729707750330661*^9, 
   3.729707802268156*^9}, {3.7297078879492207`*^9, 3.729707888260158*^9}, {
   3.729709282810712*^9, 3.729709286506531*^9}, {3.729709316812042*^9, 
   3.7297094005841427`*^9}, {3.729709803017239*^9, 3.7297098368363132`*^9}, {
   3.729802896816659*^9, 3.7298029127892437`*^9}, 3.729868735880642*^9, {
   3.729871333840446*^9, 3.729871357865073*^9}, 3.729877347717465*^9, 
   3.7298785295592937`*^9, {3.7299584798661013`*^9, 3.729958506525893*^9}, 
   3.729958539918836*^9, {3.729958781254201*^9, 3.7299588185663*^9}, 
   3.7299590718299723`*^9, {3.729959375706689*^9, 3.729959409022285*^9}, {
   3.729959920158019*^9, 3.729959962894096*^9}, {3.7299717372982407`*^9, 
   3.729971822614258*^9}, {3.729979172293437*^9, 3.729979172828383*^9}, {
   3.729979437258952*^9, 3.729979455339877*^9}, {3.7299795484154663`*^9, 
   3.729979548744803*^9}, {3.7299799251779203`*^9, 3.729979932117083*^9}, {
   3.730026407768024*^9, 3.7300264111976748`*^9}, {3.730026489889102*^9, 
   3.73002649957132*^9}, {3.730027572016412*^9, 3.730027579867453*^9}, {
   3.730055615691948*^9, 3.7300556543129*^9}, {3.7300566190576267`*^9, 
   3.730056625044524*^9}, {3.73005690551342*^9, 3.730056962231593*^9}, {
   3.730057014587667*^9, 3.730057115733994*^9}, {3.730057314182654*^9, 
   3.730057325026668*^9}, {3.730057483177136*^9, 3.730057536263739*^9}, {
   3.730057700530176*^9, 3.730057705199697*^9}, {3.7300578870454884`*^9, 
   3.730057887239399*^9}, {3.73005851625852*^9, 3.730058519168083*^9}, {
   3.73012666050305*^9, 3.730126674847342*^9}, 3.7301267366694593`*^9, {
   3.730126880720625*^9, 3.730126884062903*^9}, 3.7301439547402477`*^9, {
   3.730414391555894*^9, 3.730414412721047*^9}, {3.730415424482593*^9, 
   3.7304154415607452`*^9}, {3.730415764372644*^9, 3.7304157648040533`*^9}, 
   3.730459447498063*^9, 3.730460856851231*^9, {3.730461499132008*^9, 
   3.730461509765209*^9}, {3.730482482961628*^9, 3.730482503597061*^9}, {
   3.7304835757708406`*^9, 3.73048359621646*^9}, {3.730484477644745*^9, 
   3.7304844798973207`*^9}, 3.730488419918128*^9, {3.730490341342449*^9, 
   3.730490352564644*^9}, {3.7304913270075283`*^9, 3.73049134152775*^9}, {
   3.730491686346582*^9, 3.730491707138983*^9}, 3.730492581392087*^9, {
   3.730507137512926*^9, 3.730507152249349*^9}, {3.730509425029668*^9, 
   3.730509485196582*^9}, {3.730546877767254*^9, 3.7305468994294767`*^9}, 
   3.730549352400691*^9, {3.730561679629273*^9, 3.7305616839479237`*^9}, {
   3.730562686271266*^9, 3.730562686551676*^9}, {3.730562870066699*^9, 
   3.730562879186696*^9}, {3.730563284552273*^9, 3.730563291975011*^9}, {
   3.730563726306808*^9, 3.7305637410337467`*^9}, {3.730713249069837*^9, 
   3.730713249416389*^9}, {3.7307189491826344`*^9, 3.730718949487966*^9}, {
   3.7307198174241333`*^9, 3.730719826267559*^9}, {3.7307333841787653`*^9, 
   3.7307334152316504`*^9}, {3.730738930118737*^9, 3.730738930252907*^9}, {
   3.7307389646444483`*^9, 3.7307389694095707`*^9}, {3.730739007888445*^9, 
   3.730739013468151*^9}, {3.7307403166126747`*^9, 3.730740316985468*^9}, {
   3.730740396842434*^9, 3.7307404002454576`*^9}, {3.730740763371683*^9, 
   3.730740767073338*^9}, {3.7307476369893293`*^9, 3.7307476437315073`*^9}, {
   3.73074780356357*^9, 3.730747806955146*^9}, {3.7307478837857857`*^9, 
   3.730747933135504*^9}, {3.730748009569006*^9, 3.730748015150573*^9}, {
   3.730904529121311*^9, 3.730904531455433*^9}, {3.7309047507744837`*^9, 
   3.7309047509841013`*^9}, {3.730904869562533*^9, 3.730904885142518*^9}, {
   3.730905057668766*^9, 3.730905070513611*^9}, {3.730906390301345*^9, 
   3.7309064015154047`*^9}, {3.730906470350726*^9, 3.730906494012581*^9}, {
   3.730906533263646*^9, 3.730906567968755*^9}, {3.730906711012601*^9, 
   3.730906791674972*^9}, {3.730906880175077*^9, 3.730906885390724*^9}, {
   3.730907091128996*^9, 3.730907093498013*^9}, {3.7309073980219*^9, 
   3.730907398273355*^9}, {3.7309075279285192`*^9, 3.730907628536096*^9}, {
   3.731064895221716*^9, 3.731064914618842*^9}, {3.731064973889358*^9, 
   3.731065002729374*^9}, {3.731065094487329*^9, 3.7310650999229727`*^9}, {
   3.731065149861177*^9, 3.731065163188781*^9}, {3.731066338871211*^9, 
   3.7310663412986317`*^9}, {3.731066481879766*^9, 3.7310664874466467`*^9}, 
   3.73106689879779*^9, {3.731068248391036*^9, 3.7310682701461143`*^9}, {
   3.731068563062964*^9, 3.7310685634034967`*^9}, {3.731150341784704*^9, 
   3.731150342901146*^9}, {3.7311504471938677`*^9, 3.731150473017034*^9}, {
   3.731691745857808*^9, 3.7316917516828947`*^9}, {3.7317690505910673`*^9, 
   3.731769051587451*^9}, {3.7317709367379704`*^9, 3.731770938399763*^9}, {
   3.7317775788836737`*^9, 3.7317775798831787`*^9}, {3.731791737212124*^9, 
   3.731791737454773*^9}, {3.7318355339586687`*^9, 3.731835534898444*^9}, {
   3.7318355771312647`*^9, 3.731835579429645*^9}, {3.731839533777299*^9, 
   3.731839534776393*^9}, {3.7318400108349247`*^9, 3.731840017212468*^9}, 
   3.731840226555291*^9, {3.731840519997286*^9, 3.731840572667068*^9}, {
   3.7318411584878283`*^9, 3.7318411591175213`*^9}, {3.731857387146723*^9, 
   3.7318573940208817`*^9}, {3.731858306391819*^9, 3.731858312595949*^9}, {
   3.731865872197166*^9, 3.731865874414562*^9}, 3.73186610164261*^9, 
   3.731866225998015*^9, {3.731867629245284*^9, 3.731867641864797*^9}, 
   3.731867765421174*^9, {3.731868283900235*^9, 3.73186828813937*^9}, {
   3.731883892961535*^9, 3.731883925390669*^9}, {3.7319264113656282`*^9, 
   3.731926420983573*^9}, {3.731940541239169*^9, 3.731940543980365*^9}, {
   3.731946136504448*^9, 3.731946139780114*^9}, {3.731946320866596*^9, 
   3.73194635699356*^9}, {3.732377932223506*^9, 3.732377936795772*^9}, {
   3.732455955478018*^9, 3.732455994450157*^9}, {3.7324603636102858`*^9, 
   3.732460402243087*^9}, {3.732461182968706*^9, 3.732461380451458*^9}, {
   3.7324845700343723`*^9, 3.732484624080113*^9}, {3.732485082161111*^9, 
   3.732485087080131*^9}, {3.732489262782976*^9, 3.732489296980488*^9}, {
   3.7324894277269173`*^9, 3.7324894281582413`*^9}, {3.732489746270802*^9, 
   3.732489825746612*^9}, {3.732489987049328*^9, 3.732490014810935*^9}, {
   3.73249019904748*^9, 3.732490216806916*^9}, 3.7325316166122503`*^9, 
   3.732531653470093*^9},ExpressionUUID->"4dc003ee-612b-4828-9f2b-\
4032c32bfd92"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve","ivres",
   "\"NDSolve has computed initial values that give a zero residual for the \
differential-algebraic system, but some components are different from those \
specified. If you need them to be satisfied, giving initial conditions for \
all dependent variables and their derivatives is recommended.\"",2,130,2,
   32521972203821792555,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73248506590364*^9, 3.7324881612038593`*^9, 
  3.7324907913058558`*^9, 
  3.732532246408299*^9},ExpressionUUID->"c021fae3-4abc-4f0d-a74a-\
08ed226365a4"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve","ivres",
   "\"NDSolve has computed initial values that give a zero residual for the \
differential-algebraic system, but some components are different from those \
specified. If you need them to be satisfied, giving initial conditions for \
all dependent variables and their derivatives is recommended.\"",2,130,3,
   32521972203821792555,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73248506590364*^9, 3.7324881612038593`*^9, 
  3.7324907913058558`*^9, 
  3.732532254931262*^9},ExpressionUUID->"9682c39a-6c13-4b48-b5c6-\
242ba12d3215"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totaltime", "=", 
  RowBox[{"endtime", "-", "begintime"}]}]], "Input",
 CellChangeTimes->{{3.732455999908149*^9, 
  3.732456011839985*^9}},ExpressionUUID->"1130e97d-a458-4321-b5f2-\
27aa082a5cdc"],

Cell[BoxData["2779.778424`9.895555173202096"], "Output",
 CellChangeTimes->{3.7324582019150553`*^9, 3.73248860227323*^9, 
  3.7325348638290157`*^9},ExpressionUUID->"a772d236-033f-4f19-b769-\
f0c3db2cbcea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totaltime", "/", "3600"}]], "Input",
 CellChangeTimes->{{3.7325355876838493`*^9, 
  3.7325355991798964`*^9}},ExpressionUUID->"e6c76bf8-01be-4680-8e2d-\
b202abd5fa06"],

Cell[BoxData["0.77216067333333333333333132780024805126`9.895555173202096"], \
"Output",
 CellChangeTimes->{
  3.7325356032453213`*^9},ExpressionUUID->"e71dba36-f4e0-433b-ab54-\
517cb9903bcf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Qfinal", "=", "Q"}], ";"}]], "Input",
 CellChangeTimes->{{3.730546154714241*^9, 3.730546158865251*^9}, {
  3.731866016226417*^9, 
  3.731866017200563*^9}},ExpressionUUID->"9672bbd7-e465-46a1-830a-\
610748599b86"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Max", "[", "Q", "]"}]], "Input",
 CellChangeTimes->{{3.730739659925201*^9, 3.73073967817819*^9}, {
  3.7318660225786552`*^9, 
  3.731866066930258*^9}},ExpressionUUID->"4d66925c-37ce-4517-8b3e-\
45e48468fb5a"],

Cell[BoxData["0.663045657163945`"], "Output",
 CellChangeTimes->{{3.730739664749736*^9, 3.7307396809143972`*^9}, 
   3.730747691794179*^9, 3.730904602734899*^9, 3.730904957649291*^9, 
   3.730907741857482*^9, 3.731065979615584*^9, 3.731066390233138*^9, 
   3.7310666216713057`*^9, 3.731066947686882*^9, 3.731069122461606*^9, 
   3.731089239631509*^9, 3.731150829978674*^9, 3.7311523214541473`*^9, 
   3.731161131746951*^9, 3.731179780636619*^9, 3.7311804135836887`*^9, 
   3.731180755585161*^9, 3.731181083785935*^9, 3.731234140873343*^9, 
   3.731234654206003*^9, 3.7312373711199408`*^9, 3.731238247180006*^9, 
   3.731666812411997*^9, 3.731667398631722*^9, 3.7316801810295753`*^9, 
   3.731680368942072*^9, 3.731680488814941*^9, 3.731683979361298*^9, 
   3.731684804864583*^9, 3.731684990350533*^9, 3.731752426981979*^9, 
   3.731756649021496*^9, 3.731768637790471*^9, 3.7317712464771833`*^9, 
   3.731792188172103*^9, 3.73183391205698*^9, 3.73183535507012*^9, 
   3.7318412930121717`*^9, 3.731842940364883*^9, 3.7318441601651173`*^9, 
   3.731858043961993*^9, 3.731858475856186*^9, {3.7318660274789543`*^9, 
   3.731866069733735*^9}, 3.731868198604746*^9, 3.7318685520449867`*^9, 
   3.731946748016755*^9, 3.732041291200589*^9, 3.732380016189848*^9, 
   3.73245820262498*^9, 3.732488603611465*^9, 
   3.732534864527668*^9},ExpressionUUID->"c9e7bade-0899-4988-a880-\
b76e068dd052"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Policy Extraction and Simulation", "Subchapter",
 CellChangeTimes->{{3.730485014566964*^9, 3.7304850160497093`*^9}, {
  3.730486471705052*^9, 3.730486473994205*^9}, {3.730557238210308*^9, 
  3.7305572395047398`*^9}},ExpressionUUID->"d5a9f757-d75d-4f47-9a77-\
6fb6db6a0a42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"policyMatrix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", " ", "0.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]states", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s2", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]1states", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s3", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]1dotstates", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s4", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Phi]states", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.730490457856439*^9, 3.730490512897581*^9}, {
  3.730490687848831*^9, 
  3.730490742376869*^9}},ExpressionUUID->"42247895-2334-466b-ae1c-\
eeaf9e7a069c"],

Cell[BoxData[
 RowBox[{"policyMatrix", ";"}]], "Input",
 CellChangeTimes->{{3.730490947102388*^9, 3.730490949111775*^9}, 
   3.730490996993054*^9, {3.730491052994391*^9, 3.730491053884583*^9}, 
   3.7304911154456453`*^9, 3.7304912740896482`*^9, {3.730491304952795*^9, 
   3.7304913083828363`*^9}, 3.7304919571614637`*^9, {3.7304920283303747`*^9, 
   3.730492031402135*^9}, 3.73049245778585*^9, 3.730492511483047*^9, {
   3.730562548413651*^9, 
   3.7305625677010307`*^9}},ExpressionUUID->"047f02d4-9e5e-457e-bdc0-\
6b063c2c00f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"statePos", "=", 
    RowBox[{"getInitialPos", "[", 
     RowBox[{
     "\[Theta]states", ",", "\[Theta]1states", ",", "\[Theta]1dotstates", ",",
       "\[Phi]states"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"initialConditions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], 
      "}"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialConditions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]0", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newState", "\[Equal]", "\[Phi]0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfSol", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfActionPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfPhiPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfPhiDotPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfActions", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfMomentumPlots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"time", "=", "0"}], ",", 
   RowBox[{"time", "<", "lengthOfEpisode"}], ",", 
   RowBox[{"time", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Use", " ", "an", " ", "epsilon", " ", "of", " ", "zero", " ", "in", " ", 
     "the", " ", "chooseAction", " ", "function", " ", 
     RowBox[{"(", 
      RowBox[{"act", " ", "entirely", " ", "greedy"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"action", "=", 
     RowBox[{"chooseAction", "[", 
      RowBox[{"0.0", ",", "statePos", ",", "Qfinal"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfActions", ",", "action"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"solutionFinal", "=", 
     RowBox[{"takeActionReduced", "[", 
      RowBox[{
      "action", ",", "initialConditions", ",", "time", ",", "\[Phi]0"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"newState", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
            RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], ",", 
            RowBox[{"\[Phi]0", "+", 
             RowBox[{
              RowBox[{"action", "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", "\[Delta]t"}]}]}], "}"}], 
          "/.", "solutionFinal"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"t", "\[Rule]", " ", 
          RowBox[{"time", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"newState", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Use", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{"anglestates", ",", 
        RowBox[{"2", "pi"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"newState", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"newState", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"newState", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"2", "\[Pi]"}]}], "]"}], ",", 
       RowBox[{"newState", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"newState", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"action", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"newState", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Determine", " ", "which", " ", "discretized", " ", "state", " ", 
      "newState", " ", "is", " ", "closest", " ", 
      RowBox[{"to", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"newStatePos", "=", 
     RowBox[{"getClosestStatePos", "[", 
      RowBox[{"states", ",", "newState"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"statePos", "=", "newStatePos"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Generate", " ", "a", " ", "plot", " ", "for", " ", "the", " ", "state", 
      " ", "and", " ", "action", " ", "over", " ", "\[Delta]t"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfSol", ",", "solutionFinal"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"time", "\[Equal]", "0"}], ",", 
      RowBox[{"plotState", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", " ", 
             RowBox[{"y", "[", "t", "]"}], ",", " ", 
             RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}], "/.", 
           "solutionFinal"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", "time", ",", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
           "\"\<x[t] (m)\>\"", ",", "\"\<y[t] (m)\>\"", ",", 
            "\"\<\[Theta][t] (radians)\>\""}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Green", ",", "Red"}], "}"}]}]}], "]"}]}], 
      ",", 
      RowBox[{"plotState", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", " ", 
             RowBox[{"y", "[", "t", "]"}], ",", " ", 
             RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}], " ", "/.", 
           "solutionFinal"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", "time", ",", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Green", ",", "Red"}], "}"}]}]}], "]"}]}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfPlots", ",", "plotState"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"time", "\[Equal]", "0"}], ",", 
      RowBox[{"plotAction", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{"action", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "time", ",", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", " ", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<k1[t] (Nms/(radian))\>\"", ",", 
            "\"\<\[Phi]'[t] (radians)\>\""}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Cyan", ",", "Magenta"}], "}"}]}]}], "]"}]}], ",", 
      RowBox[{"plotAction", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{"action", ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "time", ",", " ", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Cyan", ",", "Magenta"}], "}"}]}]}], "]"}]}]}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfActionPlots", ",", "plotAction"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Compute", " ", "the", " ", "momenta"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"momentum", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2", ",", "J3"}], "}"}], "/.", 
            "ellipseMasses"}], "/.", 
           RowBox[{"{", 
            RowBox[{"k1", "\[Rule]", " ", 
             RowBox[{"action", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"\[Rho]", "\[Rule]", "1000"}], "}"}]}], "/.", 
         "robotParameters"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", "\[Phi]0"}], "}"}]}], 
       "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Rule]", 
         RowBox[{"action", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "/.", 
      "solutionFinal"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"time", "\[Equal]", "0"}], ",", 
      RowBox[{"plotMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "momentum", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "time", ",", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<J1\>\"", ",", "\"\<J2\>\"", ",", "\"\<J3\>\""}], 
           "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Momentum\>\"", ",", "\"\<t\>\""}], "}"}]}]}], "]"}]}],
       ",", 
      RowBox[{"plotMom", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "momentum", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "time", ",", " ", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}]}]}], "]"}]}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"listOfMomentumPlots", ",", "plotMom"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"initialConditions", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{"x", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{"y", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", " ", 
              RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "'"}], "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"x", "'"}], "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"y", "'"}], "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"y", "'"}], "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[Theta]1", "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]1", "'"}], "[", 
               RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}], "}"}], "/.", 
           "solutionFinal"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", 
           RowBox[{"time", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "*)"}], 
    RowBox[{"initialConditions", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
             RowBox[{"x", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
             RowBox[{"y", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", " ", 
             RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{"\[Theta]1", "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
             RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]1", "'"}], "[", 
              RowBox[{"time", "+", "\[Delta]t"}], "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}]}], "}"}], "/.", 
          "solutionFinal"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"t", "\[Rule]", 
          RowBox[{"time", "+", "\[Delta]t"}]}], "}"}]}], ")"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7305459735720673`*^9, 3.730545997356604*^9}, {
   3.730546062992964*^9, 3.7305461059518833`*^9}, {3.7305462547196608`*^9, 
   3.730546342625689*^9}, {3.7305463988683023`*^9, 3.7305465047599497`*^9}, {
   3.730546562953166*^9, 3.730546563348489*^9}, {3.7305469417511263`*^9, 
   3.730546999382121*^9}, 3.730547065063829*^9, {3.7305471919884233`*^9, 
   3.730547192435595*^9}, {3.7305481174003277`*^9, 3.730548157809441*^9}, {
   3.73054819831284*^9, 3.730548210962347*^9}, {3.7305482500286713`*^9, 
   3.7305482757602043`*^9}, {3.730548542544187*^9, 3.730548543418495*^9}, {
   3.730548600332094*^9, 3.730548600573841*^9}, 3.7305486672841988`*^9, {
   3.730548895522614*^9, 3.730548909316194*^9}, {3.730548953226276*^9, 
   3.730548960055077*^9}, 3.730549357741788*^9, {3.730550463688058*^9, 
   3.73055048149841*^9}, 3.7305505403460093`*^9, {3.730550688932036*^9, 
   3.7305507774942827`*^9}, {3.7305513392651443`*^9, 
   3.7305513687293253`*^9}, {3.7305520761838427`*^9, 3.730552098470697*^9}, {
   3.730552340271144*^9, 3.730552473223178*^9}, {3.73055250465972*^9, 
   3.730552530617074*^9}, {3.730552746587205*^9, 3.730552757349846*^9}, 
   3.730553195848987*^9, {3.73055343723001*^9, 3.730553439916617*^9}, {
   3.730553506513101*^9, 3.7305535181119833`*^9}, 3.7305536731407757`*^9, {
   3.730553829351698*^9, 3.7305538297801723`*^9}, {3.7305543843746443`*^9, 
   3.730554519609355*^9}, {3.730557521375916*^9, 3.730557533020211*^9}, {
   3.7305616261990128`*^9, 3.730561629643557*^9}, {3.730562594263714*^9, 
   3.730562605074683*^9}, {3.730562650456107*^9, 3.7305626579764633`*^9}, {
   3.730562823127626*^9, 3.7305628343366823`*^9}, {3.7305632977202168`*^9, 
   3.7305633013668633`*^9}, {3.730563493173896*^9, 3.730563501550852*^9}, {
   3.7305636223718433`*^9, 3.73056362510673*^9}, {3.730563850219544*^9, 
   3.7305638578640614`*^9}, {3.730563944931015*^9, 3.730563945198029*^9}, {
   3.730564407190024*^9, 3.7305644242957973`*^9}, {3.730567517368486*^9, 
   3.73056756688341*^9}, {3.7305678747816563`*^9, 3.730567906250959*^9}, {
   3.730713099141921*^9, 3.7307131030252333`*^9}, {3.730713507544539*^9, 
   3.730713511500231*^9}, {3.7307167956842337`*^9, 3.730716802978016*^9}, {
   3.730717543355204*^9, 3.730717552638523*^9}, {3.730717625868754*^9, 
   3.730717643596508*^9}, {3.7307177132354383`*^9, 3.7307177348081636`*^9}, {
   3.7307179791549463`*^9, 3.730717993106646*^9}, {3.730718037296219*^9, 
   3.730718054826284*^9}, {3.7307198753462954`*^9, 3.730719880571014*^9}, {
   3.730719928095852*^9, 3.730719947310933*^9}, {3.730725999354559*^9, 
   3.730726021321785*^9}, {3.730726091287776*^9, 3.730726310957786*^9}, {
   3.7307263813192596`*^9, 3.730726385540421*^9}, {3.730733316615975*^9, 
   3.730733371349413*^9}, {3.7307402783173428`*^9, 3.7307402787751904`*^9}, {
   3.730740944001623*^9, 3.730740970953299*^9}, {3.730905012253633*^9, 
   3.73090504524997*^9}, {3.7309054109852953`*^9, 3.730905480904007*^9}, {
   3.7309080504879208`*^9, 3.730908134051876*^9}, {3.731065175564323*^9, 
   3.731065198586803*^9}, {3.731065266059454*^9, 3.7310652935940104`*^9}, {
   3.731068324901758*^9, 3.731068330626403*^9}, {3.731068447561943*^9, 
   3.731068453991548*^9}, {3.7310688746132307`*^9, 3.73106889278771*^9}, {
   3.7310695580206842`*^9, 3.731069562533399*^9}, {3.7310888835897293`*^9, 
   3.731088887789713*^9}, 3.7311505631996717`*^9, {3.731150634701579*^9, 
   3.731150636843803*^9}, {3.731150976796076*^9, 3.731150980536997*^9}, 
   3.731152604705617*^9, {3.731701088123979*^9, 3.731701149900114*^9}, {
   3.7317012626707783`*^9, 3.7317013763604794`*^9}, {3.731702728730996*^9, 
   3.7317027803693323`*^9}, {3.731703506632496*^9, 3.7317035098529673`*^9}, {
   3.731703555214724*^9, 3.731703556326046*^9}, {3.731705952914575*^9, 
   3.731705954549706*^9}, {3.731706089109084*^9, 3.731706106932028*^9}, {
   3.7317061502080097`*^9, 3.731706170179904*^9}, {3.7317062728511877`*^9, 
   3.7317062766945677`*^9}, 3.731753044996395*^9, {3.731753442605217*^9, 
   3.731753457536634*^9}, {3.731753593717779*^9, 3.731753618554467*^9}, {
   3.731754639455523*^9, 3.73175463958222*^9}, {3.73175488627264*^9, 
   3.731754948817451*^9}, {3.731754982229828*^9, 3.7317549853720903`*^9}, {
   3.7317551219613733`*^9, 3.731755128247864*^9}, {3.731755169785754*^9, 
   3.731755206713382*^9}, {3.731756123554084*^9, 3.73175612544068*^9}, {
   3.731760608484229*^9, 3.731760646101158*^9}, {3.73176113882404*^9, 
   3.7317611442107897`*^9}, {3.731761398526168*^9, 3.73176144705375*^9}, {
   3.73176154841798*^9, 3.7317616101101503`*^9}, {3.731761690580051*^9, 
   3.731761692687572*^9}, {3.731761730082058*^9, 3.73176173212455*^9}, {
   3.7317690599388123`*^9, 3.731769060739099*^9}, {3.731770929378722*^9, 
   3.7317709312657957`*^9}, {3.731796769389903*^9, 3.731796773369732*^9}, {
   3.731833226958516*^9, 3.73183323103568*^9}, {3.7318333485596037`*^9, 
   3.73183335838748*^9}, {3.731833437984645*^9, 3.7318334446412086`*^9}, {
   3.7318351031119833`*^9, 3.731835128471099*^9}, {3.7318393262672453`*^9, 
   3.731839364529031*^9}, {3.731839430959543*^9, 3.7318394479058323`*^9}, {
   3.731840597472514*^9, 3.731840637664463*^9}, {3.731841353622315*^9, 
   3.731841354658901*^9}, {3.731841989059877*^9, 3.7318420135339737`*^9}, 
   3.731842099080724*^9, {3.731842166713674*^9, 3.7318421722653027`*^9}, {
   3.731843207461866*^9, 3.731843209443447*^9}, {3.731843841496307*^9, 
   3.731843874081119*^9}, 3.73184555911031*^9, {3.731845710183393*^9, 
   3.731845717320092*^9}, {3.7318468368537827`*^9, 3.731846845431086*^9}, {
   3.731846950188971*^9, 3.731846982872272*^9}, {3.731847107441374*^9, 
   3.7318471320123253`*^9}, 3.731851850577132*^9, 3.731857410394494*^9, {
   3.731858271468171*^9, 3.7318582938310223`*^9}, 3.731867754415841*^9, {
   3.731868383216827*^9, 3.731868390303733*^9}, 3.731869039602993*^9, {
   3.731869169398052*^9, 3.731869180516755*^9}, {3.732038740492119*^9, 
   3.732038872212875*^9}, {3.732039007864201*^9, 3.732039059771248*^9}, {
   3.7324602152128572`*^9, 
   3.732460225448893*^9}},ExpressionUUID->"1c95b521-2b97-4565-a5d3-\
94c5be64768b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trajectories", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"listOfPlots", ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.730548296087528*^9, 3.730548306928697*^9}, {
  3.7305484604394007`*^9, 3.73054850436032*^9}, {3.73054854658587*^9, 
  3.730548546812771*^9}, {3.730548581391212*^9, 3.7305486319785833`*^9}, {
  3.732040454054358*^9, 
  3.73204046040199*^9}},ExpressionUUID->"bdbf03fb-9701-46be-aa2c-\
9223a09a2698"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
    "\"\<trajectories\>\"", "<>", "timeAndDateString", "<>", "\"\<.pdf\>\""}],
     ",", "trajectories"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.732040465444656*^9, 
  3.732040511657106*^9}},ExpressionUUID->"142d5897-49d9-47c2-90a8-\
d44d3eb3d2b4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Show", "[", 
   RowBox[{"listOfMomentumPlots", ",", 
    RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.731703418755691*^9, 3.731703428098918*^9}, {
   3.7317601977098827`*^9, 3.7317602194169407`*^9}, 
   3.732039081347639*^9},ExpressionUUID->"3aa7249e-7c38-46e2-a516-\
ac888f828455"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]Dots", "=", 
   RowBox[{"Last", "/@", "listOfActions"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7311656724991198`*^9, 
  3.73116568597458*^9}},ExpressionUUID->"e6a3a979-e229-463f-837b-\
21208aaeb9b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"t\[Phi]dotpairs", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
      "@", 
      RowBox[{"(", 
       RowBox[{"Last", "/@", "listOfActions"}], ")"}]}], ",", "2"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.731165860601141*^9, 3.731165880905389*^9}, {
   3.731165972922289*^9, 3.731166038200452*^9}, {3.73116609063138*^9, 
   3.731166092624798*^9}, {3.731166126299718*^9, 3.73116614978414*^9}, {
   3.7311661821949883`*^9, 3.7311661857004623`*^9}, {3.7311662229546127`*^9, 
   3.731166277399712*^9}, {3.731166358325531*^9, 3.731166358808284*^9}, 
   3.731847067590686*^9},ExpressionUUID->"7d0c76e9-1796-4be1-b71a-\
daabe027d53a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"this", "=", 
   RowBox[{"t\[Phi]dotpairs", "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"thyme_Integer", ",", "rate_Real"}], "}"}], "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"rate", ",", 
       RowBox[{"(", 
        RowBox[{"t", "<", "thyme"}], ")"}]}], "}"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731166432533461*^9, 3.731166453716076*^9}, {
   3.731166522691455*^9, 3.731166559934615*^9}, {3.73116659668333*^9, 
   3.731166598543702*^9}, {3.731166676937408*^9, 3.7311667987092333`*^9}, {
   3.7311668372165937`*^9, 3.7311668718868837`*^9}, {3.7311670645022306`*^9, 
   3.731167075704624*^9}, {3.7311671311129713`*^9, 3.731167131858691*^9}, 
   3.731847070247054*^9},ExpressionUUID->"cfff931f-76c5-4d6f-99d4-\
ff5c8bbfb94e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]dot", "[", "t_", "]"}], ":=", 
   RowBox[{"Piecewise", "/@", 
    RowBox[{"{", "this", "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7311681335798388`*^9, 3.731168142447639*^9}, {
  3.7311682277302713`*^9, 3.731168238688672*^9}, {3.731179484812057*^9, 
  3.731179486672619*^9}, {3.731179841691987*^9, 3.731179842887322*^9}, {
  3.731234579106222*^9, 3.731234586062166*^9}, {3.73123933714892*^9, 
  3.731239340365397*^9}, {3.731239372270361*^9, 3.7312393815180683`*^9}, {
  3.7312394123995447`*^9, 
  3.73123941385433*^9}},ExpressionUUID->"2eaf9703-52d5-4e90-b879-\
0f1fe3b52c9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timelist", "=", 
   RowBox[{"Range", "[", "lengthOfEpisode", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731667595986527*^9, 3.7316676076963577`*^9}, 
   3.73166990697838*^9},ExpressionUUID->"d67541cb-dcc7-4c6d-9e44-\
8bd74314674a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]solved", "[", 
    RowBox[{"t_", ",", "tlower_", ",", "tupper_"}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"\[Phi]dot", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "tlower", ",", "tupper"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.731179491268333*^9, 3.731179495912167*^9}, {
   3.731179549210397*^9, 3.73117955663127*^9}, {3.731179603831006*^9, 
   3.731179647008624*^9}, {3.731179922959622*^9, 3.731179927659565*^9}, {
   3.7311804932571907`*^9, 3.7311804935915003`*^9}, {3.731180582508214*^9, 
   3.731180584266721*^9}, {3.731180679389636*^9, 3.731180681581311*^9}, {
   3.731180821428081*^9, 3.7311808339698477`*^9}, {3.731181134763216*^9, 
   3.731181134938772*^9}, {3.731234089592911*^9, 3.731234092498021*^9}, {
   3.731234611263281*^9, 3.731234611374366*^9}, {3.7312346735694847`*^9, 
   3.731234680879096*^9}, 3.731234736467456*^9, {3.7312348103408318`*^9, 
   3.7312348105799932`*^9}, {3.7312359050651703`*^9, 3.731235914821301*^9}, {
   3.731235957400228*^9, 3.731235959559423*^9}, {3.7312369139572287`*^9, 
   3.7312369506601048`*^9}, {3.7312370830488443`*^9, 
   3.7312370869843073`*^9}, {3.731237224700718*^9, 3.731237226332409*^9}, {
   3.731237303342245*^9, 3.731237303517447*^9}, 3.7312374044184027`*^9, {
   3.731237508230212*^9, 3.7312375157171593`*^9}, {3.731237547878291*^9, 
   3.731237554742277*^9}, {3.731237886577649*^9, 3.731237907905055*^9}, {
   3.731239005971437*^9, 3.731239026804316*^9}, {3.7316670062879057`*^9, 
   3.731667011481933*^9}, 3.731667096812367*^9, {3.731667129672323*^9, 
   3.731667143863616*^9}},ExpressionUUID->"bb4c9037-f754-46e9-9067-\
a5269256c3bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]ForAnimation", "=", 
   RowBox[{"ListInterpolation", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]solved", "[", 
        RowBox[{"t", ",", "0", ",", "#"}], "]"}], "&"}], "/@", "timelist"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "lengthOfEpisode"}], "}"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.731667247365819*^9, 3.7316672763250628`*^9}, {
  3.7316673271734743`*^9, 3.731667351140431*^9}, {3.7316675681467953`*^9, 
  3.731667576352302*^9}, {3.731667613633209*^9, 3.731667656110353*^9}, {
  3.7316678254785147`*^9, 3.731667825638311*^9}, {3.731680405470627*^9, 
  3.731680406355886*^9}},ExpressionUUID->"fb3d654b-e1f1-45dc-8f97-\
ac22dff2765d"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"t\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"1.00000001793518215981500002268375355655993796943903362262062728405`65.\
954589770191\\\", \\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"6.938893903907228`*^-18\\\"}]\\) and \\!\\(\\*RowBox[{\\\
\"2.311210801005933`*^-13\\\"}]\\) for the integral and error estimates.\"",2,
   158,4,32521972203821792555,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.732458326033659*^9, 3.732488752595746*^9, 
  3.732534986966555*^9},ExpressionUUID->"0a28ebef-841b-4a52-82db-\
0fc7d7265855"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"t\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"t\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"2.9999999641296356803699999546324928868801240611219327547587454319`65.\
954589770191\\\", \\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"1.3877787807814457`*^-17\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"4.622421602011866`*^-13\\\"}]\\) for the integral and \
error estimates.\"",2,158,5,32521972203821792555,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.732458326033659*^9, 3.732488752595746*^9, 
  3.7325349870750237`*^9},ExpressionUUID->"78289c00-f8b3-4f49-af3b-\
4f28ae75a891"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]plot", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"\[Phi]ForAnimation", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7316670216743803`*^9, 3.7316670484270067`*^9}, {
   3.7316671184110737`*^9, 3.731667118727869*^9}, {3.731667777526396*^9, 
   3.7316678398946877`*^9}, {3.731669816431732*^9, 3.731669819119606*^9}, 
   3.7320391074543457`*^9},ExpressionUUID->"901486ef-9ff8-43a2-b420-\
9fc339d9cfe6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
    "\"\<phiplot\>\"", "<>", "timeAndDateString", "<>", "\"\<.pdf\>\""}], ",",
     "\[Phi]plot"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7320391102674627`*^9, 3.732039126171934*^9}, {
  3.732040535394088*^9, 
  3.7320405473908167`*^9}},ExpressionUUID->"d8d21cf7-b3bf-4937-86fc-\
ff3a0a0c3d53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phidotplot", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Piecewise", "/@", 
      RowBox[{"{", "this", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "lengthOfEpisode"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7311671273374043`*^9, 3.731167134529758*^9}, {
  3.731167839113751*^9, 3.731167872165595*^9}, {3.73116794274573*^9, 
  3.7311679783931847`*^9}, {3.731684380632803*^9, 3.731684383102346*^9}, {
  3.732039166922161*^9, 
  3.7320391746391706`*^9}},ExpressionUUID->"3e7292e4-354f-4129-8510-\
43a3e23c7dd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
    "\"\<phidotplot\>\"", "<>", "timeAndDateString", "<>", "\"\<.pdf\>\""}], 
    ",", "phidotplot"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.732039177643392*^9, 3.732039201596756*^9}, {
  3.732040552867876*^9, 
  3.732040557665039*^9}},ExpressionUUID->"dc051f3f-e980-442d-bed8-\
d687d66f650d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"policy", "=", 
   RowBox[{"Show", "[", 
    RowBox[{"listOfActionPlots", ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.730567655470455*^9, 3.7305676568283167`*^9}, {
   3.732038913935688*^9, 3.732038916241417*^9}, 
   3.732039209556355*^9},ExpressionUUID->"2ddd474e-9bfd-4dc1-91e7-\
6cee43b5373f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
    "\"\<policy\>\"", "<>", "timeAndDateString", "<>", "\"\<.pdf\>\""}], ",", 
    "policy"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7320389013865643`*^9, 3.7320389768194017`*^9}, 
   3.7320392122997704`*^9, {3.732040562137924*^9, 
   3.732040571820416*^9}},ExpressionUUID->"596edc92-2c7e-48f8-a32b-\
04ab4b7ce78d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"movieFrameQ", "[", 
    RowBox[{"time_", ",", "step_"}], "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "body", ",", "head", ",", "tail", ",", "tailPivotLine1", ",", 
           "tailPivotDot", ",", "tailPivotLine2", ",", "headPivotDot", ",", 
           "headPivotLine1", ",", "headPivotLine2"}], "}"}], "/.", 
         "robotParameters"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"\[Phi]ForAnimation", "[", "t", "]"}]}], "}"}]}], "/.", 
       RowBox[{"listOfSol", "[", 
        RowBox[{"[", "step", "]"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"t", "\[Rule]", "time"}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"PlotRange", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"10", " ", "b"}], " ", "+", " ", "gap"}], ")"}]}], " ", 
           ",", " ", 
           RowBox[{
            RowBox[{"10", " ", "b"}], " ", "+", " ", "gap"}]}], "}"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"10", " ", "b"}], " ", "+", " ", "gap"}], " ", ")"}]}], 
           " ", ",", " ", 
           RowBox[{
            RowBox[{"10", " ", "b"}], " ", "+", " ", "gap"}]}], " ", "}"}]}], 
        "}"}]}], " ", "/.", " ", "robotParameters"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.719150903160173*^9, 3.7191510131601048`*^9}, {
   3.7191828271371727`*^9, 3.719182827781157*^9}, {3.719183963400749*^9, 
   3.719183993546331*^9}, {3.719324952013503*^9, 3.719324953253909*^9}, {
   3.72108949828334*^9, 3.7210895159116087`*^9}, {3.7210900247740297`*^9, 
   3.721090035016567*^9}, {3.722178813414523*^9, 3.7221788154923887`*^9}, {
   3.730549219840171*^9, 3.730549241134365*^9}, {3.730549478771351*^9, 
   3.730549487251011*^9}, {3.73054953467667*^9, 3.73054953480186*^9}, {
   3.7305498763816233`*^9, 3.730549911918644*^9}, {3.7305518750632677`*^9, 
   3.7305518801678743`*^9}, {3.730736253870204*^9, 3.730736278090927*^9}, {
   3.730736836866116*^9, 3.730736851356995*^9}, {3.730736913423464*^9, 
   3.730736918559566*^9}, {3.731109406217017*^9, 3.731109411583145*^9}, {
   3.731109535730575*^9, 3.731109542026417*^9}, {3.731152263732087*^9, 
   3.731152265164813*^9}, {3.731179656836619*^9, 3.731179688312112*^9}, 
   3.731179987012821*^9, 3.731237824447854*^9, {3.731238157709817*^9, 
   3.7312381856583967`*^9}, 3.731238313311742*^9, {3.731238464067048*^9, 
   3.731238464580855*^9}, {3.7312387264435062`*^9, 3.73123872666264*^9}, {
   3.731667667600869*^9, 3.731667671125161*^9}, {3.731667729743319*^9, 
   3.731667729919201*^9}, {3.731682970449203*^9, 3.731682988416163*^9}, {
   3.7316830688362427`*^9, 
   3.731683084034981*^9}},ExpressionUUID->"424e1bcd-9966-4f95-9cd4-\
6749d818636e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numberOfFrames", " ", "=", " ", "20"}], ";"}]], "Input",
 CellChangeTimes->{{3.719151019680471*^9, 3.719151025397862*^9}, 
   3.719151056118771*^9, {3.730740634224472*^9, 3.730740635065836*^9}, {
   3.731668788692629*^9, 3.7316687891711073`*^9}, {3.7316690573705893`*^9, 
   3.731669061639756*^9}, {3.731669135611772*^9, 3.731669135740073*^9}, {
   3.7316694979430237`*^9, 
   3.7316695002615023`*^9}},ExpressionUUID->"141e0c9b-4b7e-4328-af0b-\
f8f29e0338e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"movieFrames", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"movieFrameQ", "[", 
         RowBox[{"k", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"j", "-", "1"}], ",", "j", ",", 
          FractionBox["\[Delta]t", "numberOfFrames"]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "lengthOfEpisode"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.730738074299828*^9, 3.730738161749543*^9}, 
   3.7307382199612703`*^9, {3.730738302845745*^9, 3.730738308157305*^9}, {
   3.73073837137684*^9, 3.7307383779521523`*^9}, {3.731668263348434*^9, 
   3.731668264761877*^9}},ExpressionUUID->"1a505588-cc36-469f-85e1-\
442928ae30c2"],

Cell["\<\
The graphics issues thrown, I think, are a product of the objects pointing to \
states x[t], y[t], \[Theta][t], etc., and \[Phi][t] are different. All states \
except \[Phi][t] are InterpolatingFunctions while \[Phi][t] is not.\
\>", "Text",
 CellChangeTimes->{{3.731239489825165*^9, 
  3.731239574577621*^9}},ExpressionUUID->"c2297330-6fdc-4201-ba87-\
b5f493963881"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListAnimate", "[", "movieFrames", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.73073827209517*^9, 3.7307382781708097`*^9}, {
   3.730738464946306*^9, 3.730738465376524*^9}, {3.7307385213628263`*^9, 
   3.7307385220341988`*^9}, {3.7307385589156446`*^9, 3.730738582005795*^9}, 
   3.731066347168201*^9, {3.731180019847237*^9, 3.7311800217448807`*^9}, {
   3.731238532277028*^9, 3.731238535562408*^9}, 3.731668281077368*^9, 
   3.7317755644156933`*^9, 3.7318414986948957`*^9, 3.7318839656881847`*^9, 
   3.731948823305274*^9, 
   3.732039426026217*^9},ExpressionUUID->"495e88c9-fca2-4086-9291-\
fcc219b70330"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
    "\"\<threelink_vary_k_headspeed_\>\"", "<>", "timeAndDateString", "<>", 
     "\"\<.avi\>\""}], ",", "movieFrames", ",", 
    RowBox[{"\"\<FrameRate\>\"", "\[Rule]", " ", "20"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.731668128976362*^9, 3.731668182065098*^9}, {
   3.731668252055153*^9, 3.7316682523071833`*^9}, {3.731669394263279*^9, 
   3.731669394388237*^9}, {3.7316695178655977`*^9, 3.731669518887076*^9}, {
   3.731670267710436*^9, 3.7316702678688307`*^9}, 3.7316802226169367`*^9, {
   3.731683152150741*^9, 3.7316831662760973`*^9}, 3.731684792395947*^9, {
   3.7318464646954317`*^9, 3.731846470068903*^9}, 3.731846580864564*^9, {
   3.731869464652309*^9, 3.731869466263884*^9}, {3.731869511371046*^9, 
   3.7318695118989162`*^9}, 3.731883969646282*^9, {3.731948917121662*^9, 
   3.731948920640218*^9}, {3.731949008659952*^9, 3.731949040626864*^9}, {
   3.731949103905164*^9, 3.731949104509193*^9}, {3.7319491743720827`*^9, 
   3.731949174417349*^9}, 3.7320394298584127`*^9, {3.732040578928948*^9, 
   3.732040583289022*^9}},ExpressionUUID->"ea995f07-5952-4867-83b3-\
1ef5ee6bdcaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
    "\"\<Qmatrix_\>\"", "<>", "timeAndDateString", "<>", "\"\<.dat\>\""}], 
    ",", "Qfinal"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.732041672930606*^9, 
  3.732041704904112*^9}},ExpressionUUID->"54c4416e-6bc6-4245-98e0-\
7463803489f6"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.7325230042427273`*^9},ExpressionUUID->"1139b033-1882-40d3-be27-\
9276263fe084"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1036},
WindowMargins->{{Automatic, 1280}, {-53, Automatic}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 277, 5, 102, "Title", "ExpressionUUID" -> \
"972c159b-1ef8-4038-a76c-eb12eb2d9afa"],
Cell[CellGroupData[{
Cell[882, 31, 319, 6, 32, "Input", "ExpressionUUID" -> \
"765502d8-67b4-4f52-80dc-9ca82f99ab18"],
Cell[1204, 39, 347, 5, 32, "Output", "ExpressionUUID" -> \
"439e6aa6-ffef-4567-adea-0d5e14970763"]
}, Open  ]],
Cell[1566, 47, 198, 4, 32, "Input", "ExpressionUUID" -> \
"e405923e-bde1-4e02-9e85-20ab1de12425"],
Cell[1767, 53, 361, 7, 30, "Text", "ExpressionUUID" -> \
"6079f251-8e2f-4723-a84e-493989af1f49"],
Cell[2131, 62, 1810, 29, 32, "Input", "ExpressionUUID" -> \
"af7ec7e7-ded0-446d-af71-0b6a06ce8f11"],
Cell[3944, 93, 301, 9, 32, "Input", "ExpressionUUID" -> \
"ab6754d9-414c-414e-83cd-7ef7b7973cd7"],
Cell[4248, 104, 1253, 37, 32, "Input", "ExpressionUUID" -> \
"fc2e52a1-65c8-4c94-a3df-6299278c5d4a"],
Cell[5504, 143, 1582, 42, 32, "Input", "ExpressionUUID" -> \
"89597fee-ded8-4275-9a25-7a5a0d0d2c84"],
Cell[7089, 187, 852, 22, 32, "Input", "ExpressionUUID" -> \
"02f80c74-ca2d-44fd-b461-767e2b0dfcce"],
Cell[7944, 211, 780, 21, 32, "Input", "ExpressionUUID" -> \
"9836e676-578c-4523-ae6a-0b6ce331a978"],
Cell[8727, 234, 900, 23, 32, "Input", "ExpressionUUID" -> \
"bbc9ff36-0b98-41cd-b137-23e6d2d8058a"],
Cell[9630, 259, 362, 10, 32, "Input", "ExpressionUUID" -> \
"5f2306ce-7bc6-47f7-b7ca-9e99e98a32a4"],
Cell[9995, 271, 363, 10, 32, "Input", "ExpressionUUID" -> \
"7d4081bd-212f-434b-ab9f-9c6efd27bbf8"],
Cell[10361, 283, 374, 10, 32, "Input", "ExpressionUUID" -> \
"57e15ba2-897e-4635-a2e6-03a9b87ceb36"],
Cell[10738, 295, 781, 21, 32, "Input", "ExpressionUUID" -> \
"00bb100b-52f2-4556-a97f-29e327ee2706"],
Cell[11522, 318, 961, 25, 32, "Input", "ExpressionUUID" -> \
"1e55941d-cd89-4fef-88fc-8b7693e41ed5"],
Cell[12486, 345, 377, 10, 32, "Input", "ExpressionUUID" -> \
"07093537-df42-4b46-ad65-ab2c46661c69"],
Cell[12866, 357, 374, 10, 32, "Input", "ExpressionUUID" -> \
"51c6021b-a81e-49a1-9f22-6aada392197b"],
Cell[13243, 369, 374, 10, 32, "Input", "ExpressionUUID" -> \
"286b501b-3712-461f-8043-bf1ad75eeb28"],
Cell[13620, 381, 1002, 25, 32, "Input", "ExpressionUUID" -> \
"3aef94fc-d0f1-430c-b73b-9fe9aed44b52"],
Cell[14625, 408, 845, 21, 32, "Input", "ExpressionUUID" -> \
"3ea85d80-0f01-4ca7-a5fd-995533b87382"],
Cell[15473, 431, 331, 9, 32, "Input", "ExpressionUUID" -> \
"287b3d88-0ffc-4036-b588-cf7d66b0d035"],
Cell[15807, 442, 3383, 85, 96, "Input", "ExpressionUUID" -> \
"df0e87a6-f602-4492-b69d-7a0ffa495d07"],
Cell[CellGroupData[{
Cell[19215, 531, 300, 5, 75, "Chapter", "ExpressionUUID" -> \
"b6304e21-7a08-491c-9d19-d12d80ff7d1e"],
Cell[19518, 538, 490, 12, 32, "Input", "ExpressionUUID" -> \
"d3af6aaf-07fc-41cd-bb6c-6c3b4160abb7"],
Cell[20011, 552, 431, 12, 32, "Input", "ExpressionUUID" -> \
"2182a14a-fdd3-436b-abc9-3b99cebdb9c9"],
Cell[20445, 566, 532, 16, 32, "Input", "ExpressionUUID" -> \
"57f38b3a-3971-4dc4-b42a-b77f4bc2c5d0"],
Cell[20980, 584, 661, 18, 32, "Input", "ExpressionUUID" -> \
"74e526d6-1d19-46e3-8aa0-dec243997166"],
Cell[21644, 604, 1174, 33, 54, "Input", "ExpressionUUID" -> \
"7041702f-ecfa-497a-9301-603fb7f151c3"],
Cell[22821, 639, 1219, 35, 54, "Input", "ExpressionUUID" -> \
"f83ad41e-05e8-42d6-97ae-672eb6a07285"],
Cell[24043, 676, 784, 22, 47, "Input", "ExpressionUUID" -> \
"1f498509-9de9-4f1d-a607-7b30a7fa4774"],
Cell[24830, 700, 403, 9, 32, "Input", "ExpressionUUID" -> \
"20cd1eae-89cc-47c9-98b1-6f63b9bfaf12"],
Cell[25236, 711, 357, 8, 32, "Input", "ExpressionUUID" -> \
"121641db-d92b-4f06-b26f-605c564c57cd"],
Cell[25596, 721, 350, 8, 32, "Input", "ExpressionUUID" -> \
"ddf902bc-0639-4725-a483-a60d1da17d58"],
Cell[25949, 731, 866, 25, 49, "Input", "ExpressionUUID" -> \
"fa1a0b21-c0c9-487a-bd7f-693d7de51634"],
Cell[26818, 758, 888, 27, 49, "Input", "ExpressionUUID" -> \
"09babf5c-58e5-4e72-83c3-d4f50ab240c5"],
Cell[27709, 787, 1126, 30, 49, "Input", "ExpressionUUID" -> \
"58f2c0ac-f15f-4098-9bd7-256e1d339938"],
Cell[28838, 819, 500, 11, 49, "Input", "ExpressionUUID" -> \
"07416327-1742-453c-8abb-c593d02c13ed"],
Cell[29341, 832, 237, 4, 30, "Text", "ExpressionUUID" -> \
"9bb73871-6920-4e6a-aca5-7e5760691924"],
Cell[29581, 838, 438, 9, 32, "Input", "ExpressionUUID" -> \
"c7f636e3-44a9-4cd3-a037-ba64a9d1a5cf"],
Cell[30022, 849, 1876, 54, 32, "Input", "ExpressionUUID" -> \
"f6834e46-b73e-4d5c-b5c6-1776826761de"],
Cell[CellGroupData[{
Cell[31923, 907, 222, 5, 32, "Input", "ExpressionUUID" -> \
"95d3a84b-d0c6-4d70-9cc4-3bc664bbb82a"],
Cell[32148, 914, 8241, 117, 32, "Output", "ExpressionUUID" -> \
"ee60be63-5222-4167-a4c0-ef25e7b0eb65"]
}, Open  ]],
Cell[40404, 1034, 1756, 36, 61, "Text", "ExpressionUUID" -> \
"bd3d54fe-bff7-481b-8f7e-db5cfdb3e513"],
Cell[42163, 1072, 315, 8, 32, "Input", "ExpressionUUID" -> \
"06624722-45bd-4b63-b311-92f1e18e64f2"],
Cell[42481, 1082, 473, 12, 32, "Input", "ExpressionUUID" -> \
"a2703cc2-9fa7-4e16-a34d-cd3bf796f70e"],
Cell[42957, 1096, 243, 6, 32, "Input", "ExpressionUUID" -> \
"12fedbd9-c01c-4c44-b419-ce3b352ab33c"],
Cell[43203, 1104, 485, 12, 32, "Input", "ExpressionUUID" -> \
"4eba9901-237e-4933-bd54-a1a038c104ab"],
Cell[43691, 1118, 779, 13, 49, "Text", "ExpressionUUID" -> \
"56752aa5-b95d-4f49-a0a5-1d4bc85b907a"],
Cell[44473, 1133, 1162, 26, 32, "Input", "ExpressionUUID" -> \
"4f6003c7-204f-4667-af81-f2fa277e9fa1"],
Cell[45638, 1161, 886, 23, 32, "Input", "ExpressionUUID" -> \
"04a6fcac-ff7a-41a7-a6d7-d63e0d901179"],
Cell[46527, 1186, 788, 21, 32, "Input", "ExpressionUUID" -> \
"774e1970-de23-446b-977f-ea3f60a20096"],
Cell[47318, 1209, 919, 24, 32, "Input", "ExpressionUUID" -> \
"c961904b-22b8-4272-9845-849f48d97745"],
Cell[48240, 1235, 379, 9, 32, "Input", "ExpressionUUID" -> \
"0f5ab49d-4b29-44cc-9b66-d512aa87e728"],
Cell[48622, 1246, 208, 5, 32, "Input", "ExpressionUUID" -> \
"ae6ebfd9-a260-4389-b708-a603d905fdb7"],
Cell[48833, 1253, 397, 8, 32, "Input", "ExpressionUUID" -> \
"9bddcdf1-dba4-4cf6-9545-cd51af089b20"],
Cell[49233, 1263, 195, 5, 32, "Input", "ExpressionUUID" -> \
"e342ba2c-ec2e-44a6-872d-65627d9567d0"],
Cell[49431, 1270, 5333, 86, 75, "Input", "ExpressionUUID" -> \
"fed17696-2e1c-4e34-a9c5-99d1d4315613"],
Cell[54767, 1358, 239, 6, 30, "Text", "ExpressionUUID" -> \
"31a3cd5a-43c4-468d-952e-7b48de54102b"],
Cell[55009, 1366, 265, 6, 32, "Input", "ExpressionUUID" -> \
"afbc2866-ba39-4204-bd06-a2fc202e6b47"],
Cell[55277, 1374, 300, 7, 53, "Input", "ExpressionUUID" -> \
"adf8328f-10c2-4c70-9e8a-eac7631a59a0"],
Cell[55580, 1383, 2690, 72, 54, "Input", "ExpressionUUID" -> \
"0b11ede0-2b8c-44cd-892b-422dfc5d365a"],
Cell[58273, 1457, 1053, 26, 32, "Input", "ExpressionUUID" -> \
"1e183ae4-3e92-4510-851a-c19023cb46b3"],
Cell[59329, 1485, 1928, 49, 54, "Input", "ExpressionUUID" -> \
"8532347b-1b17-4253-9dcc-bb679222a7f9"],
Cell[61260, 1536, 241, 5, 32, "Input", "ExpressionUUID" -> \
"df38a4a2-882b-472f-8c32-975c92b9e0fa"],
Cell[61504, 1543, 493, 13, 51, "Input", "ExpressionUUID" -> \
"99882efe-f1dd-444c-b3ce-c05108082101"],
Cell[62000, 1558, 555, 10, 32, "Input", "ExpressionUUID" -> \
"ded927f4-c997-468d-802a-47c0563e8579"],
Cell[62558, 1570, 883, 28, 32, "Input", "ExpressionUUID" -> \
"0eea9e28-8b1d-47b1-bb1f-3e3fba44ebba"],
Cell[63444, 1600, 733, 20, 34, "Text", "ExpressionUUID" -> \
"ebc76714-32a7-4a5f-a2f9-a3ade5a50a42"],
Cell[64180, 1622, 491, 14, 51, "Input", "ExpressionUUID" -> \
"aff69efc-c77d-407f-a7d6-b11b4ac47054"],
Cell[64674, 1638, 489, 14, 51, "Input", "ExpressionUUID" -> \
"af3e1f2a-51a9-4189-8c54-4200afe888f7"],
Cell[65166, 1654, 535, 15, 51, "Input", "ExpressionUUID" -> \
"442a3479-1e2f-499f-8399-bc23dbd9338c"],
Cell[65704, 1671, 537, 9, 30, "Text", "ExpressionUUID" -> \
"da6b2ce2-7029-4bd2-87a7-992097dd20bf"],
Cell[66244, 1682, 1197, 34, 32, "Input", "ExpressionUUID" -> \
"679b727a-34ae-477e-b349-32bdcdbbfe8b"],
Cell[67444, 1718, 4371, 99, 136, "Input", "ExpressionUUID" -> \
"97d19866-0964-4440-b794-afa384e00bc4"],
Cell[71818, 1819, 448, 10, 32, "Input", "ExpressionUUID" -> \
"8cc8546c-f7c2-48c1-bcce-d034caa79bd0"],
Cell[72269, 1831, 927, 26, 32, "Input", "ExpressionUUID" -> \
"8d009a33-4ad2-429b-85c2-ea5f325a119b"],
Cell[73199, 1859, 309, 8, 32, "Input", "ExpressionUUID" -> \
"461436ab-766f-47d4-a7f6-f9d1057cfdf8"],
Cell[73511, 1869, 229, 6, 30, "Text", "ExpressionUUID" -> \
"c81a9eb3-da0c-4807-adff-4fa1379f4e94"],
Cell[73743, 1877, 512, 14, 32, "Input", "ExpressionUUID" -> \
"8b1eddb3-732e-4ef4-a61d-b381d6f83b25"],
Cell[74258, 1893, 1045, 31, 32, "Input", "ExpressionUUID" -> \
"c51ed6d2-1fab-45ed-a2b2-7fa779b1794f"],
Cell[75306, 1926, 421, 12, 32, "Text", "ExpressionUUID" -> \
"6b6f4764-a9bb-47b4-af72-59abc1b8ae35"],
Cell[75730, 1940, 905, 25, 32, "Input", "ExpressionUUID" -> \
"35d361be-a101-46d0-a6f2-9d0d3f706dd5"],
Cell[76638, 1967, 535, 13, 32, "Input", "ExpressionUUID" -> \
"0915ccc1-3ab8-4d52-a18e-c953d139b468"],
Cell[77176, 1982, 357, 8, 30, "Text", "ExpressionUUID" -> \
"ed381682-c4f6-49d8-8019-31f163ea7e29"],
Cell[77536, 1992, 373, 10, 32, "Input", "ExpressionUUID" -> \
"f8c41aaa-919e-402b-9e8f-115a5818d392"],
Cell[77912, 2004, 486, 9, 30, "Text", "ExpressionUUID" -> \
"32c3bdf9-9800-499f-815a-638b655143c9"],
Cell[78401, 2015, 900, 25, 32, "Input", "ExpressionUUID" -> \
"f2de355c-6485-403a-8fb1-6339dfbe38bf"],
Cell[79304, 2042, 484, 16, 32, "Input", "ExpressionUUID" -> \
"28c1e52a-562e-4ac8-bd19-a309ae723108"],
Cell[79791, 2060, 653, 19, 32, "Input", "ExpressionUUID" -> \
"ee1e54ff-16ba-47d5-8041-6fae9114f20e"],
Cell[80447, 2081, 553, 18, 32, "Input", "ExpressionUUID" -> \
"927439a2-deaa-4a03-8a73-f0015a0e806d"],
Cell[81003, 2101, 556, 18, 32, "Input", "ExpressionUUID" -> \
"39be680e-e4cf-4129-82e5-3ad3920308f0"],
Cell[81562, 2121, 560, 18, 32, "Input", "ExpressionUUID" -> \
"c046c7d7-cb3a-4672-8303-c8be940947d5"],
Cell[82125, 2141, 612, 19, 32, "Input", "ExpressionUUID" -> \
"765fa55c-db82-42f0-a90b-34c0feec0c98"],
Cell[82740, 2162, 819, 25, 32, "Input", "ExpressionUUID" -> \
"ba025625-a3a7-49d4-8425-db2e419b7b3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83596, 2192, 271, 5, 75, "Chapter", "ExpressionUUID" -> \
"3d018a3e-e30a-41a0-9279-b7b116a3ca5a"],
Cell[83870, 2199, 593, 10, 30, "Text", "ExpressionUUID" -> \
"e3aa5790-f262-4af7-8c5b-d9de1a208878"],
Cell[84466, 2211, 478, 11, 49, "Input", "ExpressionUUID" -> \
"efe353e8-c9db-4fbb-b83e-498866e3a0fc"],
Cell[84947, 2224, 270, 7, 32, "Input", "ExpressionUUID" -> \
"0ab2e938-1d24-4b8a-907f-84cf6f661af6"],
Cell[85220, 2233, 1235, 27, 32, "Input", "ExpressionUUID" -> \
"6c3a9fc3-fe03-4653-bba5-c18a4df5085d"],
Cell[86458, 2262, 963, 24, 32, "Input", "ExpressionUUID" -> \
"c306cd95-f1bb-4637-9ade-a248c898e815"],
Cell[87424, 2288, 865, 22, 32, "Input", "ExpressionUUID" -> \
"2fd8bfa9-0dba-4e7f-8b13-1ad56be0244e"],
Cell[88292, 2312, 994, 25, 32, "Input", "ExpressionUUID" -> \
"0ad87fa4-0a36-4d74-b620-1dabf8302ead"],
Cell[89289, 2339, 613, 19, 32, "Input", "ExpressionUUID" -> \
"c2f7648e-ad96-4d7e-aa9d-3a72bab9c540"],
Cell[89905, 2360, 809, 16, 32, "Input", "ExpressionUUID" -> \
"851b3600-42a0-4941-b254-3ddc733db90f"],
Cell[90717, 2378, 1034, 20, 274, "Text", "ExpressionUUID" -> \
"f211e56f-6570-48c5-9297-3914db59ee34"],
Cell[91754, 2400, 11328, 192, 67, "Input", "ExpressionUUID" -> \
"19ec3ce1-8acc-415d-9da1-2055fadb9cf5"],
Cell[CellGroupData[{
Cell[103107, 2596, 163, 3, 32, "Input", "ExpressionUUID" -> \
"5457366f-5689-4dfd-a721-dcd7e60ae77b"],
Cell[103273, 2601, 15200, 245, 238, "Output", "ExpressionUUID" -> \
"2525ab5c-8798-47dc-a520-5725b3b79b3e"]
}, Open  ]],
Cell[118488, 2849, 906, 13, 30, "Text", "ExpressionUUID" -> \
"bf459b46-c5ba-40e8-99be-c9f29e4d42cf"],
Cell[119397, 2864, 204, 5, 32, "Input", "ExpressionUUID" -> \
"6d11b515-1864-44fe-b384-e6d3abffb9d4"],
Cell[119604, 2871, 301, 6, 32, "Input", "ExpressionUUID" -> \
"d35007f3-e225-4b79-bbb4-e488b13a391a"],
Cell[119908, 2879, 130, 2, 32, "Input", "ExpressionUUID" -> \
"c83904af-cdd7-4b67-9b17-d402bcde9d1f"],
Cell[120041, 2883, 296, 6, 32, "Input", "ExpressionUUID" -> \
"b987e7b6-4b5e-4946-81e8-249225bd3885"],
Cell[120340, 2891, 410, 9, 32, "Input", "ExpressionUUID" -> \
"47ad7e23-f59d-47fd-a142-1ea243819c13"],
Cell[120753, 2902, 2451, 62, 54, "Input", "ExpressionUUID" -> \
"e6e0ea36-ada3-4d30-9ee4-d34a3a3eb264"],
Cell[123207, 2966, 932, 25, 32, "Input", "ExpressionUUID" -> \
"1b1b2fe0-a4f2-48d0-992d-abf645d6d3c3"],
Cell[124142, 2993, 372, 7, 30, "Text", "ExpressionUUID" -> \
"582f3bc5-601e-4248-842b-5bd97eb5a47a"],
Cell[124517, 3002, 1209, 35, 32, "Input", "ExpressionUUID" -> \
"11720fa8-c1ec-41f7-9f8d-507c66d5729a"],
Cell[125729, 3039, 2167, 46, 32, "Input", "ExpressionUUID" -> \
"91616ac1-7556-4696-a9ca-85b87a541bb7"],
Cell[127899, 3087, 411, 11, 32, "Input", "ExpressionUUID" -> \
"02757c68-9131-45f9-b1d3-481347a55125"],
Cell[128313, 3100, 5027, 106, 54, "Input", "ExpressionUUID" -> \
"f9d78e1e-bad1-42e4-b252-83cceea8c2db"],
Cell[133343, 3208, 2847, 77, 75, "Input", "ExpressionUUID" -> \
"5c14b6a9-f4c9-47ce-9140-74be624794fe"],
Cell[136193, 3287, 775, 13, 32, "Input", "ExpressionUUID" -> \
"1d0a6b2c-fbe0-4976-b612-60c2410f7b50"],
Cell[136971, 3302, 652, 11, 32, "Input", "ExpressionUUID" -> \
"6ee0abc5-656d-46db-a11b-45c6c46bebfd"],
Cell[137626, 3315, 333, 7, 51, "Input", "ExpressionUUID" -> \
"6e55b638-6b2d-4d0e-9b74-70db1d61a02d"],
Cell[137962, 3324, 1342, 35, 32, "Input", "ExpressionUUID" -> \
"6d771656-3ad6-4a7d-9a11-4b74b259b767"],
Cell[139307, 3361, 2630, 72, 54, "Input", "ExpressionUUID" -> \
"59f61ab9-9abe-490c-be65-0e0a0d161974"],
Cell[141940, 3435, 1346, 37, 32, "Input", "ExpressionUUID" -> \
"3ec8f14d-154a-4b43-9c2b-3246b7741fb8"],
Cell[143289, 3474, 241, 6, 32, "Input", "ExpressionUUID" -> \
"46ecd9f1-3c3d-4c73-ae07-c8da570817ec"],
Cell[143533, 3482, 516, 12, 32, "Input", "ExpressionUUID" -> \
"f6697599-a3ef-4f8b-801a-4db1a5deac00"],
Cell[144052, 3496, 235, 6, 32, "Input", "ExpressionUUID" -> \
"7770b6b4-b5dd-4b04-970f-66ade8c87fb7"],
Cell[144290, 3504, 865, 18, 54, "Input", "ExpressionUUID" -> \
"6b73ffa1-d627-489d-a736-9189e7b8edbc"],
Cell[CellGroupData[{
Cell[145180, 3526, 25525, 515, 1057, "Input", "ExpressionUUID" -> \
"4dc003ee-612b-4828-9f2b-4032c32bfd92"],
Cell[170708, 4043, 605, 12, 42, "Message", "ExpressionUUID" -> \
"c021fae3-4abc-4f0d-a74a-08ed226365a4"],
Cell[171316, 4057, 605, 12, 42, "Message", "ExpressionUUID" -> \
"9682c39a-6c13-4b48-b5c6-242ba12d3215"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171958, 4074, 220, 5, 32, "Input", "ExpressionUUID" -> \
"1130e97d-a458-4321-b5f2-27aa082a5cdc"],
Cell[172181, 4081, 205, 3, 32, "Output", "ExpressionUUID" -> \
"a772d236-033f-4f19-b769-f0c3db2cbcea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172423, 4089, 190, 4, 32, "Input", "ExpressionUUID" -> \
"e6c76bf8-01be-4680-8e2d-b202abd5fa06"],
Cell[172616, 4095, 191, 4, 32, "Output", "ExpressionUUID" -> \
"e71dba36-f4e0-433b-ab54-517cb9903bcf"]
}, Open  ]],
Cell[172822, 4102, 247, 6, 32, "Input", "ExpressionUUID" -> \
"9672bbd7-e465-46a1-830a-610748599b86"],
Cell[CellGroupData[{
Cell[173094, 4112, 232, 5, 32, "Input", "ExpressionUUID" -> \
"4d66925c-37ce-4517-8b3e-45e48468fb5a"],
Cell[173329, 4119, 1383, 20, 32, "Output", "ExpressionUUID" -> \
"c9e7bade-0899-4988-a880-b76e068dd052"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174749, 4144, 279, 4, 63, "Subchapter", "ExpressionUUID" -> \
"d5a9f757-d75d-4f47-9a77-6fb6db6a0a42"],
Cell[175031, 4150, 869, 23, 32, "Input", "ExpressionUUID" -> \
"42247895-2334-466b-ae1c-eeaf9e7a069c"],
Cell[175903, 4175, 529, 9, 32, "Input", "ExpressionUUID" -> \
"047f02d4-9e5e-457e-bdc0-6b063c2c00f5"],
Cell[176435, 4186, 21627, 493, 957, "Input", "ExpressionUUID" -> \
"1c95b521-2b97-4565-a5d3-94c5be64768b"],
Cell[198065, 4681, 514, 12, 32, "Input", "ExpressionUUID" -> \
"bdbf03fb-9701-46be-aa2c-9223a09a2698"],
Cell[198582, 4695, 331, 9, 32, "Input", "ExpressionUUID" -> \
"142d5897-49d9-47c2-90a8-d44d3eb3d2b4"],
Cell[198916, 4706, 373, 8, 32, "Input", "ExpressionUUID" -> \
"3aa7249e-7c38-46e2-a516-ac888f828455"],
Cell[199292, 4716, 243, 6, 32, "Input", "ExpressionUUID" -> \
"e6a3a979-e229-463f-837b-21208aaeb9b2"],
Cell[199538, 4724, 864, 21, 32, "Input", "ExpressionUUID" -> \
"7d0c76e9-1796-4be1-b71a-daabe027d53a"],
Cell[200405, 4747, 785, 17, 32, "Input", "ExpressionUUID" -> \
"cfff931f-76c5-4d6f-99d4-ff5c8bbfb94e"],
Cell[201193, 4766, 636, 13, 32, "Input", "ExpressionUUID" -> \
"2eaf9703-52d5-4e90-b879-0f1fe3b52c9e"],
Cell[201832, 4781, 271, 6, 32, "Input", "ExpressionUUID" -> \
"d67541cb-dcc7-4c6d-9e44-8bd74314674a"],
Cell[202106, 4789, 1726, 30, 32, "Input", "ExpressionUUID" -> \
"bb4c9037-f754-46e9-9067-a5269256c3bf"],
Cell[CellGroupData[{
Cell[203857, 4823, 770, 19, 32, "Input", "ExpressionUUID" -> \
"fb3d654b-e1f1-45dc-8f97-ac22dff2765d"],
Cell[204630, 4844, 819, 15, 42, "Message", "ExpressionUUID" -> \
"0a28ebef-841b-4a52-82db-0fc7d7265855"],
Cell[205452, 4861, 819, 15, 42, "Message", "ExpressionUUID" -> \
"78289c00-f8b3-4f49-af3b-4f28ae75a891"]
}, Open  ]],
Cell[206286, 4879, 602, 13, 32, "Input", "ExpressionUUID" -> \
"901486ef-9ff8-43a2-b420-9fc339d9cfe6"],
Cell[206891, 4894, 377, 10, 32, "Input", "ExpressionUUID" -> \
"d8d21cf7-b3bf-4937-86fc-ff3a0a0c3d53"],
Cell[207271, 4906, 728, 18, 32, "Input", "ExpressionUUID" -> \
"3e7292e4-354f-4129-8510-43a3e23c7dd3"],
Cell[208002, 4926, 376, 10, 32, "Input", "ExpressionUUID" -> \
"dc051f3f-e980-442d-bed8-d687d66f650d"],
Cell[208381, 4938, 395, 10, 32, "Input", "ExpressionUUID" -> \
"2ddd474e-9bfd-4dc1-91e7-6cee43b5373f"],
Cell[208779, 4950, 398, 10, 32, "Input", "ExpressionUUID" -> \
"596edc92-2c7e-48f8-a32b-04ab4b7ce78d"],
Cell[209180, 4962, 3115, 70, 117, "Input", "ExpressionUUID" -> \
"424e1bcd-9966-4f95-9cd4-6749d818636e"],
Cell[212298, 5034, 494, 9, 32, "Input", "ExpressionUUID" -> \
"141e0c9b-4b7e-4328-af0b-f8f29e0338e3"],
Cell[212795, 5045, 848, 21, 50, "Input", "ExpressionUUID" -> \
"1a505588-cc36-469f-85e1-442928ae30c2"],
Cell[213646, 5068, 377, 7, 30, "Text", "ExpressionUUID" -> \
"c2297330-6fdc-4201-ba87-b5f493963881"],
Cell[214026, 5077, 649, 11, 32, "Input", "ExpressionUUID" -> \
"495e88c9-fca2-4086-9291-fcc219b70330"],
Cell[214678, 5090, 1179, 21, 32, "Input", "ExpressionUUID" -> \
"ea995f07-5952-4867-83b3-1ef5ee6bdcaf"],
Cell[215860, 5113, 321, 9, 32, "Input", "ExpressionUUID" -> \
"54c4416e-6bc6-4245-98e0-7463803489f6"],
Cell[216184, 5124, 131, 3, 32, "Input", "ExpressionUUID" -> \
"1139b033-1882-40d3-be27-9276263fe084"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

